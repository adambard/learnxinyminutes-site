<!DOCTYPE html lang="en-us" xml:lang="en-us" xmlns="http://www.w3.org/1999/xhtml">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta http-equiv="Content-Language" content="en-us">
        <!-- Use title if it's in the page YAML frontmatter -->
        <title>Learn X in Y Minutes: Scenic Programming Language Tours</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="/css/index.css">

        <link rel="canonical" href="https://learnxinyminutes.com/docs/powershell/">
        <script>
            var THEME_KEY = "lxiym_theme";
            function set_theme(theme) {
                var el = document.getElementsByTagName("html")[0];
                if (!el) {
                  return;
                }

                if (theme === "dark" ) {
                    el.className = "dark";
                } else {
                    el.className = "light";
                }

                localStorage.setItem(THEME_KEY, theme);
            }

            function load_theme() {
              var theme = localStorage.getItem(THEME_KEY);
              if (theme) {
                set_theme(theme);
              }
            }

            // Attempt immediate application of html style
            load_theme();

            // Backup: do it onload. Will flash, but better than nothing.
            window.addEventListener("load", function(){
              load_theme();
            });
        </script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="container">
            <div class="share">
    <span class="sharemsg">
      <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fdocs%2Fpowershell%2F&text=Learn+X+in+Y+minutes%2C+where+X%3Dpowershell">
        Share this page
      </a></span>

      <span class='st_facebook_large' displayText='Facebook'></span>
      <span class='st_twitter_large' displayText='Tweet'></span>
  </div>
  <div class="theme-choice">
    <label id="theme-label">Select theme:</label>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('light');">light</button>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('dark');">dark</button>
  </div>
  <h1><a href="/">Learn X in Y minutes</a></h1>
  <h2>Where X=powershell</h2>
    <p class="filelink">
    Get the code:
    <a href="/docs/files/LearnPowershell.ps1">LearnPowershell.ps1</a>
    </p>
  <div id="doc">
    <p>PowerShell is the Windows scripting language and configuration management
framework from Microsoft built on the .NET Framework. Windows 7 and up ship
with PowerShell.<br>
Nearly all examples below can be a part of a shell script or executed directly
in the shell.</p>

<p>A key difference with Bash is that it is mostly objects that you manipulate
rather than plain text. After years of evolving, it resembles Python a bit.</p>

<p><a href="https://docs.microsoft.com/powershell/scripting/overview">Read more here.</a></p>

<p>Powershell as a Language:</p>
<div class="highlight"><pre class="highlight powershell"><code><span class="w">
</span><span class="c"># Single line comments start with a number symbol.</span><span class="w">

</span><span class="cm">&lt;#
  Multi-line comments
  like so
#&gt;</span><span class="w">


</span><span class="c">####################################################</span><span class="w">
</span><span class="c">## 1. Primitive Datatypes and Operators</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="c"># Numbers</span><span class="w">
</span><span class="mi">3</span><span class="w"> </span><span class="c"># =&gt; 3</span><span class="w">

</span><span class="c"># Math</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="c"># =&gt; 2</span><span class="w">
</span><span class="mi">8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="c"># =&gt; 7</span><span class="w">
</span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c"># =&gt; 20</span><span class="w">
</span><span class="mi">35</span><span class="w"> </span><span class="n">/</span><span class="w"> </span><span class="nx">5</span><span class="w">  </span><span class="c"># =&gt; 7.0</span><span class="w">

</span><span class="c"># Powershell uses banker's rounding,</span><span class="w">
</span><span class="c"># meaning [int]1.5 would round to 2 but so would [int]2.5</span><span class="w">
</span><span class="c"># Division always returns a float. </span><span class="w">
</span><span class="c"># You must cast result to [int] to round.</span><span class="w">
</span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="mi">5</span><span class="w"> </span><span class="n">/</span><span class="w"> </span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="nx">3</span><span class="w">       </span><span class="c"># =&gt; 1.66666666666667</span><span class="w">
</span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="nt">-5</span><span class="w"> </span><span class="n">/</span><span class="w"> </span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="nx">3</span><span class="w">      </span><span class="c"># =&gt; -1.66666666666667</span><span class="w">
</span><span class="mf">5.0</span><span class="w"> </span><span class="n">/</span><span class="w"> </span><span class="nx">3.0</span><span class="w">   </span><span class="c"># =&gt; 1.66666666666667</span><span class="w">
</span><span class="nt">-5</span><span class="o">.</span><span class="nf">0</span><span class="w"> </span><span class="n">/</span><span class="w"> </span><span class="nx">3.0</span><span class="w">  </span><span class="c"># =&gt; -1.66666666666667</span><span class="w">
</span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="nv">$result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">/</span><span class="w"> </span><span class="nx">3</span><span class="w"> 
</span><span class="nv">$result</span><span class="w"> </span><span class="c"># =&gt; 2</span><span class="w">

</span><span class="c"># Modulo operation</span><span class="w">
</span><span class="mi">7</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="c"># =&gt; 1</span><span class="w">

</span><span class="c"># Exponentiation requires longform or the built-in [Math] class.</span><span class="w">
</span><span class="p">[</span><span class="n">Math</span><span class="p">]::</span><span class="n">Pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w">  </span><span class="c"># =&gt; 8</span><span class="w">

</span><span class="c"># Enforce order of operations with parentheses.</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c"># =&gt; 7</span><span class="w">
</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c"># =&gt; 8</span><span class="w">

</span><span class="c"># Boolean values are primitives (Note: the $)</span><span class="w">
</span><span class="nv">$True</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="nv">$False</span><span class="w">  </span><span class="c"># =&gt; False</span><span class="w">

</span><span class="c"># negate with !</span><span class="w">
</span><span class="o">!</span><span class="nv">$True</span><span class="w">   </span><span class="c"># =&gt; False</span><span class="w">
</span><span class="o">!</span><span class="nv">$False</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">

</span><span class="c"># Boolean Operators</span><span class="w">
</span><span class="c"># Note "-and" and "-or" usage</span><span class="w">
</span><span class="nv">$True</span><span class="w"> </span><span class="o">-and</span><span class="w"> </span><span class="nv">$False</span><span class="w">  </span><span class="c"># =&gt; False</span><span class="w">
</span><span class="nv">$False</span><span class="w"> </span><span class="o">-or</span><span class="w"> </span><span class="nv">$True</span><span class="w">   </span><span class="c"># =&gt; True</span><span class="w">

</span><span class="c"># True and False are actually 1 and 0 but only support limited arithmetic.</span><span class="w">
</span><span class="c"># However, casting the bool to int resolves this.</span><span class="w">
</span><span class="nv">$True</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">$True</span><span class="w"> </span><span class="c"># =&gt; 2</span><span class="w">
</span><span class="nv">$True</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w">    </span><span class="c"># =&gt; '[System.Boolean] * [System.Int32]' is undefined</span><span class="w">
</span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="nv">$True</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="c"># =&gt; 8</span><span class="w">
</span><span class="nv">$False</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="c"># =&gt; -5</span><span class="w">

</span><span class="c"># Comparison operators look at the numerical value of True and False.</span><span class="w">
</span><span class="mi">0</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$False</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$True</span><span class="w">   </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="mi">2</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$True</span><span class="w">   </span><span class="c"># =&gt; False</span><span class="w">
</span><span class="nt">-5</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="nv">$False</span><span class="w"> </span><span class="c"># =&gt; True</span><span class="w">

</span><span class="c"># Using boolean logical operators on ints casts to booleans for evaluation.</span><span class="w">
</span><span class="c"># but their non-cast value is returned</span><span class="w">
</span><span class="c"># Don't mix up with bool(ints) and bitwise -band/-bor</span><span class="w">
</span><span class="p">[</span><span class="n">bool</span><span class="p">](</span><span class="mi">0</span><span class="p">)</span><span class="w">     </span><span class="c"># =&gt; False</span><span class="w">
</span><span class="p">[</span><span class="n">bool</span><span class="p">](</span><span class="mi">4</span><span class="p">)</span><span class="w">     </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="p">[</span><span class="n">bool</span><span class="p">](</span><span class="nt">-6</span><span class="p">)</span><span class="w">    </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="mi">0</span><span class="w"> </span><span class="o">-band</span><span class="w"> </span><span class="mi">2</span><span class="w">     </span><span class="c"># =&gt; 0</span><span class="w">
</span><span class="nt">-5</span><span class="w"> </span><span class="o">-bor</span><span class="w"> </span><span class="mi">0</span><span class="w">     </span><span class="c"># =&gt; -5</span><span class="w">

</span><span class="c"># Equality is -eq (equals)</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="mi">2</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c"># =&gt; False</span><span class="w">

</span><span class="c"># Inequality is -ne (notequals)</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c"># =&gt; False</span><span class="w">
</span><span class="mi">2</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">

</span><span class="c"># More comparisons</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="mi">10</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="o">-gt</span><span class="w"> </span><span class="mi">10</span><span class="w">  </span><span class="c"># =&gt; False</span><span class="w">
</span><span class="mi">2</span><span class="w"> </span><span class="o">-le</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="mi">2</span><span class="w"> </span><span class="o">-ge</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">

</span><span class="c"># Seeing whether a value is in a range</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-and</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="mi">2</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">-and</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c"># =&gt; False</span><span class="w">

</span><span class="c"># (-is vs. -eq) -is checks if two objects are the same type.</span><span class="w">
</span><span class="c"># -eq checks if the objects have the same values, but sometimes doesn't work</span><span class="w">
</span><span class="c"># as expected.</span><span class="w">
</span><span class="c"># Note: we called '[Math]' from .NET previously without the preceeding</span><span class="w">
</span><span class="c"># namespaces. We can do the same with [Collections.ArrayList] if preferred.</span><span class="w">
</span><span class="p">[</span><span class="n">System.Collections.ArrayList</span><span class="p">]</span><span class="nv">$a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@()</span><span class="w">  </span><span class="c"># Point a at a new list</span><span class="w">
</span><span class="nv">$a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w">
</span><span class="nv">$b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$a</span><span class="w">                                 </span><span class="c"># =&gt; Point b at what a is pointing to</span><span class="w">
</span><span class="nv">$b</span><span class="w"> </span><span class="o">-is</span><span class="w"> </span><span class="nv">$a</span><span class="o">.</span><span class="nf">GetType</span><span class="p">()</span><span class="w">                     </span><span class="c"># =&gt; True, a and b equal same type</span><span class="w">
</span><span class="nv">$b</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$a</span><span class="w">                               </span><span class="c"># =&gt; None! See below</span><span class="w">
</span><span class="p">[</span><span class="n">System.Collections.Hashtable</span><span class="p">]</span><span class="nv">$b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{}</span><span class="w">  </span><span class="c"># =&gt; Point a at a new hash table</span><span class="w">
</span><span class="nv">$b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="s1">'one'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> 
       </span><span class="s1">'two'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">}</span><span class="w">
</span><span class="nv">$b</span><span class="w"> </span><span class="o">-is</span><span class="w"> </span><span class="nv">$a</span><span class="o">.</span><span class="nf">GetType</span><span class="p">()</span><span class="w">                     </span><span class="c"># =&gt; False, a and b types not equal</span><span class="w">

</span><span class="c"># Strings are created with " or ' but " is required for string interpolation</span><span class="w">
</span><span class="s2">"This is a string."</span><span class="w">
</span><span class="s1">'This is also a string.'</span><span class="w">

</span><span class="c"># Strings can be added too! But try not to do this.</span><span class="w">
</span><span class="s2">"Hello "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"world!"</span><span class="w">  </span><span class="c"># =&gt; "Hello world!"</span><span class="w">

</span><span class="c"># A string can be treated like a list of characters</span><span class="w">
</span><span class="s2">"Hello world!"</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">  </span><span class="c"># =&gt; 'H'</span><span class="w">

</span><span class="c"># You can find the length of a string</span><span class="w">
</span><span class="p">(</span><span class="s2">"This is a string"</span><span class="p">)</span><span class="o">.</span><span class="nf">Length</span><span class="w">  </span><span class="c"># =&gt; 16</span><span class="w">

</span><span class="c"># You can also format using f-strings or formatted string literals.</span><span class="w">
</span><span class="nv">$name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Steve"</span><span class="w">
</span><span class="nv">$age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">22</span><span class="w">
</span><span class="s2">"He said his name is </span><span class="nv">$name</span><span class="s2">."</span><span class="w"> 
</span><span class="c"># =&gt; "He said his name is Steve"</span><span class="w">
</span><span class="s2">"{0} said he is {1} years old."</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nv">$name</span><span class="p">,</span><span class="w"> </span><span class="nv">$age</span><span class="w"> 
</span><span class="c"># =&gt; "Steve said he is 22 years old"</span><span class="w">
</span><span class="s2">"</span><span class="nv">$name</span><span class="s2">'s name is </span><span class="si">$(</span><span class="nv">$name</span><span class="o">.</span><span class="nf">Length</span><span class="si">)</span><span class="s2"> characters long."</span><span class="w"> 
</span><span class="c"># =&gt; "Steve's name is 5 characters long."</span><span class="w">

</span><span class="c"># Strings can be compared with -eq, but are case insensitive. We can</span><span class="w">
</span><span class="c"># force with -ceq or -ieq.</span><span class="w">
</span><span class="s2">"ab"</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="s2">"ab"</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="s2">"ab"</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="s2">"AB"</span><span class="w">  </span><span class="c"># =&gt; True!</span><span class="w">
</span><span class="s2">"ab"</span><span class="w"> </span><span class="o">-ceq</span><span class="w"> </span><span class="s2">"AB"</span><span class="w">  </span><span class="c"># =&gt; False</span><span class="w">
</span><span class="s2">"ab"</span><span class="w"> </span><span class="o">-ieq</span><span class="w"> </span><span class="s2">"AB"</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">

</span><span class="c"># Escape Characters in Powershell</span><span class="w">
</span><span class="c"># Many languages use the '\', but Windows uses this character for </span><span class="w">
</span><span class="c"># file paths. Powershell thus uses '`' to escape characters</span><span class="w">
</span><span class="c"># Take caution when working with files, as '`' is a</span><span class="w">
</span><span class="c"># valid character in NTFS filenames.</span><span class="w">
</span><span class="s2">"Showing</span><span class="se">`n</span><span class="s2">Escape Chars"</span><span class="w"> </span><span class="c"># =&gt; new line between Showing and Escape</span><span class="w">
</span><span class="s2">"Making</span><span class="se">`t</span><span class="s2">Tables</span><span class="se">`t</span><span class="s2">With</span><span class="se">`t</span><span class="s2">Tabs"</span><span class="w"> </span><span class="c"># =&gt; Format things with tabs</span><span class="w">

</span><span class="c"># Negate pound sign to prevent comment</span><span class="w">
</span><span class="c"># Note that the function of '#' is removed, but '#' is still present</span><span class="w">
</span><span class="err">`</span><span class="c">#Get-Process # =&gt; Fail: not a recognized cmdlet</span><span class="w">

</span><span class="c"># $null is not an object</span><span class="w">
</span><span class="bp">$null</span><span class="w">  </span><span class="c"># =&gt; None</span><span class="w">

</span><span class="c"># $null, 0, and empty strings and arrays all evaluate to False.</span><span class="w">
</span><span class="c"># All other values are True</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">Test-Value</span><span class="w"> </span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Write-Output</span><span class="w"> </span><span class="s1">'True'</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Write-Output</span><span class="w"> </span><span class="s1">'False'</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">Test-Value</span><span class="w"> </span><span class="p">(</span><span class="bp">$null</span><span class="p">)</span><span class="w"> </span><span class="c"># =&gt; False</span><span class="w">
</span><span class="n">Test-Value</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w">     </span><span class="c"># =&gt; False</span><span class="w">
</span><span class="n">Test-Value</span><span class="w"> </span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="w">    </span><span class="c"># =&gt; False</span><span class="w">
</span><span class="n">Test-Value</span><span class="w"> </span><span class="p">[]</span><span class="w">      </span><span class="c"># =&gt; True </span><span class="w">
</span><span class="c"># *[] calls .NET class; creates '[]' string when passed to function</span><span class="w">
</span><span class="n">Test-Value</span><span class="w"> </span><span class="p">({})</span><span class="w">    </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="n">Test-Value</span><span class="w"> </span><span class="p">@()</span><span class="w">     </span><span class="c"># =&gt; False</span><span class="w">


</span><span class="c">####################################################</span><span class="w">
</span><span class="c">## 2. Variables and Collections</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="c"># Powershell uses the "Write-Output" function to print</span><span class="w">
</span><span class="n">Write-Output</span><span class="w"> </span><span class="s2">"I'm Posh. Nice to meet you!"</span><span class="w">  </span><span class="c"># =&gt; I'm Posh. Nice to meet you!</span><span class="w">

</span><span class="c"># Simple way to get input data from console</span><span class="w">
</span><span class="nv">$userInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Read-Host</span><span class="w"> </span><span class="s2">"Enter some data: "</span><span class="w"> </span><span class="c"># Returns the data as a string</span><span class="w">

</span><span class="c"># There are no declarations, only assignments.</span><span class="w">
</span><span class="c"># Convention is to use camelCase or PascalCase, whatever your team uses.</span><span class="w">
</span><span class="nv">$someVariable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">
</span><span class="nv">$someVariable</span><span class="w">  </span><span class="c"># =&gt; 5</span><span class="w">

</span><span class="c"># Accessing a previously unassigned variable does not throw exception.</span><span class="w">
</span><span class="c"># The value is $null by default</span><span class="w">

</span><span class="c"># Ternary Operators exist in Powershell 7 and up</span><span class="w">
</span><span class="mi">0</span><span class="w"> </span><span class="nf">?</span><span class="w"> </span><span class="s1">'yes'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">'no'</span><span class="w">  </span><span class="c"># =&gt; no</span><span class="w">


</span><span class="c"># The default array object in Powershell is an fixed length array.</span><span class="w">
</span><span class="nv">$defaultArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"thing"</span><span class="p">,</span><span class="s2">"thing2"</span><span class="p">,</span><span class="s2">"thing3"</span><span class="w">
</span><span class="c"># you can add objects with '+=', but cannot remove objects.</span><span class="w">
</span><span class="nv">$defaultArray</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="s2">"thing4"</span><span class="p">)</span><span class="w"> </span><span class="c"># =&gt; Exception "Collection was of a fixed size."</span><span class="w">
</span><span class="c"># To have a more workable array, you'll want the .NET [ArrayList] class</span><span class="w">
</span><span class="c"># It is also worth noting that ArrayLists are significantly faster</span><span class="w">

</span><span class="c"># ArrayLists store sequences</span><span class="w">
</span><span class="p">[</span><span class="n">System.Collections.ArrayList</span><span class="p">]</span><span class="nv">$array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@()</span><span class="w">
</span><span class="c"># You can start with a prefilled ArrayList</span><span class="w">
</span><span class="p">[</span><span class="n">System.Collections.ArrayList</span><span class="p">]</span><span class="nv">$otherArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w">

</span><span class="c"># Add to the end of a list with 'Add' (Note: produces output, append to $null)</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nx">1</span><span class="p">)</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">    </span><span class="c"># $array is now [1]</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nx">2</span><span class="p">)</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">    </span><span class="c"># $array is now [1, 2]</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nx">4</span><span class="p">)</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">    </span><span class="c"># $array is now [1, 2, 4]</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nx">3</span><span class="p">)</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">    </span><span class="c"># $array is now [1, 2, 4, 3]</span><span class="w">
</span><span class="c"># Remove from end with index of count of objects-1; array index starts at 0</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">RemoveAt</span><span class="p">(</span><span class="nv">$array</span><span class="o">.</span><span class="nf">Count-1</span><span class="p">)</span><span class="w"> </span><span class="c"># =&gt; 3 and array is now [1, 2, 4]</span><span class="w">
</span><span class="c"># Let's put it back</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nx">3</span><span class="p">)</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">   </span><span class="c"># array is now [1, 2, 4, 3] again.</span><span class="w">

</span><span class="c"># Access a list like you would any array</span><span class="w">
</span><span class="nv">$array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">   </span><span class="c"># =&gt; 1</span><span class="w">
</span><span class="c"># Look at the last element</span><span class="w">
</span><span class="nv">$array</span><span class="p">[</span><span class="nt">-1</span><span class="p">]</span><span class="w">  </span><span class="c"># =&gt; 3</span><span class="w">

</span><span class="c"># Looking out of bounds returns nothing</span><span class="w">
</span><span class="nv">$array</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w">  </span><span class="c"># blank line returned</span><span class="w">

</span><span class="c"># You can look at ranges with slice syntax.</span><span class="w">
</span><span class="c"># The start index is included, the end index is not</span><span class="w">
</span><span class="c"># (It's a closed/open range for you mathy types.)</span><span class="w">
</span><span class="nv">$array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">]</span><span class="w">   </span><span class="c"># Return array from index 1 to 3 =&gt; [2, 4]</span><span class="w">
</span><span class="nv">$array</span><span class="p">[</span><span class="mi">2</span><span class="o">..</span><span class="nf">-1</span><span class="p">]</span><span class="w">    </span><span class="c"># Return array starting from index 2 =&gt; [4, 3]</span><span class="w">
</span><span class="nv">$array</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">3</span><span class="p">]</span><span class="w">    </span><span class="c"># Return array from beginning until index 3  =&gt; [1, 2, 4]</span><span class="w">
</span><span class="nv">$array</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">2</span><span class="p">]</span><span class="w">   </span><span class="c"># Return array selecting every second entry =&gt; [1, 4]</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">Reverse</span><span class="p">()</span><span class="w">  </span><span class="c"># mutates array to reverse order =&gt; [3, 4, 2, 1]</span><span class="w">
</span><span class="c"># Use any combination of these to make advanced slices</span><span class="w">

</span><span class="c"># Remove arbitrary elements from a array with "del"</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">Remove</span><span class="p">(</span><span class="nv">$array</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w">  </span><span class="c"># $array is now [1, 2, 3]</span><span class="w">

</span><span class="c"># Insert an element at a specific index</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">Insert</span><span class="p">(</span><span class="nx">1</span><span class="p">,</span><span class="w"> </span><span class="nx">2</span><span class="p">)</span><span class="w">  </span><span class="c"># $array is now [1, 2, 3] again</span><span class="w">

</span><span class="c"># Get the index of the first item found matching the argument</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">IndexOf</span><span class="p">(</span><span class="nx">2</span><span class="p">)</span><span class="w">  </span><span class="c"># =&gt; 1</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">IndexOf</span><span class="p">(</span><span class="nx">6</span><span class="p">)</span><span class="w">  </span><span class="c"># Returns -1 as "outside array" </span><span class="w">

</span><span class="c"># You can add arrays</span><span class="w">
</span><span class="c"># Note: values for $array and for $otherArray are not modified.</span><span class="w">
</span><span class="nv">$array</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">$otherArray</span><span class="w">  </span><span class="c"># =&gt; [1, 2, 3, 4, 5, 6]</span><span class="w">

</span><span class="c"># Concatenate arrays with "AddRange()"</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="nv">$otherArray</span><span class="p">)</span><span class="w">  </span><span class="c"># Now $array is [1, 2, 3, 4, 5, 6]</span><span class="w">

</span><span class="c"># Check for existence in a array with "in"</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="nt">-in</span><span class="w"> </span><span class="nv">$array</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">

</span><span class="c"># Examine length with "Count" (Note: "Length" on arrayList = each items length)</span><span class="w">
</span><span class="nv">$array</span><span class="o">.</span><span class="nf">Count</span><span class="w">  </span><span class="c"># =&gt; 6</span><span class="w">

</span><span class="c"># -eq doesn't compare array but extract the matching elements</span><span class="w">
</span><span class="nv">$array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="w">
</span><span class="nv">$array</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="mi">1</span><span class="w">          </span><span class="c"># =&gt; 1,1,1</span><span class="w">
</span><span class="p">(</span><span class="nv">$array</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="nf">Count</span><span class="w">  </span><span class="c"># =&gt; 3</span><span class="w">

</span><span class="c"># Tuples are like arrays but are immutable.</span><span class="w">
</span><span class="c"># To use Tuples in powershell, you must use the .NET tuple class.</span><span class="w">
</span><span class="nv">$tuple</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Tuple</span><span class="p">]::</span><span class="n">Create</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">
</span><span class="nv">$tuple</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="nx">0</span><span class="p">)</span><span class="w">      </span><span class="c"># =&gt; 1</span><span class="w">
</span><span class="nv">$tuple</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="nx">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="c"># Raises a TypeError</span><span class="w">

</span><span class="c"># You can do some of the array methods on tuples, but they are limited.</span><span class="w">
</span><span class="nv">$tuple</span><span class="o">.</span><span class="nf">Length</span><span class="w">       </span><span class="c"># =&gt; 3</span><span class="w">
</span><span class="nv">$tuple</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w">  </span><span class="c"># =&gt; Exception</span><span class="w">
</span><span class="nv">$tuple</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">2</span><span class="p">]</span><span class="w">        </span><span class="c"># =&gt; $null</span><span class="w">
</span><span class="mi">2</span><span class="w"> </span><span class="nt">-in</span><span class="w"> </span><span class="nv">$tuple</span><span class="w">        </span><span class="c"># =&gt; False</span><span class="w">


</span><span class="c"># Hashtables store mappings from keys to values, similar to Dictionaries.</span><span class="w">
</span><span class="nv">$emptyHash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{}</span><span class="w">
</span><span class="c"># Here is a prefilled dictionary</span><span class="w">
</span><span class="nv">$filledHash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="s2">"one"</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> 
                </span><span class="s2">"two"</span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> 
                </span><span class="s2">"three"</span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w">

</span><span class="c"># Look up values with []</span><span class="w">
</span><span class="nv">$filledHash</span><span class="p">[</span><span class="s2">"one"</span><span class="p">]</span><span class="w">  </span><span class="c"># =&gt; 1</span><span class="w">

</span><span class="c"># Get all keys as an iterable with ".Keys".</span><span class="w">
</span><span class="c"># items maintain the order at which they are inserted into the dictionary.</span><span class="w">
</span><span class="nv">$filledHash</span><span class="o">.</span><span class="nf">Keys</span><span class="w">  </span><span class="c"># =&gt; ["one", "two", "three"]</span><span class="w">

</span><span class="c"># Get all values as an iterable with ".Values".</span><span class="w">
</span><span class="nv">$filledHash</span><span class="o">.</span><span class="nf">Values</span><span class="w">  </span><span class="c"># =&gt; [1, 2, 3]</span><span class="w">

</span><span class="c"># Check for existence of keys or values in a hash with "-in"</span><span class="w">
</span><span class="s2">"one"</span><span class="w"> </span><span class="nt">-in</span><span class="w"> </span><span class="nv">$filledHash</span><span class="o">.</span><span class="nf">Keys</span><span class="w">  </span><span class="c"># =&gt; True</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="nt">-in</span><span class="w"> </span><span class="nv">$filledHash</span><span class="o">.</span><span class="nf">Values</span><span class="w">    </span><span class="c"># =&gt; False</span><span class="w">

</span><span class="c"># Looking up a non-existing key returns $null</span><span class="w">
</span><span class="nv">$filledHash</span><span class="p">[</span><span class="s2">"four"</span><span class="p">]</span><span class="w">  </span><span class="c"># $null</span><span class="w">

</span><span class="c"># Adding to a dictionary</span><span class="w">
</span><span class="nv">$filledHash</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="s2">"five"</span><span class="p">,</span><span class="nx">5</span><span class="p">)</span><span class="w">  </span><span class="c"># $filledHash["five"] is set to 5</span><span class="w">
</span><span class="nv">$filledHash</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="s2">"five"</span><span class="p">,</span><span class="nx">6</span><span class="p">)</span><span class="w">  </span><span class="c"># exception "Item with key "five" has already been added"</span><span class="w">
</span><span class="nv">$filledHash</span><span class="p">[</span><span class="s2">"four"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="c"># $filledHash["four"] is set to 4, running again does nothing</span><span class="w">

</span><span class="c"># Remove keys from a dictionary with del</span><span class="w">
</span><span class="nv">$filledHash</span><span class="o">.</span><span class="nf">Remove</span><span class="p">(</span><span class="s2">"one"</span><span class="p">)</span><span class="w"> </span><span class="c"># Removes the key "one" from filled dict</span><span class="w">


</span><span class="c">####################################################</span><span class="w">
</span><span class="c">## 3. Control Flow and Iterables</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="c"># Let's just make a variable</span><span class="w">
</span><span class="nv">$someVar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">

</span><span class="c"># Here is an if statement.</span><span class="w">
</span><span class="c"># This prints "$someVar is smaller than 10"</span><span class="w">
</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$someVar</span><span class="w"> </span><span class="o">-gt</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Write-Output</span><span class="w"> </span><span class="s2">"</span><span class="nv">$someVar</span><span class="s2"> is bigger than 10."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">elseif</span><span class="w"> </span><span class="p">(</span><span class="nv">$someVar</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="c"># This elseif clause is optional.</span><span class="w">
    </span><span class="n">Write-Output</span><span class="w"> </span><span class="s2">"</span><span class="nv">$someVar</span><span class="s2"> is smaller than 10."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">                        </span><span class="c"># This is optional too.</span><span class="w">
    </span><span class="n">Write-Output</span><span class="w"> </span><span class="s2">"</span><span class="nv">$someVar</span><span class="s2"> is indeed 10."</span><span class="w">
</span><span class="p">}</span><span class="w">


</span><span class="cm">&lt;#
Foreach loops iterate over arrays
prints:
    dog is a mammal
    cat is a mammal
    mouse is a mammal
#&gt;</span><span class="w">
</span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$animal</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="p">(</span><span class="s2">"dog"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cat"</span><span class="p">,</span><span class="w"> </span><span class="s2">"mouse"</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="c"># You can use -f to interpolate formatted strings</span><span class="w">
    </span><span class="s2">"{0} is a mammal"</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nv">$animal</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="cm">&lt;#
For loops iterate over arrays and you can specify indices
prints:
   0 a
   1 b
   2 c
   3 d
   4 e
   5 f
   6 g
   7 h
#&gt;</span><span class="w">
</span><span class="nv">$letters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'b'</span><span class="p">,</span><span class="s1">'c'</span><span class="p">,</span><span class="s1">'d'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'f'</span><span class="p">,</span><span class="s1">'g'</span><span class="p">,</span><span class="s1">'h'</span><span class="p">)</span><span class="w">
</span><span class="kr">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nv">$i</span><span class="w"> </span><span class="o">-le</span><span class="w"> </span><span class="nv">$letters</span><span class="o">.</span><span class="nf">Count-1</span><span class="p">;</span><span class="w"> </span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="nv">$i</span><span class="p">,</span><span class="w"> </span><span class="nv">$letters</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="cm">&lt;#
While loops go until a condition is no longer met.
prints:
    0
    1
    2
    3
#&gt;</span><span class="w">
</span><span class="nv">$x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span><span class="kr">while</span><span class="w"> </span><span class="p">(</span><span class="nv">$x</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Write-Output</span><span class="w"> </span><span class="nv">$x</span><span class="w">
    </span><span class="nv">$x</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c"># Shorthand for x = x + 1</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># Switch statements are more powerful compared to most languages</span><span class="w">
</span><span class="nv">$val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"20"</span><span class="w">
</span><span class="kr">switch</span><span class="p">(</span><span class="nv">$val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="p">}</span><span class="w">           </span><span class="p">{</span><span class="w"> </span><span class="s2">"The answer equals 42"</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="s1">'20'</span><span class="w">                    </span><span class="p">{</span><span class="w"> </span><span class="s2">"Exactly 20"</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s1">'s*'</span><span class="w"> </span><span class="p">}</span><span class="w">       </span><span class="p">{</span><span class="w"> </span><span class="s2">"Case insensitive"</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-clike</span><span class="w"> </span><span class="s1">'s*'</span><span class="p">}</span><span class="w">       </span><span class="p">{</span><span class="w"> </span><span class="s2">"clike, ceq, cne for case sensitive"</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-notmatch</span><span class="w"> </span><span class="s1">'^.*$'</span><span class="p">}</span><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="s2">"Regex matching. cnotmatch, cnotlike, ..."</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="n">default</span><span class="w">                 </span><span class="p">{</span><span class="w"> </span><span class="s2">"Others"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># Handle exceptions with a try/catch block</span><span class="w">
</span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="c"># Use "throw" to raise an error</span><span class="w">
    </span><span class="kr">throw</span><span class="w"> </span><span class="s2">"This is an error"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Write-Output</span><span class="w"> </span><span class="bp">$Error</span><span class="o">.</span><span class="nf">ExceptionMessage</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Write-Output</span><span class="w"> </span><span class="s2">"We can clean up resources here"</span><span class="w">
</span><span class="p">}</span><span class="w">


</span><span class="c"># Writing to a file</span><span class="w">
</span><span class="nv">$contents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="s2">"aa"</span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="w"> 
             </span><span class="s2">"bb"</span><span class="o">=</span><span class="w"> </span><span class="mi">21</span><span class="p">}</span><span class="w">
</span><span class="nv">$contents</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Export-CSV</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">HOMEDRIVE</span><span class="s2">\file.csv"</span><span class="w"> </span><span class="c"># writes to a file</span><span class="w">

</span><span class="nv">$contents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"test string here"</span><span class="w">
</span><span class="nv">$contents</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out-File</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">HOMEDRIVE</span><span class="s2">\file.txt"</span><span class="w"> </span><span class="c"># writes to another file</span><span class="w">

</span><span class="c"># Read file contents and convert to json</span><span class="w">
</span><span class="n">Get-Content</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">HOMEDRIVE</span><span class="s2">\file.csv"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-Json</span><span class="w">


</span><span class="c">####################################################</span><span class="w">
</span><span class="c">## 4. Functions</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="c"># Use "function" to create new functions</span><span class="w">
</span><span class="c"># Keep the Verb-Noun naming convention for functions</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">Add-Numbers</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="bp">$args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">$args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">Add-Numbers</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nx">2</span><span class="w"> </span><span class="c"># =&gt; 3</span><span class="w">

</span><span class="c"># Calling functions with parameters</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">Add-ParamNumbers</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="kr">param</span><span class="p">(</span><span class="w"> </span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="nv">$firstNumber</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="nv">$secondNumber</span><span class="w"> </span><span class="p">)</span><span class="w">
 </span><span class="nv">$firstNumber</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">$secondNumber</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">Add-ParamNumbers</span><span class="w"> </span><span class="nt">-FirstNumber</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nt">-SecondNumber</span><span class="w"> </span><span class="nx">2</span><span class="w"> </span><span class="c"># =&gt; 3 </span><span class="w">

</span><span class="c"># Functions with named parameters, parameter attributes, parsable documentation</span><span class="w">
</span><span class="cm">&lt;#
</span><span class="cs">.SYNOPSIS</span><span class="cm">
Setup a new website
</span><span class="cs">.DESCRIPTION</span><span class="cm">
Creates everything your new website needs for much win
</span><span class="cs">.PARAMETER</span><span class="cm"> siteName
The name for the new website
</span><span class="cs">.EXAMPLE</span><span class="cm">
New-Website -Name FancySite -Po 5000
New-Website SiteWithDefaultPort
New-Website siteName 2000 # ERROR! Port argument could not be validated
('name1','name2') | New-Website -Verbose
#&gt;</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">New-Website</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">[</span><span class="n">CmdletBinding</span><span class="p">()]</span><span class="w">
    </span><span class="kr">param</span><span class="w"> </span><span class="p">(</span><span class="w">
        </span><span class="p">[</span><span class="n">Parameter</span><span class="p">(</span><span class="n">ValueFromPipeline</span><span class="o">=</span><span class="bp">$true</span><span class="p">,</span><span class="w"> </span><span class="n">Mandatory</span><span class="o">=</span><span class="bp">$true</span><span class="p">)]</span><span class="w">
        </span><span class="p">[</span><span class="n">Alias</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)]</span><span class="w">
        </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$siteName</span><span class="p">,</span><span class="w">
        </span><span class="p">[</span><span class="n">ValidateSet</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span><span class="mi">5000</span><span class="p">,</span><span class="mi">8000</span><span class="p">)]</span><span class="w">
        </span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="nv">$port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3000</span><span class="w">
    </span><span class="p">)</span><span class="w">
    </span><span class="kr">BEGIN</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Write-Output</span><span class="w"> </span><span class="s1">'Creating new website(s)'</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="kr">PROCESS</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Write-Output</span><span class="w"> </span><span class="s2">"name: </span><span class="nv">$siteName</span><span class="s2">, port: </span><span class="nv">$port</span><span class="s2">"</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="kr">END</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Write-Output</span><span class="w"> </span><span class="s1">'Website(s) created'</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">


</span><span class="c">####################################################</span><span class="w">
</span><span class="c">## 5. Modules</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="c"># You can import modules and install modules</span><span class="w">
</span><span class="c"># The Install-Module is similar to pip or npm, pulls from Powershell Gallery</span><span class="w">
</span><span class="n">Install-Module</span><span class="w"> </span><span class="nx">dbaTools</span><span class="w">
</span><span class="n">Import-Module</span><span class="w"> </span><span class="nx">dbaTools</span><span class="w">

</span><span class="nv">$query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"SELECT * FROM dbo.sometable"</span><span class="w">
</span><span class="nv">$queryParams</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="nx">SqlInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'testInstance'</span><span class="w">
    </span><span class="nx">Database</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s1">'testDatabase'</span><span class="w">
    </span><span class="nx">Query</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">$query</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">Invoke-DbaQuery</span><span class="w"> </span><span class="err">@</span><span class="nx">queryParams</span><span class="w">

</span><span class="c"># You can get specific functions from a module</span><span class="w">
</span><span class="n">Import-Module</span><span class="w"> </span><span class="nt">-Function</span><span class="w"> </span><span class="nx">Invoke-DbaQuery</span><span class="w">


</span><span class="c"># Powershell modules are just ordinary Posh files. You</span><span class="w">
</span><span class="c"># can write your own, and import them. The name of the</span><span class="w">
</span><span class="c"># module is the same as the name of the file.</span><span class="w">

</span><span class="c"># You can find out which functions and attributes</span><span class="w">
</span><span class="c"># are defined in a module.</span><span class="w">
</span><span class="n">Get-Command</span><span class="w"> </span><span class="nt">-module</span><span class="w"> </span><span class="nx">dbaTools</span><span class="w">
</span><span class="n">Get-Help</span><span class="w"> </span><span class="nx">dbaTools</span><span class="w"> </span><span class="nt">-Full</span><span class="w">


</span><span class="c">####################################################</span><span class="w">
</span><span class="c">## 6. Classes</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="c"># We use the "class" statement to create a class</span><span class="w">
</span><span class="kr">class</span><span class="w"> </span><span class="nc">Instrument</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$Type</span><span class="w">
    </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$Family</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="nv">$instrument</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">Instrument</span><span class="p">]::</span><span class="n">new</span><span class="p">()</span><span class="w">
</span><span class="nv">$instrument</span><span class="o">.</span><span class="nf">Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"String Instrument"</span><span class="w">
</span><span class="nv">$instrument</span><span class="o">.</span><span class="nf">Family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Plucked String"</span><span class="w">

</span><span class="nv">$instrument</span><span class="w">

</span><span class="cm">&lt;# Output:
Type              Family        
----              ------        
String Instrument Plucked String
#&gt;</span><span class="w">


</span><span class="c">####################################################</span><span class="w">
</span><span class="c">## 6.1 Inheritance</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="c"># Inheritance allows new child classes to be defined that inherit </span><span class="w">
</span><span class="c"># methods and variables from their parent class.</span><span class="w">

</span><span class="kr">class</span><span class="w"> </span><span class="nc">Guitar</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nc">Instrument</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$Brand</span><span class="w">
    </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$SubType</span><span class="w">
    </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$ModelType</span><span class="w">
    </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$ModelNumber</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="nv">$myGuitar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">Guitar</span><span class="p">]::</span><span class="n">new</span><span class="p">()</span><span class="w">
</span><span class="nv">$myGuitar</span><span class="o">.</span><span class="nf">Brand</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"Taylor"</span><span class="w">
</span><span class="nv">$myGuitar</span><span class="o">.</span><span class="nf">SubType</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"Acoustic"</span><span class="w">
</span><span class="nv">$myGuitar</span><span class="o">.</span><span class="nf">ModelType</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"Presentation"</span><span class="w">
</span><span class="nv">$myGuitar</span><span class="o">.</span><span class="nf">ModelNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PS14ce Blackwood"</span><span class="w">

</span><span class="nv">$myGuitar</span><span class="o">.</span><span class="nf">GetType</span><span class="p">()</span><span class="w">

</span><span class="cm">&lt;#
IsPublic IsSerial Name                                     BaseType                                               
-------- -------- ----                                     --------                                               
True     False    Guitar                                   Instrument  
#&gt;</span><span class="w">


</span><span class="c">####################################################</span><span class="w">
</span><span class="c">## 7. Advanced</span><span class="w">
</span><span class="c">####################################################</span><span class="w">

</span><span class="c"># The powershell pipeline allows things like High-Order Functions.</span><span class="w">

</span><span class="c"># Group-Object is a handy cmdlet that does incredible things.</span><span class="w">
</span><span class="c"># It works much like a GROUP BY in SQL.</span><span class="w">

</span><span class="cm">&lt;#
 The following will get all the running processes,
 group them by Name,
 and tell us how many instances of each process we have running.
 Tip: Chrome and svcHost are usually big numbers in this regard.
#&gt;</span><span class="w">
</span><span class="n">Get-Process</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Foreach-Object</span><span class="w"> </span><span class="nx">ProcessName</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Group-Object</span><span class="w">

</span><span class="c"># Useful pipeline examples are iteration and filtering.</span><span class="w">
</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ForEach-Object</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"Loop number </span><span class="nv">$PSITEM</span><span class="s2">"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">$PSITEM</span><span class="w"> </span><span class="o">-gt</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-Json</span><span class="w">

</span><span class="c"># A notable pitfall of the pipeline is its performance when</span><span class="w">
</span><span class="c"># compared with other options.</span><span class="w">
</span><span class="c"># Additionally, raw bytes are not passed through the pipeline,</span><span class="w">
</span><span class="c"># so passing an image causes some issues.</span><span class="w">
</span><span class="c"># See more on that in the link at the bottom.</span><span class="w">

</span><span class="cm">&lt;#
 Asynchronous functions exist in the form of jobs.
 Typically a procedural language,
 Powershell can operate non-blocking functions when invoked as Jobs.
#&gt;</span><span class="w">

</span><span class="c"># This function is known to be non-optimized, and therefore slow.</span><span class="w">
</span><span class="nv">$installedApps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-CimInstance</span><span class="w"> </span><span class="nt">-ClassName</span><span class="w"> </span><span class="nx">Win32_Product</span><span class="w">

</span><span class="c"># If we had a script, it would hang at this func for a period of time.</span><span class="w">
</span><span class="nv">$scriptBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">Get-CimInstance</span><span class="w"> </span><span class="nt">-ClassName</span><span class="w"> </span><span class="nx">Win32_Product</span><span class="p">}</span><span class="w">
</span><span class="n">Start-Job</span><span class="w"> </span><span class="nt">-ScriptBlock</span><span class="w"> </span><span class="nv">$scriptBlock</span><span class="w">

</span><span class="c"># This will start a background job that runs the command.</span><span class="w">
</span><span class="c"># You can then obtain the status of jobs and their returned results.</span><span class="w">
</span><span class="nv">$allJobs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-Job</span><span class="w">
</span><span class="nv">$jobResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-Job</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Receive-Job</span><span class="w">


</span><span class="c"># Math is built in to powershell and has many functions.</span><span class="w">
</span><span class="nv">$r</span><span class="o">=</span><span class="mi">2</span><span class="w">
</span><span class="nv">$pi</span><span class="o">=</span><span class="p">[</span><span class="n">math</span><span class="p">]::</span><span class="n">pi</span><span class="w">
</span><span class="nv">$r2</span><span class="o">=</span><span class="p">[</span><span class="n">math</span><span class="p">]::</span><span class="n">pow</span><span class="p">(</span><span class="w"> </span><span class="nv">$r</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="nv">$area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$pi</span><span class="o">*</span><span class="nv">$r2</span><span class="w">
</span><span class="nv">$area</span><span class="w">

</span><span class="c"># To see all possibilities, check the members.</span><span class="w">
</span><span class="p">[</span><span class="n">System.Math</span><span class="p">]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Get-Member</span><span class="w"> </span><span class="nt">-Static</span><span class="w"> </span><span class="nt">-MemberType</span><span class="w"> </span><span class="nx">All</span><span class="w">


</span><span class="cm">&lt;#
 This is a silly one:
 You may one day be asked to create a func that could take $start and $end
 and reverse anything in an array within the given range
 based on an arbitrary array without mutating the original array.
 Let's see one way to do that and introduce another data structure.
#&gt;</span><span class="w">

</span><span class="nv">$targetArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'b'</span><span class="p">,</span><span class="s1">'c'</span><span class="p">,</span><span class="s1">'d'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'f'</span><span class="p">,</span><span class="s1">'g'</span><span class="p">,</span><span class="s1">'h'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'j'</span><span class="p">,</span><span class="s1">'k'</span><span class="p">,</span><span class="s1">'l'</span><span class="p">,</span><span class="s1">'m'</span><span class="w">

</span><span class="kr">function</span><span class="w"> </span><span class="nf">Format-Range</span><span class="w"> </span><span class="p">(</span><span class="nv">$start</span><span class="p">,</span><span class="w"> </span><span class="nv">$end</span><span class="p">,</span><span class="w"> </span><span class="nv">$array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">[</span><span class="n">System.Collections.ArrayList</span><span class="p">]</span><span class="nv">$firstSectionArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@()</span><span class="w">
    </span><span class="p">[</span><span class="n">System.Collections.ArrayList</span><span class="p">]</span><span class="nv">$secondSectionArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@()</span><span class="w">
    </span><span class="p">[</span><span class="n">System.Collections.Stack</span><span class="p">]</span><span class="nv">$stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@()</span><span class="w">
    </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="nv">$index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nv">$index</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="nv">$array</span><span class="o">.</span><span class="nf">Count</span><span class="p">;</span><span class="w"> </span><span class="nv">$index</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$index</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="nv">$start</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nv">$firstSectionArray</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$array</span><span class="p">[</span><span class="nv">$index</span><span class="p">])</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="kr">elseif</span><span class="w"> </span><span class="p">(</span><span class="nv">$index</span><span class="w"> </span><span class="o">-ge</span><span class="w"> </span><span class="nv">$start</span><span class="w"> </span><span class="o">-and</span><span class="w"> </span><span class="nv">$index</span><span class="w"> </span><span class="o">-le</span><span class="w"> </span><span class="nv">$end</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nv">$stack</span><span class="o">.</span><span class="nf">Push</span><span class="p">(</span><span class="nv">$array</span><span class="p">[</span><span class="nv">$index</span><span class="p">])</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nv">$secondSectionArray</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$array</span><span class="p">[</span><span class="nv">$index</span><span class="p">])</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="nv">$finalArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$firstSectionArray</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">$stack</span><span class="o">.</span><span class="nf">ToArray</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">$secondSectionArray</span><span class="w">
    </span><span class="kr">return</span><span class="w"> </span><span class="nv">$finalArray</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">Format-Range</span><span class="w"> </span><span class="nx">2</span><span class="w"> </span><span class="nx">6</span><span class="w"> </span><span class="nv">$targetArray</span><span class="w"> 
</span><span class="c"># =&gt; 'a','b','g','f','e','d','c','h','i','j','k','l','m'</span><span class="w">

</span><span class="c"># The previous method works, but uses extra memory by allocating new arrays.</span><span class="w">
</span><span class="c"># It's also kind of lengthy.</span><span class="w">
</span><span class="c"># Let's see how we can do this without allocating a new array.</span><span class="w">
</span><span class="c"># This is slightly faster as well.</span><span class="w">

</span><span class="kr">function</span><span class="w"> </span><span class="nf">Format-Range</span><span class="w"> </span><span class="p">(</span><span class="nv">$start</span><span class="p">,</span><span class="w"> </span><span class="nv">$end</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="kr">while</span><span class="w"> </span><span class="p">(</span><span class="nv">$start</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="nv">$end</span><span class="p">)</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="nv">$temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$targetArray</span><span class="p">[</span><span class="nv">$start</span><span class="p">]</span><span class="w">
      </span><span class="nv">$targetArray</span><span class="p">[</span><span class="nv">$start</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$targetArray</span><span class="p">[</span><span class="nv">$end</span><span class="p">]</span><span class="w">
      </span><span class="nv">$targetArray</span><span class="p">[</span><span class="nv">$end</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$temp</span><span class="w">
      </span><span class="nv">$start</span><span class="o">++</span><span class="w">
      </span><span class="nv">$end</span><span class="o">--</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="kr">return</span><span class="w"> </span><span class="nv">$targetArray</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">Format-Range</span><span class="w"> </span><span class="nx">2</span><span class="w"> </span><span class="nx">6</span><span class="w"> </span><span class="c"># =&gt; 'a','b','g','f','e','d','c','h','i','j','k','l','m'</span><span class="w">
</span></code></pre></div>
<p>Powershell as a Tool:</p>

<p>Getting Help:</p>
<div class="highlight"><pre class="highlight plaintext"><code># Find commands
Get-Command about_* # alias: gcm
Get-Command -Verb Add
Get-Alias ps
Get-Alias -Definition Get-Process

Get-Help ps | less # alias: help
ps | Get-Member # alias: gm

Show-Command Get-WinEvent # Display GUI to fill in the parameters

Update-Help # Run as admin
</code></pre></div>
<p>If you are uncertain about your environment:</p>
<div class="highlight"><pre class="highlight plaintext"><code>Get-ExecutionPolicy -List
Set-ExecutionPolicy AllSigned
# Execution policies include:
# - Restricted: Scripts won't run.
# - RemoteSigned: Downloaded scripts run only if signed by a trusted publisher. 
# - AllSigned: Scripts need to be signed by a trusted publisher.
# - Unrestricted: Run all scripts.
help about_Execution_Policies # for more info

# Current PowerShell version:
$PSVersionTable
</code></pre></div><div class="highlight"><pre class="highlight plaintext"><code># Calling external commands, executables, 
# and functions with the call operator.
# Exe paths with arguments passed or containing spaces can create issues.
C:\Program Files\dotnet\dotnet.exe
# The term 'C:\Program' is not recognized as a name of a cmdlet,
# function, script file, or executable program.
# Check the spelling of the name, or if a path was included, 
# verify that the path is correct and try again

"C:\Program Files\dotnet\dotnet.exe"
C:\Program Files\dotnet\dotnet.exe    # returns string rather than execute

&amp;"C:\Program Files\dotnet\dotnet.exe --help"   # fail
&amp;"C:\Program Files\dotnet\dotnet.exe" --help   # success
# Alternatively, you can use dot-sourcing here
."C:\Program Files\dotnet\dotnet.exe" --help   # success

# the call operator (&amp;) is similar to Invoke-Expression, 
# but IEX runs in current scope.
# One usage of '&amp;' would be to invoke a scriptblock inside of your script.
# Notice the variables are scoped
$i = 2
$scriptBlock = { $i=5; Write-Output $i }
&amp; $scriptBlock # =&gt; 5
$i # =&gt; 2

invoke-expression ' $i=5; Write-Output $i ' # =&gt; 5
$i # =&gt; 5

# Alternatively, to preserve changes to public variables
# you can use "Dot-Sourcing". This will run in the current scope.
$x=1
&amp;{$x=2};$x # =&gt; 1

.{$x=2};$x # =&gt; 2


# Remoting into computers is easy.
Enter-PSSession -ComputerName RemoteComputer

# Once remoted in, you can run commands as if you're local.
RemoteComputer\PS&gt; Get-Process powershell

&lt;#
Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                             
-------  ------    -----      -----     ------     --  -- -----------                                             
   1096      44   156324     179068      29.92  11772   1 powershell                                              
    545      25    49512      49852             25348   0 powershell 
#&gt;
RemoteComputer\PS&gt; Exit-PSSession

&lt;#
 Powershell is an incredible tool for Windows management and Automation.
 Let's take the following scenario:
 You have 10 servers.
 You need to check whether a service is running on all of them.
 You can RDP and log in, or PSSession to all of them, but why?
 Check out the following
#&gt;

$serverList = @(
    'server1',
    'server2',
    'server3',
    'server4',
    'server5',
    'server6',
    'server7',
    'server8',
    'server9',
    'server10'
)

[scriptblock]$script = {
    Get-Service -DisplayName 'Task Scheduler'
}

foreach ($server in $serverList) {
    $cmdSplat = @{
        ComputerName  = $server
        JobName       = 'checkService'
        ScriptBlock   = $script
        AsJob         = $true
        ErrorAction   = 'SilentlyContinue'
    }
    Invoke-Command @cmdSplat | Out-Null
}

&lt;#
 Here we've invoked jobs across many servers.
 We can now Receive-Job and see if they're all running.
 Now scale this up 100x as many servers :)
#&gt;
</code></pre></div>
<p>Interesting Projects  </p>

<ul>
<li><a href="https://channel9.msdn.com/Search?term=powershell%20pipeline#ch9Search&amp;lang-en=en">Channel9</a> PowerShell tutorials</li>
<li><a href="https://powershellexplained.com/">KevinMarquette&rsquo;s Powershell Blog</a> Excellent blog that goes into great detail on Powershell</li>
<li><a href="https://github.com/psget/psget">PSGet</a> NuGet for PowerShell</li>
<li><a href="https://github.com/lzybkr/PSReadLine/">PSReadLine</a> A bash inspired readline implementation for PowerShell (So good that it now ships with Windows10 by default!)</li>
<li><a href="https://github.com/dahlbyk/posh-git/">Posh-Git</a> Fancy Git Prompt (Recommended!)</li>
<li><a href="https://github.com/JanDeDobbeleer/oh-my-posh">Oh-My-Posh</a> Shell customization similar to the popular Oh-My-Zsh on Mac</li>
<li><a href="https://github.com/psake/psake">PSake</a> Build automation tool</li>
<li><a href="https://github.com/pester/Pester">Pester</a> BDD Testing Framework</li>
<li><a href="https://github.com/vors/ZLocation">ZLocation</a> Powershell <code>cd</code> that reads your mind</li>
<li><a href="https://github.com/Pscx/Pscx">PowerShell Community Extensions</a></li>
<li><a href="https://github.com/PowerShell/PowerShell/issues/1908">More on the Powershell Pipeline Issue</a></li>
</ul>

    <hr>
    <p>Got a suggestion? A correction, perhaps? <a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">Open an Issue</a> on the Github Repo, or make a <a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/powershell.html.markdown">pull request</a> yourself!
    </p>
    <p class="contributed">
    Originally contributed by Wouter Van Schandevijl, and updated by <a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/powershell.html.markdown">1 contributor(s)</a>.
    </p>

    <footer>
    <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>
    <p>
    &copy; 2024
        <a href="https://github.com/laoujin">Wouter Van Schandevijl</a>,
        <a href="https://github.com/AndrewDavis1191">Andrew Ryan Davis</a>
    </p>

    <p>

    </footer>
  </div>

        </div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script src="/js/script.js"></script>

        <script>
            var _gaq=[['_setAccount','UA-3525624-21'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>
    </body>
</html>
