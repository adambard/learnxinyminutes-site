<!DOCTYPE html>
<html lang="en">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WXC8R75DEN');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Language" content="en">
    <title>Learn Solidity in Y Minutes</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto+Slab:wght@100..900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/screen.css">
    <link rel="stylesheet" href="/css/light.css">
    <link rel="stylesheet" href="/css/dark.css">

    <link rel="canonical" href="https://learnxinyminutes.com/solidity/">
    <script>
      localStorage.removeItem("lxiym_theme");
    </script>
  </head>
  <body>
    <div class="container">
      <div class="share">
        <span class="sharemsg">
          <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fsolidity%2F&amp;text=Learn+X+in+Y+minutes%2C+where+X%3DSolidity">
            Share this page
          </a>
        </span>
        <span class='st_facebook_large' displayText='Facebook'></span>
        <span class='st_twitter_large' displayText='Tweet'></span>
      </div>
      <h1><a href="/">Learn X in Y minutes</a></h1>
      <h2>Where X=Solidity</h2>
      <p class="filelink">
        Get the code:
        <a href="/files/learnSolidity.sol">learnSolidity.sol</a>
      </p>
      <div id="doc">
<p>Solidity lets you program on <a href="https://www.ethereum.org/">Ethereum</a>, a
blockchain-based virtual machine that allows the creation and
execution of smart contracts, without requiring centralized or trusted parties.</p>
<p>Solidity is a statically typed, contract programming language that has
similarities to JavaScript and C. Like objects in OOP, each contract contains
state variables, functions, and common data types. Contract-specific features
include modifier (guard) clauses, event notifiers for listeners, and custom
global variables.</p>
<p>Some Ethereum contract examples include crowdfunding, voting, <a href="https://defipulse.com/">decentralized finance</a>, and blind auctions.</p>
<p>There is a high risk and high cost of errors in Solidity code, so you must be very careful to test
and slowly rollout. WITH THE RAPID CHANGES IN ETHEREUM, THIS DOCUMENT IS UNLIKELY TO STAY UP TO
DATE, SO YOU SHOULD FOLLOW THE SOLIDITY CHAT ROOM AND ETHEREUM BLOG FOR THE LATEST. ALL CODE HERE IS
PROVIDED AS IS, WITH SUBSTANTIAL RISK OF ERRORS OR DEPRECATED CODE PATTERNS.</p>
<p>Unlike other code, you may also need to add in design patterns like pausing, deprecation, and
throttling usage to reduce risk. This document primarily discusses syntax, and so excludes many
popular design patterns.</p>
<p>As Solidity and Ethereum are under active development, experimental or beta
features are typically marked, and subject to change. Pull requests welcome.</p>
<h1>Working with Remix and Metamask</h1>
<p>One of the easiest ways to build, deploy, and test solidity code is by using the:</p>
<ol>
<li><a href="https://remix.ethereum.org/">Remix Web IDE</a></li>
<li><a href="https://metamask.io/">Metamask wallet</a>.</li>
</ol>
<p>To get started, <a href="https://metamask.io/">download the Metamask Browser Extension</a>.</p>
<p>Once installed, we will be working with Remix. The below code will be pre-loaded, but before we head over there, let's look at a few tips to get started with remix. Load it all by <a href="https://remix.ethereum.org/#version=soljson-v0.8.19+commit.7dd6d404.js&amp;optimize=false&amp;evmVersion=null&amp;gist=2acb47a0286fe45d2464fa937f00fef3&amp;runs=200">hitting this link</a>.</p>
<ol>
<li>Choose the Solidity compiler</li>
</ol>
<p><img src="/images/solidity/remix-solidity.png" alt="Solidity-in-remix" /></p>
<ol start="2">
<li>Open the file loaded by that link</li>
</ol>
<p><img src="/images/solidity/remix-choose-file.png" alt="Solidity-choose-file" /></p>
<ol start="3">
<li>Compile the file</li>
</ol>
<p><img src="/images/solidity/remix-compile.png" alt="Solidity-compile" /></p>
<ol start="4">
<li>Deploy</li>
</ol>
<p><img src="/images/solidity/remix-deploy.png" alt="Solidity-deploy" /></p>
<ol start="5">
<li>Play with contracts</li>
</ol>
<p><img src="/images/solidity/remix-interact.png" alt="Solidity-deploy" /></p>
<p>You've deployed your first contract! Congrats!</p>
<p>You can test out and play with the functions defined. Check out the comments to learn about what each does.</p>
<p>For now, please continue to use the <code>Remix VM</code> unless instructed otherwise.</p>
<div class="highlight"><pre lang="solidity"><span class="c1">// First, a simple Bank contract</span>
<span class="c1">// Allows deposits, withdrawals, and balance checks</span>

<span class="c1">// simple_bank.sol (note .sol extension)</span>
<span class="cm">/* **** START EXAMPLE **** */</span>
<span class="c1">// A special comment is used at the top of the file to indicate</span>
<span class="c1">// the license for the code, and the version of Solidity used</span>
<span class="c1">// SPDX-License-Identifier: MIT</span>

<span class="c1">// Declare the source file compiler version</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.19</span><span class="p">;</span>

<span class="c1">// Start with Natspec comment (the three slashes)</span>
<span class="c1">// used for documentation - and as descriptive data for UI elements/actions</span>

<span class="c1">/// @title SimpleBank</span>
<span class="c1">/// @author nemild</span>

<span class="cm">/* &#39;contract&#39; has similarities to &#39;class&#39; in other languages (class variables,</span>
<span class="cm">inheritance, etc.) */</span>
<span class="k">contract</span><span class="w"> </span><span class="ni">SimpleBank</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// CapWords</span>
<span class="w">    </span><span class="c1">// Declare state variables outside function, persist through life of contract</span>

<span class="w">    </span><span class="c1">// dictionary that maps addresses to balances</span>
<span class="w">    </span><span class="kt">mapping</span><span class="w"> </span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span>balances<span class="p">;</span>

<span class="w">    </span><span class="c1">// &quot;private&quot; means that other contracts can&#39;t directly query balances</span>
<span class="w">    </span><span class="c1">// but data is still viewable to other parties on blockchain</span>

<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="k">public </span><span class="nv">owner</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// &#39;public&#39; makes externally readable (not writeable) by users or contracts</span>

<span class="w">    </span><span class="c1">// Events - publicize actions to external listeners</span>
<span class="w">    </span><span class="kt">event</span><span class="w"> </span><span class="nv">LogDepositMade</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">accountAddress</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">amount</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Constructor, can receive one or many variables here; only one allowed</span>
<span class="w">    </span><span class="kt">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// msg provides details about the message that&#39;s sent to the contract</span>
<span class="w">        </span><span class="c1">// msg.sender is contract caller (address of contract creator)</span>
<span class="w">        </span>owner<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.sender</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">/// @notice Deposit ether into bank</span>
<span class="w">    </span><span class="c1">/// @return The balance of the user after the deposit is made</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">deposit</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">payable</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Use &#39;require&#39; to test user inputs, &#39;assert&#39; for internal invariants</span>
<span class="w">        </span><span class="c1">// Here we are making sure that there isn&#39;t an overflow issue</span>
<span class="w">        </span><span class="c1">// In modern versions of Solidity, this is automatically checked</span>
<span class="w">        </span><span class="kt">require</span><span class="p">((</span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">msg.value</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">]);</span>

<span class="w">        </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// no &quot;this.&quot; or &quot;self.&quot; required with state variable</span>
<span class="w">        </span><span class="c1">// all values set to data type&#39;s initial value by default</span>

<span class="w">        </span>emit<span class="w"> </span>LogDepositMade<span class="p">(</span><span class="k">msg.sender</span><span class="p">,</span><span class="w"> </span><span class="k">msg.value</span><span class="p">);</span><span class="w"> </span><span class="c1">// fire event</span>

<span class="w">        </span><span class="kt">return</span><span class="w"> </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">/// @notice Withdraw ether from bank</span>
<span class="w">    </span><span class="c1">/// @dev This does not return any excess ether sent to it</span>
<span class="w">    </span><span class="c1">/// @param withdrawAmount amount you want to withdraw</span>
<span class="w">    </span><span class="c1">/// @return remainingBal</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">withdraw</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">withdrawAmount</span><span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">remainingBal</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">require</span><span class="p">(</span>withdrawAmount<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">]);</span>

<span class="w">        </span><span class="c1">// Note the way we deduct the balance right away, before sending</span>
<span class="w">        </span><span class="c1">// Every .transfer/.send from this contract can call an external function</span>
<span class="w">        </span><span class="c1">// This may allow the caller to request an amount greater</span>
<span class="w">        </span><span class="c1">// than their balance using a recursive call</span>
<span class="w">        </span><span class="c1">// Aim to commit state before calling external functions, including .transfer/.send</span>
<span class="w">        </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span>withdrawAmount<span class="p">;</span>

<span class="w">        </span><span class="c1">// this automatically throws on a failure, which means the updated balance is reverted</span>
<span class="w">        </span><span class="kt">payable</span><span class="p">(</span><span class="k">msg.sender</span><span class="p">).</span>transfer<span class="p">(</span>withdrawAmount<span class="p">);</span>

<span class="w">        </span><span class="kt">return</span><span class="w"> </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">/// @notice Get balance</span>
<span class="w">    </span><span class="c1">/// @return The balance of the user</span>
<span class="w">    </span><span class="c1">// &#39;view&#39; (ex: constant) prevents function from editing state variables;</span>
<span class="w">    </span><span class="c1">// allows function to run locally/off blockchain</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">balance</span><span class="p">()</span><span class="w"> </span>view<span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="c1">// ** END EXAMPLE **</span>


<span class="c1">// Now, the basics of Solidity</span>

<span class="c1">// 1. DATA TYPES AND ASSOCIATED METHODS</span>
<span class="c1">// uint used for currency amount (there are no doubles</span>
<span class="c1">//  or floats) and for dates (in unix time)</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">;</span>

<span class="c1">// int of 256 bits, cannot be changed after instantiation</span>
<span class="kt">int</span><span class="w"> </span><span class="nv">constant</span><span class="w"> </span>a<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">8</span><span class="p">;</span>
<span class="kt">int256</span><span class="w"> </span><span class="nv">constant</span><span class="w"> </span>a<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">8</span><span class="p">;</span><span class="w"> </span><span class="c1">// same effect as line above, here the 256 is explicit</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">constant</span><span class="w"> </span>VERSION_ID<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x123A1</span><span class="p">;</span><span class="w"> </span><span class="c1">// A hex constant</span>
<span class="c1">// with &#39;constant&#39;, compiler replaces each occurrence with actual value</span>

<span class="c1">// All state variables (those outside a function)</span>
<span class="c1">// are by default &#39;internal&#39; and accessible inside contract</span>
<span class="c1">// and in all contracts that inherit ONLY</span>
<span class="c1">// Need to explicitly set to &#39;public&#39; to allow external contracts to access</span>
<span class="kt">int256</span><span class="w"> </span><span class="k">public </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">8</span><span class="p">;</span>

<span class="c1">// For int and uint, can explicitly set space in steps of 8 up to 256</span>
<span class="c1">// e.g., int8, int16, int24</span>
<span class="kt">uint8</span><span class="w"> </span><span class="nv">b</span><span class="p">;</span>
<span class="kt">int64</span><span class="w"> </span><span class="nv">c</span><span class="p">;</span>
<span class="kt">uint248</span><span class="w"> </span><span class="nv">e</span><span class="p">;</span>

<span class="c1">// In older versions of solidity, doing addition could cause &quot;overflow&quot;</span>
<span class="c1">// For example, for an addition, you&#39;d do:</span>
<span class="kt">uint256</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>a<span class="w"> </span><span class="o">+</span><span class="w"> </span>b<span class="p">;</span>
assert<span class="p">(</span>c<span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span>a<span class="p">);</span><span class="w"> </span>
<span class="c1">// But modern versions of Solidity automatically check for overflow/underflow of integer math</span>


<span class="c1">// No random functions built in, you can get a pseduo-random number by hashing the current blockhash, or get a truly random number using something like Chainlink VRF. </span>
<span class="c1">// https://docs.chain.link/docs/get-a-random-number</span>

<span class="c1">// Type casting</span>
<span class="kt">int</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span>b<span class="p">);</span>

<span class="kt">bool</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">true</span><span class="p">;</span>

<span class="c1">// Addresses - holds 20 byte/160 bit Ethereum addresses</span>
<span class="c1">// No arithmetic allowed</span>
<span class="kt">address</span><span class="w"> </span><span class="k">public </span><span class="nv">owner</span><span class="p">;</span>

<span class="c1">// Types of accounts:</span>
<span class="c1">// Contract account: address set on create (func of creator address, num transactions sent)</span>
<span class="c1">// External Account: (person/external entity): address created from public key</span>

<span class="c1">// Add &#39;public&#39; field to indicate publicly/externally accessible</span>
<span class="c1">// a getter is automatically created, but NOT a setter</span>

<span class="c1">// All addresses can be sent ether</span>
owner<span class="p">.</span>transfer<span class="p">(</span>SOME_BALANCE<span class="p">);</span><span class="w"> </span><span class="c1">// fails and reverts on failure</span>

<span class="c1">// Can also do a lower level .send call, which returns a false if it failed</span>
<span class="kt">if</span><span class="w"> </span><span class="p">(</span>owner<span class="p">.</span>send<span class="p">(</span>amount<span class="p">))</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// REMEMBER: wrap send in &#39;if&#39;, as contract addresses have</span>
<span class="c1">// functions executed on send and these can fail</span>
<span class="c1">// Also, make sure to deduct balances BEFORE attempting a send, as there is a risk of a recursive</span>
<span class="c1">// call that can drain the contract</span>

<span class="c1">// Can check balance</span>
owner<span class="p">.</span>balance<span class="p">;</span><span class="w"> </span><span class="c1">// the balance of the owner (user or contract)</span>


<span class="c1">// Bytes available from 1 to 32</span>
bytes1<span class="w"> </span>a<span class="p">;</span><span class="w"> </span><span class="c1">// bytes1 is the explicit form</span>
bytes2<span class="w"> </span>b<span class="p">;</span>
<span class="kt">bytes32</span><span class="w"> </span><span class="nv">c</span><span class="p">;</span>

<span class="c1">// Dynamically sized bytes</span>
<span class="kt">bytes</span><span class="w"> </span><span class="nv">m</span><span class="p">;</span><span class="w"> </span><span class="c1">// A special array, same as byte[] array (but packed tightly)</span>
<span class="c1">// More expensive than byte1-byte32, so use those when possible</span>

<span class="c1">// same as bytes, but does not allow length or index access (for now)</span>
<span class="kt">string</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;hello&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// stored in UTF8, note double quotes, not single</span>
<span class="c1">// string utility functions to be added in future</span>
<span class="c1">// prefer bytes32/bytes, as UTF8 uses more storage</span>

<span class="c1">// by default, all values are set to 0 on instantiation</span>

<span class="c1">// Delete can be called on most types</span>
<span class="c1">// (does NOT destroy value, but sets value to 0, the initial value)</span>
delete<span class="w"> </span>x<span class="p">;</span>


<span class="c1">// Destructuring/Tuples</span>
<span class="p">(</span>x<span class="p">,</span><span class="w"> </span>y<span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="m m-Decimal">2</span><span class="p">,</span><span class="w"> </span><span class="m m-Decimal">7</span><span class="p">);</span><span class="w"> </span><span class="c1">// assign/swap multiple values</span>


<span class="c1">// 2. DATA STRUCTURES</span>
<span class="c1">// Arrays</span>
<span class="kt">bytes32</span><span class="p">[</span><span class="m m-Decimal">5</span><span class="p">]</span><span class="w"> </span>nicknames<span class="p">;</span><span class="w"> </span><span class="c1">// static array</span>
<span class="kt">bytes32</span><span class="p">[]</span><span class="w"> </span>names<span class="p">;</span><span class="w"> </span><span class="c1">// dynamic array</span>
names<span class="p">.</span>push<span class="p">(</span><span class="s2">&quot;John&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// adding an element (no longer returns length)</span>
<span class="c1">// Length</span>
names<span class="p">.</span>length<span class="p">;</span><span class="w"> </span><span class="c1">// get length</span>
<span class="c1">// Note: Direct length assignment has been removed in newer Solidity versions</span>

<span class="c1">// multidimensional array</span>
<span class="kt">uint</span><span class="p">[][</span><span class="m m-Decimal">5</span><span class="p">]</span><span class="w"> </span>x<span class="p">;</span><span class="w"> </span><span class="c1">// arr with 5 dynamic array elements (opp order of most languages)</span>

<span class="c1">// Dictionaries (any type to any other type)</span>
<span class="kt">mapping</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>balances<span class="p">;</span>
balances<span class="p">[</span><span class="s2">&quot;charles&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>
<span class="c1">// balances[&quot;ada&quot;] result is 0, all non-set key values return zeroes</span>
<span class="c1">// &#39;public&#39; allows following from another contract</span>
contractName<span class="p">.</span>balances<span class="p">(</span><span class="s2">&quot;charles&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns 1</span>
<span class="c1">// &#39;public&#39; created a getter (but not setter) like the following:</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">balances</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>_account<span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">balance</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">return</span><span class="w"> </span>balances<span class="p">[</span>_account<span class="p">];</span>
<span class="p">}</span>

<span class="c1">// Nested mappings</span>
<span class="kt">mapping</span><span class="w"> </span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">mapping</span><span class="w"> </span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">uint</span><span class="p">))</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>custodians<span class="p">;</span>

<span class="c1">// To delete</span>
delete<span class="w"> </span>balances<span class="p">[</span><span class="s2">&quot;John&quot;</span><span class="p">];</span>
delete<span class="w"> </span>balances<span class="p">;</span><span class="w"> </span><span class="c1">// sets all elements to 0</span>

<span class="c1">// Unlike other languages, CANNOT iterate through all elements in</span>
<span class="c1">// mapping, without knowing source keys - can build data structure</span>
<span class="c1">// on top to do this</span>

<span class="c1">// Structs</span>
<span class="kt">struct</span><span class="w"> </span><span class="nv">Bank</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="nv">owner</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="nv">balance</span><span class="p">;</span>
<span class="p">}</span>
Bank<span class="w"> </span>b<span class="w"> </span><span class="o">=</span><span class="w"> </span>Bank<span class="p">({</span>
<span class="w">    </span>owner<span class="o">:</span><span class="w"> </span><span class="k">msg.sender</span><span class="p">,</span>
<span class="w">    </span>balance<span class="o">:</span><span class="w"> </span><span class="m m-Decimal">5</span>
<span class="p">});</span>
<span class="c1">// or</span>
Bank<span class="w"> </span>c<span class="w"> </span><span class="o">=</span><span class="w"> </span>Bank<span class="p">(</span><span class="k">msg.sender</span><span class="p">,</span><span class="w"> </span><span class="m m-Decimal">5</span><span class="p">);</span>

c<span class="p">.</span>balance<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">5</span><span class="p">;</span><span class="w"> </span><span class="c1">// set to new value</span>
delete<span class="w"> </span>b<span class="p">;</span>
<span class="c1">// sets to initial value, set all variables in struct to 0, except mappings</span>

<span class="c1">// Enums</span>
<span class="kt">enum</span><span class="w"> </span><span class="nv">State</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>Created<span class="p">,</span><span class="w"> </span>Locked<span class="p">,</span><span class="w"> </span>Inactive<span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="c1">// often used for state machine</span>
State<span class="w"> </span><span class="kt">public</span><span class="w"> </span>state<span class="p">;</span><span class="w"> </span><span class="c1">// Declare variable from enum</span>
state<span class="w"> </span><span class="o">=</span><span class="w"> </span>State<span class="p">.</span>Created<span class="p">;</span>
<span class="c1">// enums can be explicitly converted to ints</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">createdState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">uint</span><span class="p">(</span>State<span class="p">.</span>Created<span class="p">);</span><span class="w"> </span><span class="c1">//  0</span>

<span class="c1">// Data locations: Memory vs. storage vs. calldata - all complex types (arrays,</span>
<span class="c1">// structs) have a data location</span>
<span class="c1">// &#39;memory&#39; does not persist, &#39;storage&#39; does</span>
<span class="c1">// &#39;calldata&#39; also does not persist, and is exclusively &quot;read-only&quot; meaning it cannot be modified</span>
<span class="c1">// Default is &#39;storage&#39; for local and state variables; &#39;memory&#39; for func params</span>
<span class="c1">// stack holds small local variables</span>

<span class="c1">// for most types, can explicitly set which data location to use</span>


<span class="c1">// 3. Simple operators</span>
<span class="c1">// Comparisons, bit operators and arithmetic operators are provided</span>
<span class="c1">// exponentiation: **</span>
<span class="c1">// exclusive or: ^</span>
<span class="c1">// bitwise negation: ~</span>


<span class="c1">// 4. Global Variables of note</span>
<span class="c1">// ** this **</span>
<span class="kt">this</span><span class="p">;</span><span class="w"> </span><span class="c1">// address of contract</span>
<span class="c1">// often used at end of contract life to transfer remaining balance to party</span>
<span class="kt">this</span><span class="p">.</span>balance<span class="p">;</span>
<span class="kt">this</span><span class="p">.</span>someFunction<span class="p">();</span><span class="w"> </span><span class="c1">// calls func externally via call, not via internal jump</span>

<span class="c1">// ** msg - Current message received by the contract ** **</span>
<span class="k">msg.sender</span><span class="p">;</span><span class="w"> </span><span class="c1">// address of sender</span>
<span class="k">msg.value</span><span class="p">;</span><span class="w"> </span><span class="c1">// amount of ether provided to this contract in wei, the function should be marked &quot;payable&quot;</span>
<span class="k">msg.data</span><span class="p">;</span><span class="w"> </span><span class="c1">// bytes, complete call data</span>

<span class="c1">// ** tx - This transaction **</span>
<span class="k">tx.origin</span><span class="p">;</span><span class="w"> </span><span class="c1">// address of sender of the transaction</span>
<span class="k">tx.gasprice</span><span class="p">;</span><span class="w"> </span><span class="c1">// gas price of the transaction</span>

<span class="c1">// ** block - Information about current block **</span>
<span class="k">block.timestamp</span><span class="p">;</span><span class="w"> </span><span class="c1">// current time (approximately) (uses Unix time)</span>
<span class="c1">// Note that this can be manipulated by miners, so use carefully</span>

<span class="k">block.number</span><span class="p">;</span><span class="w"> </span><span class="c1">// current block number</span>
<span class="k">block.difficulty</span><span class="p">;</span><span class="w"> </span><span class="c1">// current block difficulty</span>
<span class="k">block.blockhash</span><span class="p">(</span><span class="m m-Decimal">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns bytes32, only works for most recent 256 blocks</span>
<span class="k">block.gasLimit</span><span class="p">();</span>

<span class="c1">// ** storage - Persistent storage hash **</span>
storage<span class="p">[</span><span class="s1">&#39;abc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;def&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// maps 256 bit words to 256 bit words</span>


<span class="c1">// 5. FUNCTIONS AND MORE</span>
<span class="c1">// A. Functions</span>
<span class="c1">// Simple function</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">increment</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>x<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">return</span><span class="w"> </span>x<span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Functions can return many arguments,</span>
<span class="c1">// and by specifying returned arguments name explicit return is not needed</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">increment</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>x<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>
<span class="w">    </span>y<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Call previous function</span>
<span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">a</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>increment<span class="p">(</span><span class="m m-Decimal">1</span><span class="p">,</span><span class="m m-Decimal">1</span><span class="p">);</span>

<span class="c1">// &#39;view&#39; (alias for &#39;constant&#39;)</span>
<span class="c1">// indicates that function does not/cannot change persistent vars</span>
<span class="c1">// View function execute locally, not on blockchain</span>
<span class="c1">// Noted: constant keyword will soon be deprecated.</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>

<span class="kt">function</span><span class="w"> </span><span class="nv">increment</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>x<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>
<span class="w">    </span>y<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// this line would fail</span>
<span class="w">    </span><span class="c1">// y is a state variable, and can&#39;t be changed in a view function</span>
<span class="p">}</span>

<span class="c1">// &#39;pure&#39; is more strict than &#39;view&#39; or &#39;constant&#39;, and does not</span>
<span class="c1">// even allow reading of state vars</span>
<span class="c1">// The exact rules are more complicated, so see more about</span>
<span class="c1">// view/pure:</span>
<span class="c1">// http://solidity.readthedocs.io/en/develop/contracts.html#view-functions</span>

<span class="c1">// &#39;Function Visibility specifiers&#39;</span>
<span class="c1">// These can be placed where &#39;view&#39; is, including:</span>
<span class="c1">// public - visible externally and internally (default for function)</span>
<span class="c1">// external - only visible externally (including a call made with this.)</span>
<span class="c1">// private - only visible in the current contract</span>
<span class="c1">// internal - only visible in current contract, and those deriving from it</span>

<span class="c1">// Generally, a good idea to mark each function explicitly</span>

<span class="c1">// Functions hoisted - and can assign a function to a variable</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">a</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">function</span><span class="p">()</span><span class="w"> </span><span class="kt">internal</span><span class="w"> </span>z<span class="w"> </span><span class="o">=</span><span class="w"> </span>b<span class="p">;</span>
<span class="w">    </span>z<span class="p">();</span>
<span class="p">}</span>

<span class="kt">function</span><span class="w"> </span><span class="nv">b</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="p">}</span>

<span class="c1">// All functions that receive ether must be marked &#39;payable&#39;</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">depositEther</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">payable</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span>
<span class="p">}</span>


<span class="c1">// Prefer loops to recursion (max call stack depth is 1024)</span>
<span class="c1">// Also, don&#39;t setup loops that you haven&#39;t bounded,</span>
<span class="c1">// as this can hit the gas limit</span>

<span class="c1">// B. Events</span>
<span class="c1">// Events are notify external parties; easy to search and</span>
<span class="c1">// access events from outside blockchain (with lightweight clients)</span>
<span class="c1">// typically declare after contract parameters</span>

<span class="c1">// Typically, capitalized - and add Log in front to be explicit and prevent confusion</span>
<span class="c1">// with a function call</span>

<span class="c1">// Declare</span>
<span class="kt">event</span><span class="w"> </span><span class="nv">LogSent</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">indexed</span><span class="w"> </span>from<span class="p">,</span><span class="w"> </span><span class="kt">address</span><span class="w"> </span><span class="nv">indexed</span><span class="w"> </span>to<span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">amount</span><span class="p">);</span><span class="w"> </span><span class="c1">// note capital first letter</span>

<span class="c1">// Call</span>
emit<span class="w"> </span>LogSent<span class="p">(</span>from<span class="p">,</span><span class="w"> </span>to<span class="p">,</span><span class="w"> </span>amount<span class="p">);</span>

<span class="cm">/**</span>

<span class="cm">For an external party (a contract or external entity), to watch using</span>
<span class="cm">the Web3 JavaScript library:</span>

<span class="cm">// The following is JavaScript code, not Solidity code</span>
<span class="cm">Coin.LogSent().watch({}, &#39;&#39;, function(error, result) {</span>
<span class="cm">    if (!error) {</span>
<span class="cm">        console.log(&quot;Coin transfer: &quot; + result.args.amount +</span>
<span class="cm">            &quot; coins were sent from &quot; + result.args.from +</span>
<span class="cm">            &quot; to &quot; + result.args.to + &quot;.&quot;);</span>
<span class="cm">        console.log(&quot;Balances now:\n&quot; +</span>
<span class="cm">            &quot;Sender: &quot; + Coin.balances.call(result.args.from) +</span>
<span class="cm">            &quot;Receiver: &quot; + Coin.balances.call(result.args.to));</span>
<span class="cm">    }</span>
<span class="cm">}</span>
<span class="cm">**/</span>

<span class="c1">// Common paradigm for one contract to depend on another (e.g., a</span>
<span class="c1">// contract that depends on current exchange rate provided by another)</span>

<span class="c1">// C. Modifiers</span>
<span class="c1">// Modifiers validate inputs to functions such as minimal balance or user auth;</span>
<span class="c1">// similar to guard clause in other languages</span>

<span class="c1">// &#39;_&#39; (underscore) often included as last line in body, and indicates</span>
<span class="c1">// function being called should be placed there</span>
<span class="kt">modifier</span><span class="w"> </span>onlyAfter<span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">_time</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">require</span><span class="w"> </span><span class="p">(</span><span class="k">block.timestamp</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span>_time<span class="p">);</span><span class="w"> </span>_<span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="kt">modifier</span><span class="w"> </span>onlyOwner<span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">require</span><span class="p">(</span><span class="k">msg.sender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>owner<span class="p">);</span><span class="w"> </span>_<span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="c1">// commonly used with state machines</span>
<span class="kt">modifier</span><span class="w"> </span>onlyIfStateA<span class="w"> </span><span class="p">(</span>State<span class="w"> </span>currState<span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">require</span><span class="p">(</span>currState<span class="w"> </span><span class="o">==</span><span class="w"> </span>State<span class="p">.</span>A<span class="p">);</span><span class="w"> </span>_<span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="c1">// Append right after function declaration</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">changeOwner</span><span class="p">(</span>newOwner<span class="p">)</span>
onlyAfter<span class="p">(</span>someTime<span class="p">)</span>
onlyOwner<span class="p">()</span>
onlyIfState<span class="p">(</span>State<span class="p">.</span>A<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>owner<span class="w"> </span><span class="o">=</span><span class="w"> </span>newOwner<span class="p">;</span>
<span class="p">}</span>

<span class="c1">// underscore can be included before end of body,</span>
<span class="c1">// but explicitly returning will skip, so use carefully</span>
<span class="kt">modifier</span><span class="w"> </span>checkValue<span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">amount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>_<span class="p">;</span>
<span class="w">    </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.value</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>amount<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">amountToRefund</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>amount<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span>
<span class="w">        </span><span class="k">msg.sender</span><span class="p">.</span>transfer<span class="p">(</span>amountToRefund<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>


<span class="c1">// 6. BRANCHING AND LOOPS</span>

<span class="c1">// All basic logic blocks work - including if/else, for, while, break, continue</span>
<span class="c1">// return - but no switch</span>

<span class="c1">// Syntax same as JavaScript, but no type conversion from non-boolean</span>
<span class="c1">// to boolean (comparison operators must be used to get the boolean val)</span>

<span class="c1">// For loops that are determined by user behavior, be careful - as contracts have a maximal</span>
<span class="c1">// amount of gas for a block of code - and will fail if that is exceeded</span>
<span class="c1">// For example:</span>
<span class="kt">for</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"> </span>x<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>refundAddressList<span class="p">.</span>length<span class="p">;</span><span class="w"> </span>x<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>refundAddressList<span class="p">[</span>x<span class="p">].</span>transfer<span class="p">(</span>SOME_AMOUNT<span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Two errors above:</span>
<span class="c1">// 1. A failure on transfer stops the loop from completing, tying up money</span>
<span class="c1">// 2. This loop could be arbitrarily long (based on the amount of users who need refunds), and</span>
<span class="c1">// therefore may always fail as it exceeds the max gas for a block</span>
<span class="c1">// Instead, you should let people withdraw individually from their subaccount, and mark withdrawn</span>
<span class="c1">// e.g., favor pull payments over push payments</span>


<span class="c1">// 7. OBJECTS/CONTRACTS</span>

<span class="c1">// A. Calling external contract</span>
<span class="k">contract</span><span class="w"> </span><span class="ni">InfoFeed</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">info</span><span class="p">()</span><span class="w"> </span><span class="kt">payable</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">ret</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="kt">return</span><span class="w"> </span><span class="m m-Decimal">42</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">contract</span><span class="w"> </span><span class="ni">Consumer</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>InfoFeed<span class="w"> </span>feed<span class="p">;</span><span class="w"> </span><span class="c1">// points to contract on blockchain</span>

<span class="w">    </span><span class="c1">// Set feed to existing contract instance</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">setFeed</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">addr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// automatically cast, be careful; constructor is not called</span>
<span class="w">        </span>feed<span class="w"> </span><span class="o">=</span><span class="w"> </span>InfoFeed<span class="p">(</span>addr<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Set feed to new instance of contract</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">createNewFeed</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>feed<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span>InfoFeed<span class="p">();</span><span class="w"> </span><span class="c1">// new instance created; constructor called</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">callFeed</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// final parentheses call contract, can optionally add</span>
<span class="w">        </span><span class="c1">// custom ether value or gas</span>
<span class="w">        </span>feed<span class="p">.</span>info<span class="p">{</span>value<span class="o">:</span><span class="w"> </span><span class="m m-Decimal">10</span><span class="p">,</span><span class="w"> </span>gas<span class="o">:</span><span class="w"> </span><span class="m m-Decimal">800</span><span class="p">}();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// B. Inheritance</span>

<span class="c1">// Order matters, last inherited contract (i.e., &#39;def&#39;) can override parts of</span>
<span class="c1">// previously inherited contracts</span>
<span class="k">contract</span><span class="w"> </span><span class="ni">MyContract</span><span class="w"> </span><span class="kt">is</span><span class="w"> </span>abc<span class="p">,</span><span class="w"> </span>def<span class="p">(</span><span class="s2">&quot;a custom argument to def&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="c1">// Override function</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">z</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.sender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>owner<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span>def<span class="p">.</span>z<span class="p">();</span><span class="w"> </span><span class="c1">// call overridden function from def</span>
<span class="w">            </span>super<span class="p">.</span>z<span class="p">();</span><span class="w"> </span><span class="c1">// call immediate parent overridden function</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// abstract function</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">someAbstractFunction</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">);</span>
<span class="c1">// cannot be compiled, so used in base/abstract contracts</span>
<span class="c1">// that are then implemented</span>

<span class="c1">// C. Import</span>

<span class="kt">import</span><span class="w"> </span><span class="s2">&quot;filename&quot;</span><span class="p">;</span>
<span class="kt">import</span><span class="w"> </span><span class="s2">&quot;github.com/ethereum/dapp-bin/library/iterable_mapping.sol&quot;</span><span class="p">;</span>


<span class="c1">// 8. OTHER KEYWORDS</span>

<span class="c1">// A. Selfdestruct</span>
<span class="c1">// selfdestruct current contract, sending funds to address (often creator)</span>
selfdestruct<span class="p">(</span>SOME_ADDRESS<span class="p">);</span>

<span class="c1">// removes storage/code from current/future blocks</span>
<span class="c1">// helps thin clients, but previous data persists in blockchain</span>

<span class="c1">// Common pattern, lets owner end the contract and receive remaining funds</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">remove</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">if</span><span class="p">(</span><span class="k">msg.sender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>creator<span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Only let the contract creator do this</span>
<span class="w">        </span>selfdestruct<span class="p">(</span>creator<span class="p">);</span><span class="w"> </span><span class="c1">// Makes contract inactive, returns funds</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// May want to deactivate contract manually, rather than selfdestruct</span>
<span class="c1">// (ether sent to selfdestructed contract is lost)</span>


<span class="c1">// 9. CONTRACT DESIGN NOTES</span>

<span class="c1">// A. Obfuscation</span>
<span class="c1">// All variables are publicly viewable on blockchain, so anything</span>
<span class="c1">// that is private needs to be obfuscated (e.g., hashed w/secret)</span>

<span class="c1">// Steps: 1. Commit to something, 2. Reveal commitment</span>
<span class="nb">keccak256</span><span class="p">(</span><span class="s2">&quot;some_bid_amount&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;some secret&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// commit</span>

<span class="c1">// call contract&#39;s reveal function in the future</span>
<span class="c1">// showing bid plus secret that hashes to SHA3</span>
reveal<span class="p">(</span><span class="m m-Decimal">100</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;mySecret&quot;</span><span class="p">);</span>

<span class="c1">// B. Storage optimization</span>
<span class="c1">// Writing to blockchain can be expensive, as data stored forever; encourages</span>
<span class="c1">// smart ways to use memory (eventually, compilation will be better, but for now</span>
<span class="c1">// benefits to planning data structures - and storing min amount in blockchain)</span>

<span class="c1">// Cost can often be high for items like multidimensional arrays</span>
<span class="c1">// (cost is for storing data - not declaring unfilled variables)</span>

<span class="c1">// C. Data access in blockchain</span>
<span class="c1">// Cannot restrict human or computer from reading contents of</span>
<span class="c1">// transaction or transaction&#39;s state</span>

<span class="c1">// While &#39;private&#39; prevents other *contracts* from reading data</span>
<span class="c1">// directly - any other party can still read data in blockchain</span>

<span class="c1">// All data to start of time is stored in blockchain, so</span>
<span class="c1">// anyone can observe all previous data and changes</span>

<span class="c1">// D. Oracles and External Data</span>
<span class="c1">// Oracles are ways to interact with your smart contracts outside the blockchain. </span>
<span class="c1">// They are used to get data from the real world, send post requests, to the real world</span>
<span class="c1">// or vise versa.</span>

<span class="c1">// Time-based implementations of contracts are also done through oracles, as </span>
<span class="c1">// contracts need to be directly called and can not &quot;subscribe&quot; to a time. </span>
<span class="c1">// Due to smart contracts being decentralized, you also want to get your data</span>
<span class="c1">// in a decentralized manner, otherwise you run into the centralized risk that </span>
<span class="c1">// smart contract design matter prevents. </span>

<span class="c1">// The easiest way to get and use pre-boxed decentralized data is with Chainlink Data Feeds</span>
<span class="c1">// https://docs.chain.link/docs/get-the-latest-price</span>
<span class="c1">// We can reference on-chain reference points that have already been aggregated by </span>
<span class="c1">// multiple sources and delivered on-chain, and we can use it as a &quot;data bank&quot; </span>
<span class="c1">// of sources. </span>

<span class="c1">// You can see other examples making API calls here:</span>
<span class="c1">// https://docs.chain.link/docs/make-a-http-get-request</span>

<span class="c1">// And you can of course build your own oracle network, just be sure to know </span>
<span class="c1">// how centralized vs decentralized your application is. </span>

<span class="c1">// Setting up oracle networks yourself</span>

<span class="c1">// E. Cron Job</span>
<span class="c1">// Contracts must be manually called to handle time-based scheduling; can create external</span>
<span class="c1">// code to regularly ping, or provide incentives (ether) for others to</span>
<span class="c1">//</span>

<span class="c1">// F. Observer Pattern</span>
<span class="c1">// An Observer Pattern lets you register as a subscriber and</span>
<span class="c1">// register a function which is called by the oracle (note, the oracle pays</span>
<span class="c1">// for this action to be run)</span>
<span class="c1">// Some similarities to subscription in Pub/sub</span>

<span class="c1">// This is an abstract contract, both client and server classes import</span>
<span class="c1">// the client should implement</span>
<span class="k">contract</span><span class="w"> </span><span class="ni">SomeOracleCallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">oracleCallback</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="nv">_value</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">_time</span><span class="p">,</span><span class="w"> </span><span class="kt">bytes32</span><span class="w"> </span><span class="nv">info</span><span class="p">)</span><span class="w"> </span><span class="kt">external</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">contract</span><span class="w"> </span><span class="ni">SomeOracle</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>SomeOracleCallback<span class="p">[]</span><span class="w"> </span>callbacks<span class="p">;</span><span class="w"> </span><span class="c1">// array of all subscribers</span>

<span class="w">    </span><span class="c1">// Register subscriber</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">addSubscriber</span><span class="p">(</span>SomeOracleCallback<span class="w"> </span>a<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>callbacks<span class="p">.</span>push<span class="p">(</span>a<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">notify</span><span class="p">(</span>value<span class="p">,</span><span class="w"> </span>time<span class="p">,</span><span class="w"> </span>info<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">for</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span>i<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>callbacks<span class="p">.</span>length<span class="p">;</span><span class="w"> </span>i<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// all called subscribers must implement the oracleCallback</span>
<span class="w">            </span>callbacks<span class="p">[</span>i<span class="p">].</span>oracleCallback<span class="p">(</span>value<span class="p">,</span><span class="w"> </span>time<span class="p">,</span><span class="w"> </span>info<span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">doSomething</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Code to do something</span>

<span class="w">        </span><span class="c1">// Notify all subscribers</span>
<span class="w">        </span>notify<span class="p">(</span>_value<span class="p">,</span><span class="w"> </span>_time<span class="p">,</span><span class="w"> </span>_info<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Now, your client contract can addSubscriber by importing SomeOracleCallback</span>
<span class="c1">// and registering with Some Oracle</span>

<span class="c1">// G. State machines</span>
<span class="c1">// see example below for State enum and inState modifier</span>
</pre></div>
<p>Work with the full example below using the <a href="https://remix.ethereum.org/#version=soljson-v0.8.19+commit7dd6d404.js&amp;optimize=false&amp;evmVersion=null&amp;gist=2acb47a0286fe45d2464fa937f00fef3&amp;runs=200"><code>Remix VM</code> in remix here.</a></p>
<div class="highlight"><pre lang="solidity"><span class="c1">// *** EXAMPLE: A crowdfunding example (broadly similar to Kickstarter) ***</span>
<span class="c1">// ** START EXAMPLE **</span>

<span class="c1">// CrowdFunder.sol</span>
<span class="c1">// SPDX-License-Identifier: MIT</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.19</span><span class="p">;</span>

<span class="c1">/// @title CrowdFunder</span>
<span class="c1">/// @author nemild</span>
<span class="k">contract</span><span class="w"> </span><span class="ni">CrowdFunder</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Variables set on create by creator</span>
<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="k">public </span><span class="nv">creator</span><span class="p">;</span>
<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="nv">payable</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>fundRecipient<span class="p">;</span><span class="w"> </span><span class="c1">// creator may be different than recipient, and must be payable</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">minimumToRaise</span><span class="p">;</span><span class="w"> </span><span class="c1">// required to tip, else everyone gets refund</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="nv">campaignUrl</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Data structures</span>
<span class="w">    </span><span class="kt">enum</span><span class="w"> </span><span class="nv">State</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>Fundraising<span class="p">,</span>
<span class="w">        </span>ExpiredRefund<span class="p">,</span>
<span class="w">        </span>Successful
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">struct</span><span class="w"> </span><span class="nv">Contribution</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">amount</span><span class="p">;</span>
<span class="w">        </span><span class="kt">address</span><span class="w"> </span><span class="nv">payable</span><span class="w"> </span>contributor<span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// State variables</span>
<span class="w">    </span>State<span class="w"> </span><span class="kt">public</span><span class="w"> </span>state<span class="w"> </span><span class="o">=</span><span class="w"> </span>State<span class="p">.</span>Fundraising<span class="p">;</span><span class="w"> </span><span class="c1">// initialize on create</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">totalRaised</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">raiseBy</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">completeAt</span><span class="p">;</span>
<span class="w">    </span>Contribution<span class="p">[]</span><span class="w"> </span>contributions<span class="p">;</span>

<span class="w">    </span><span class="kt">event</span><span class="w"> </span><span class="nv">LogFundingReceived</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">addr</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">amount</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">currentTotal</span><span class="p">);</span>
<span class="w">    </span><span class="kt">event</span><span class="w"> </span><span class="nv">LogWinnerPaid</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">winnerAddress</span><span class="p">);</span>

<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>inState<span class="p">(</span>State<span class="w"> </span>_state<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">require</span><span class="p">(</span>state<span class="w"> </span><span class="o">==</span><span class="w"> </span>_state<span class="p">);</span>
<span class="w">        </span>_<span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>isCreator<span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">require</span><span class="p">(</span><span class="k">msg.sender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>creator<span class="p">);</span>
<span class="w">        </span>_<span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Wait 24 weeks after final contract state before allowing contract destruction</span>
<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>atEndOfLifecycle<span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">require</span><span class="p">(((</span>state<span class="w"> </span><span class="o">==</span><span class="w"> </span>State<span class="p">.</span>ExpiredRefund<span class="w"> </span><span class="o">||</span><span class="w"> </span>state<span class="w"> </span><span class="o">==</span><span class="w"> </span>State<span class="p">.</span>Successful<span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">        </span>completeAt<span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m m-Decimal">24</span><span class="w"> </span>weeks<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">block.timestamp</span><span class="p">));</span>
<span class="w">        </span>_<span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">crowdFund</span><span class="p">(</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">timeInHoursForFundraising</span><span class="p">,</span>
<span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>_campaignUrl<span class="p">,</span>
<span class="w">        </span><span class="kt">address</span><span class="w"> </span><span class="nv">payable</span><span class="w"> </span>_fundRecipient<span class="p">,</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">_minimumToRaise</span><span class="p">)</span>
<span class="w">        </span><span class="kt">public</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>creator<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.sender</span><span class="p">;</span>
<span class="w">        </span>fundRecipient<span class="w"> </span><span class="o">=</span><span class="w"> </span>_fundRecipient<span class="p">;</span>
<span class="w">        </span>campaignUrl<span class="w"> </span><span class="o">=</span><span class="w"> </span>_campaignUrl<span class="p">;</span>
<span class="w">        </span>minimumToRaise<span class="w"> </span><span class="o">=</span><span class="w"> </span>_minimumToRaise<span class="p">;</span>
<span class="w">        </span>raiseBy<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">block.timestamp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span>timeInHoursForFundraising<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="w"> </span>hours<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">contribute</span><span class="p">()</span>
<span class="w">    </span><span class="kt">public</span>
<span class="w">    </span><span class="kt">payable</span>
<span class="w">    </span>inState<span class="p">(</span>State<span class="p">.</span>Fundraising<span class="p">)</span>
<span class="w">    </span><span class="kt">returns</span><span class="p">(</span><span class="kt">uint256</span><span class="w"> </span><span class="nv">id</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>contributions<span class="p">.</span>push<span class="p">(</span>
<span class="w">            </span>Contribution<span class="p">({</span>
<span class="w">                </span>amount<span class="o">:</span><span class="w"> </span><span class="k">msg.value</span><span class="p">,</span>
<span class="w">                </span>contributor<span class="o">:</span><span class="w"> </span><span class="kt">payable</span><span class="p">(</span><span class="k">msg.sender</span><span class="p">)</span>
<span class="w">            </span><span class="p">})</span><span class="w"> </span><span class="c1">// use array, so can iterate</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span>totalRaised<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span>

<span class="w">        </span>emit<span class="w"> </span>LogFundingReceived<span class="p">(</span><span class="k">msg.sender</span><span class="p">,</span><span class="w"> </span><span class="k">msg.value</span><span class="p">,</span><span class="w"> </span>totalRaised<span class="p">);</span>

<span class="w">        </span>checkIfFundingCompleteOrExpired<span class="p">();</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>contributions<span class="p">.</span>length<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// return id</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">checkIfFundingCompleteOrExpired</span><span class="p">()</span>
<span class="w">    </span><span class="kt">public</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>totalRaised<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>minimumToRaise<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span>state<span class="w"> </span><span class="o">=</span><span class="w"> </span>State<span class="p">.</span>Successful<span class="p">;</span>
<span class="w">            </span>payOut<span class="p">();</span>

<span class="w">            </span><span class="c1">// could incentivize sender who initiated state change here</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="kt">else</span><span class="w"> </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">block.timestamp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>raiseBy<span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="p">{</span>
<span class="w">            </span>state<span class="w"> </span><span class="o">=</span><span class="w"> </span>State<span class="p">.</span>ExpiredRefund<span class="p">;</span><span class="w"> </span><span class="c1">// backers can now collect refunds by calling getRefund(id)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span>completeAt<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">block.timestamp</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">payOut</span><span class="p">()</span>
<span class="w">    </span><span class="kt">public</span>
<span class="w">    </span>inState<span class="p">(</span>State<span class="p">.</span>Successful<span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>fundRecipient<span class="p">.</span>transfer<span class="p">(</span><span class="kt">address</span><span class="p">(</span><span class="kt">this</span><span class="p">).</span>balance<span class="p">);</span>
<span class="w">        </span>emit<span class="w"> </span>LogWinnerPaid<span class="p">(</span>fundRecipient<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">getRefund</span><span class="p">(</span><span class="kt">uint256</span><span class="w"> </span><span class="nv">id</span><span class="p">)</span>
<span class="w">    </span>inState<span class="p">(</span>State<span class="p">.</span>ExpiredRefund<span class="p">)</span>
<span class="w">    </span><span class="kt">public</span>
<span class="w">    </span><span class="kt">returns</span><span class="p">(</span><span class="kt">bool</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">require</span><span class="p">(</span>contributions<span class="p">.</span>length<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>id<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>id<span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>contributions<span class="p">[</span>id<span class="p">].</span>amount<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="w"> </span><span class="p">);</span>

<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">amountToRefund</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>contributions<span class="p">[</span>id<span class="p">].</span>amount<span class="p">;</span>
<span class="w">        </span>contributions<span class="p">[</span>id<span class="p">].</span>amount<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span>

<span class="w">        </span>contributions<span class="p">[</span>id<span class="p">].</span>contributor<span class="p">.</span>transfer<span class="p">(</span>amountToRefund<span class="p">);</span>

<span class="w">        </span><span class="kt">return</span><span class="w"> </span><span class="kt">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Warning: &quot;selfdestruct&quot; has been deprecated. </span>
<span class="w">    </span><span class="c1">// Note that, starting from the Cancun hard fork, the underlying opcode no longer deletes the code </span>
<span class="w">    </span><span class="c1">// and data associated with an account and only transfers its Ether to the beneficiary, unless executed </span>
<span class="w">    </span><span class="c1">// in the same transaction in which the contract was created (see EIP-6780). </span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// Any use in newly deployed contracts is strongly discouraged even if the new behavior is taken into account. </span>
<span class="w">    </span><span class="c1">// Future changes to the EVM might further reduce the functionality of the opcode.</span>
<span class="w">    </span><span class="c1">// function removeContract()</span>
<span class="w">    </span><span class="c1">// public</span>
<span class="w">    </span><span class="c1">// isCreator()</span>
<span class="w">    </span><span class="c1">// atEndOfLifecycle()</span>
<span class="w">    </span><span class="c1">// {</span>
<span class="w">    </span><span class="c1">//     selfdestruct(msg.sender);</span>
<span class="w">    </span><span class="c1">//     // creator gets all money that hasn&#39;t be claimed</span>
<span class="w">    </span><span class="c1">// }</span>
<span class="p">}</span>
<span class="c1">// ** END EXAMPLE **</span>
</pre></div>
<p>Some more functions.</p>
<div class="highlight"><pre lang="solidity"><span class="c1">// 10. OTHER NATIVE FUNCTIONS</span>

<span class="c1">// Currency units</span>
<span class="c1">// Currency is defined using wei, smallest unit of Ether</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">minAmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="w"> </span>wei<span class="p">;</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="w"> </span>finney<span class="p">;</span><span class="w"> </span><span class="c1">// 1 ether == 1000 finney</span>
<span class="c1">// Other units, see: http://ether.fund/tool/converter</span>

<span class="c1">// Time units</span>
<span class="m m-Decimal">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="w"> </span>second
<span class="m m-Decimal">1</span><span class="w"> </span>minutes<span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m m-Decimal">60</span><span class="w"> </span>seconds

<span class="c1">// Can multiply a variable times unit, as units are not stored in a variable</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">5</span><span class="p">;</span>
<span class="p">(</span>x<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="w"> </span>days<span class="p">);</span><span class="w"> </span><span class="c1">// 5 days</span>

<span class="c1">// Careful about leap seconds/years with equality statements for time</span>
<span class="c1">// (instead, prefer greater than/less than)</span>

<span class="c1">// Cryptography</span>
<span class="c1">// All strings passed are concatenated before hash action</span>
<span class="nb">keccak256</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;cd&quot;</span><span class="p">);</span>
ripemd160<span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">);</span>
sha256<span class="p">(</span><span class="s2">&quot;def&quot;</span><span class="p">);</span>

<span class="c1">// 11. SECURITY</span>

<span class="c1">// Bugs can be disastrous in Ethereum contracts - and even popular patterns in Solidity,</span>
<span class="c1">// may be found to be antipatterns</span>

<span class="c1">// See security links at the end of this doc</span>

<span class="c1">// 12. LOW LEVEL FUNCTIONS</span>
<span class="c1">// call - low level, not often used, does not provide type safety</span>
<span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="nv">success</span><span class="p">,</span><span class="w"> </span><span class="kt">bytes</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>data<span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>someContractAddress<span class="p">.</span>call<span class="p">(</span>
<span class="w">    </span>abi<span class="p">.</span>encodeWithSignature<span class="p">(</span><span class="s2">&quot;function_name(string,string)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;arg2&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">// delegatecall - Code at target address executed in *context* of calling contract</span>
<span class="c1">// provides library functionality</span>
<span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="nv">success</span><span class="p">,</span><span class="w"> </span><span class="kt">bytes</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>data<span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>someContractAddress<span class="p">.</span>delegatecall<span class="p">(</span>
<span class="w">    </span>abi<span class="p">.</span>encodeWithSignature<span class="p">(</span><span class="s2">&quot;function_name()&quot;</span><span class="p">)</span>
<span class="p">);</span>


<span class="c1">// 13. STYLE NOTES</span>
<span class="c1">// Based on Python&#39;s PEP8 style guide</span>
<span class="c1">// Full Style guide: http://solidity.readthedocs.io/en/develop/style-guide.html</span>

<span class="c1">// Quick summary:</span>
<span class="c1">// 4 spaces for indentation</span>
<span class="c1">// Two lines separate contract declarations (and other top level declarations)</span>
<span class="c1">// Avoid extraneous spaces in parentheses</span>
<span class="c1">// Can omit curly braces for one line statement (if, for, etc)</span>
<span class="c1">// else should be placed on own line</span>


<span class="c1">// 14. NATSPEC COMMENTS</span>
<span class="c1">// used for documentation, commenting, and external UIs</span>

<span class="c1">// Contract natspec - always above contract definition</span>
<span class="c1">/// @title Contract title</span>
<span class="c1">/// @author Author name</span>

<span class="c1">// Function natspec</span>
<span class="c1">/// @notice information about what function does; shown when function to execute</span>
<span class="c1">/// @dev Function documentation for developer</span>

<span class="c1">// Function parameter/return value natspec</span>
<span class="c1">/// @param someParam Some description of what the param does</span>
<span class="c1">/// @return Description of the return value</span>
</pre></div>
<h2>Additional resources</h2>
<ul>
<li><a href="https://solidity.readthedocs.org/en/latest/">Solidity Docs</a></li>
<li><a href="https://updraft.cyfrin.io/">Cyfrin Updraft (Learn solidity development)</a></li>
<li><a href="https://docs.chain.link/docs/beginners-tutorial">Chainlink Beginner Tutorials</a></li>
<li><a href="https://github.com/ConsenSys/smart-contract-best-practices">Smart Contract Best Practices</a></li>
<li><a href="https://remix.ethereum.org/">Browser-based Solidity Editor</a></li>
<li><a href="https://docs.erisindustries.com/tutorials/solidity/">Modular design strategies for Ethereum Contracts</a></li>
<li><a href="https://docs.chain.link/docs/getting-started">Chainlink Documentation</a></li>
</ul>
<h2>Smart Contract Development Frameworks</h2>
<ul>
<li><a href="https://getfoundry.sh/">Foundry</a></li>
<li><a href="https://hardhat.org/">Hardhat</a></li>
<li><a href="https://github.com/eth-brownie/brownie">Brownie</a></li>
</ul>
<h2>Important libraries</h2>
<ul>
<li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts">OpenZeppelin</a>: Libraries that provide common contract patterns (crowdfuding, safemath, etc)</li>
<li><a href="https://github.com/smartcontractkit/chainlink">Chainlink</a>: Code that allows you to interact with external data</li>
</ul>
<h2>Sample contracts</h2>
<ul>
<li><a href="https://github.com/ethereum/dapp-bin">Dapp Bin</a></li>
<li><a href="https://github.com/PatrickAlphaC/chainlink_defi">Defi Example</a></li>
<li><a href="https://github.com/fivedogit/solidity-baby-steps/tree/master/contracts">Solidity Baby Step Contracts</a></li>
<li><a href="https://github.com/ConsenSys/dapp-store-contracts">ConsenSys Contracts</a></li>
<li><a href="http://dapps.ethercasts.com/">State of Dapps</a></li>
<li><a href="https://github.com/Cyfrin/sc-exploits-minimized/">Security Codebase Examples</a></li>
</ul>
<h2>Security</h2>
<ul>
<li><a href="https://updraft.cyfrin.io/courses/security">Smart Contract Security Curriculum</a></li>
<li><a href="https://solodit.xyz/">Smart Contract Security Reports Database</a></li>
<li><a href="https://blog.ethereum.org/2016/06/19/thinking-smart-contract-security/">Thinking About Smart Contract Security</a></li>
<li><a href="https://blog.ethereum.org/2016/06/10/smart-contract-security/">Smart Contract Security</a></li>
<li><a href="http://hackingdistributed.com/">Hacking Distributed Blog</a></li>
</ul>
<h2>Style</h2>
<ul>
<li><a href="http://solidity.readthedocs.io/en/latest/style-guide.html">Solidity Style Guide</a>: Ethereum's style guide is heavily derived from Python's <a href="https://www.python.org/dev/peps/pep-0008/">PEP 8</a> style guide.</li>
</ul>
<h2>Editors</h2>
<ul>
<li><a href="https://remix.ethereum.org/">Remix</a></li>
<li><a href="https://github.com/ethereum/emacs-solidity">Emacs Solidity Mode</a></li>
<li><a href="https://github.com/tomlion/vim-solidity">Vim Solidity</a></li>
<li>Editor Snippets (<a href="https://gist.github.com/nemild/98343ce6b16b747788bc">Ultisnips format</a>)</li>
</ul>
<h2>Future To Dos</h2>
<ul>
<li>List of common design patterns (throttling, RNG, version upgrade)</li>
<li>Common security anti patterns</li>
</ul>
<p>Feel free to send a pull request with any edits - or email nemild -/at-/ gmail</p>

        <hr>
        <p>
          Got a suggestion? A correction, perhaps? <a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">Open an Issue</a> on the GitHub Repo, or make a <a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/solidity.md">pull request</a> yourself!
        </p>
        <p class="contributed">
          Originally contributed by Nemil Dalal, and updated by <a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/solidity.md">19 contributors</a>.
        </p>

        <footer>
          <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0; width: 80px; height: 28px; padding-bottom: 5px;" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-sa.svg" /></a>
          <p>
            &copy; 2025
            <a href="https://www.nemil.com">Nemil Dalal</a>,
            Joseph Chow,
            <a href="https://github.com/varshard">Bhoomtawath Plinsut</a>,
            <a href="https://github.com/liushooter">Shooter</a>,
            <a href="https://gist.github.com/PatrickAlphaC">Patrick Collins</a>
          </p>
        </footer>
      </div>
    </div>
  </body>
</html>