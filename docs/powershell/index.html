<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en-us" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html lang="en-us" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html lang="en-us" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en-us" class="no-js"> <!--<![endif]-->
    <head>
      <!-- Google tag (gtag.js) -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-WXC8R75DEN');
      </script>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta http-equiv="Content-Language" content="en-us">
        <!-- Use title if it's in the page YAML frontmatter -->
        <title>Learn X in Y Minutes: Scenic Programming Language Tours</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="/css/index.css">

        <link rel="canonical" href="https://learnxinyminutes.com/docs/powershell/">
        <script>
            var THEME_KEY = "lxiym_theme";
            function set_theme(theme) {
                var el = document.getElementsByTagName("html")[0];
                if (!el) {
                  return;
                }

                if (theme === "dark" ) {
                    el.className = "dark";
                } else {
                    el.className = "light";
                }

                localStorage.setItem(THEME_KEY, theme);
            }

            function load_theme() {
              var theme = localStorage.getItem(THEME_KEY);
              if (theme) {
                set_theme(theme);
              }
            }

            // Attempt immediate application of html style
            load_theme();

            // Backup: do it onload. Will flash, but better than nothing.
            window.addEventListener("load", function(){
              load_theme();
            });
        </script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="container">
            <div class="share">
    <span class="sharemsg">
      <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fdocs%2Fpowershell%2F&text=Learn+X+in+Y+minutes%2C+where+X%3Dpowershell">
        Share this page
      </a></span>

      <span class='st_facebook_large' displayText='Facebook'></span>
      <span class='st_twitter_large' displayText='Tweet'></span>
  </div>
  <div class="theme-choice">
    <label id="theme-label">Select theme:</label>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('light');">light</button>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('dark');">dark</button>
  </div>
  <h1><a href="/">Learn X in Y minutes</a></h1>
  <h2>Where X=powershell</h2>
    <p class="filelink">
    Get the code:
    <a href="/docs/files/LearnPowershell.ps1">LearnPowershell.ps1</a>
    </p>
  <div id="doc">
    <p>PowerShell is the Windows scripting language and configuration management
framework from Microsoft built on the .NET Framework. Windows 7 and up ship
with PowerShell.<br>
Nearly all examples below can be a part of a shell script or executed directly
in the shell.</p>

<p>A key difference with Bash is that it is mostly objects that you manipulate
rather than plain text. After years of evolving, it resembles Python a bit.</p>

<p><a href="https://docs.microsoft.com/powershell/scripting/overview">Read more here.</a></p>

<p>Powershell as a Language:</p>
<div class="highlight"><pre><span></span><span class="c"># Single line comments start with a number symbol.</span>

<span class="cm">&lt;#</span>
<span class="cm">  Multi-line comments</span>
<span class="cm">  like so</span>
<span class="cm">#&gt;</span>


<span class="c">####################################################</span>
<span class="c">## 1. Primitive Datatypes and Operators</span>
<span class="c">####################################################</span>

<span class="c"># Numbers</span>
<span class="n">3</span> <span class="c"># =&gt; 3</span>

<span class="c"># Math</span>
<span class="n">1</span> <span class="p">+</span> <span class="n">1</span>   <span class="c"># =&gt; 2</span>
<span class="n">8</span> <span class="p">-</span> <span class="n">1</span>   <span class="c"># =&gt; 7</span>
<span class="n">10</span> <span class="p">*</span> <span class="n">2</span>  <span class="c"># =&gt; 20</span>
<span class="n">35</span> <span class="p">/</span> <span class="n">5</span>  <span class="c"># =&gt; 7.0</span>

<span class="c"># Powershell uses banker&#39;s rounding,</span>
<span class="c"># meaning [int]1.5 would round to 2 but so would [int]2.5</span>
<span class="c"># Division always returns a float. </span>
<span class="c"># You must cast result to [int] to round.</span>
<span class="no">[int]</span><span class="n">5</span> <span class="p">/</span> <span class="no">[int]</span><span class="n">3</span>       <span class="c"># =&gt; 1.66666666666667</span>
<span class="no">[int]</span><span class="p">-</span><span class="n">5</span> <span class="p">/</span> <span class="no">[int]</span><span class="n">3</span>      <span class="c"># =&gt; -1.66666666666667</span>
<span class="n">5</span><span class="p">.</span><span class="n">0</span> <span class="p">/</span> <span class="n">3</span><span class="p">.</span><span class="n">0</span>   <span class="c"># =&gt; 1.66666666666667</span>
<span class="p">-</span><span class="n">5</span><span class="p">.</span><span class="n">0</span> <span class="p">/</span> <span class="n">3</span><span class="p">.</span><span class="n">0</span>  <span class="c"># =&gt; -1.66666666666667</span>
<span class="no">[int]</span><span class="nv">$result</span> <span class="p">=</span> <span class="n">5</span> <span class="p">/</span> <span class="n">3</span> 
<span class="nv">$result</span> <span class="c"># =&gt; 2</span>

<span class="c"># Modulo operation</span>
<span class="n">7</span> <span class="p">%</span> <span class="n">3</span>  <span class="c"># =&gt; 1</span>

<span class="c"># Exponentiation requires longform or the built-in [Math] class.</span>
<span class="no">[Math]</span><span class="p">::</span><span class="n">Pow</span><span class="p">(</span><span class="n">2</span><span class="p">,</span><span class="n">3</span><span class="p">)</span>  <span class="c"># =&gt; 8</span>

<span class="c"># Enforce order of operations with parentheses.</span>
<span class="n">1</span> <span class="p">+</span> <span class="n">3</span> <span class="p">*</span> <span class="n">2</span>  <span class="c"># =&gt; 7</span>
<span class="p">(</span><span class="n">1</span> <span class="p">+</span> <span class="n">3</span><span class="p">)</span> <span class="p">*</span> <span class="n">2</span>  <span class="c"># =&gt; 8</span>

<span class="c"># Boolean values are primitives (Note: the $)</span>
<span class="nv">$True</span>  <span class="c"># =&gt; True</span>
<span class="nv">$False</span>  <span class="c"># =&gt; False</span>

<span class="c"># negate with !</span>
<span class="p">!</span><span class="nv">$True</span>   <span class="c"># =&gt; False</span>
<span class="p">!</span><span class="nv">$False</span>  <span class="c"># =&gt; True</span>

<span class="c"># Boolean Operators</span>
<span class="c"># Note &quot;-and&quot; and &quot;-or&quot; usage</span>
<span class="nv">$True</span> <span class="o">-and</span> <span class="nv">$False</span>  <span class="c"># =&gt; False</span>
<span class="nv">$False</span> <span class="o">-or</span> <span class="nv">$True</span>   <span class="c"># =&gt; True</span>

<span class="c"># True and False are actually 1 and 0 but only support limited arithmetic.</span>
<span class="c"># However, casting the bool to int resolves this.</span>
<span class="nv">$True</span> <span class="p">+</span> <span class="nv">$True</span> <span class="c"># =&gt; 2</span>
<span class="nv">$True</span> <span class="p">*</span> <span class="n">8</span>    <span class="c"># =&gt; &#39;[System.Boolean] * [System.Int32]&#39; is undefined</span>
<span class="no">[int]</span><span class="nv">$True</span> <span class="p">*</span> <span class="n">8</span> <span class="c"># =&gt; 8</span>
<span class="nv">$False</span> <span class="p">-</span> <span class="n">5</span>   <span class="c"># =&gt; -5</span>

<span class="c"># Comparison operators look at the numerical value of True and False.</span>
<span class="n">0</span> <span class="o">-eq</span> <span class="nv">$False</span>  <span class="c"># =&gt; True</span>
<span class="n">1</span> <span class="o">-eq</span> <span class="nv">$True</span>   <span class="c"># =&gt; True</span>
<span class="n">2</span> <span class="o">-eq</span> <span class="nv">$True</span>   <span class="c"># =&gt; False</span>
<span class="p">-</span><span class="n">5</span> <span class="o">-ne</span> <span class="nv">$False</span> <span class="c"># =&gt; True</span>

<span class="c"># Using boolean logical operators on ints casts to booleans for evaluation.</span>
<span class="c"># but their non-cast value is returned</span>
<span class="c"># Don&#39;t mix up with bool(ints) and bitwise -band/-bor</span>
<span class="no">[bool]</span><span class="p">(</span><span class="n">0</span><span class="p">)</span>     <span class="c"># =&gt; False</span>
<span class="no">[bool]</span><span class="p">(</span><span class="n">4</span><span class="p">)</span>     <span class="c"># =&gt; True</span>
<span class="no">[bool]</span><span class="p">(-</span><span class="n">6</span><span class="p">)</span>    <span class="c"># =&gt; True</span>
<span class="n">0</span> <span class="o">-band</span> <span class="n">2</span>     <span class="c"># =&gt; 0</span>
<span class="p">-</span><span class="n">5</span> <span class="o">-bor</span> <span class="n">0</span>     <span class="c"># =&gt; -5</span>

<span class="c"># Equality is -eq (equals)</span>
<span class="n">1</span> <span class="o">-eq</span> <span class="n">1</span>  <span class="c"># =&gt; True</span>
<span class="n">2</span> <span class="o">-eq</span> <span class="n">1</span>  <span class="c"># =&gt; False</span>

<span class="c"># Inequality is -ne (notequals)</span>
<span class="n">1</span> <span class="o">-ne</span> <span class="n">1</span>  <span class="c"># =&gt; False</span>
<span class="n">2</span> <span class="o">-ne</span> <span class="n">1</span>  <span class="c"># =&gt; True</span>

<span class="c"># More comparisons</span>
<span class="n">1</span> <span class="o">-lt</span> <span class="n">10</span>  <span class="c"># =&gt; True</span>
<span class="n">1</span> <span class="o">-gt</span> <span class="n">10</span>  <span class="c"># =&gt; False</span>
<span class="n">2</span> <span class="o">-le</span> <span class="n">2</span>  <span class="c"># =&gt; True</span>
<span class="n">2</span> <span class="o">-ge</span> <span class="n">2</span>  <span class="c"># =&gt; True</span>

<span class="c"># Seeing whether a value is in a range</span>
<span class="n">1</span> <span class="o">-lt</span> <span class="n">2</span> <span class="o">-and</span> <span class="n">2</span> <span class="o">-lt</span> <span class="n">3</span>  <span class="c"># =&gt; True</span>
<span class="n">2</span> <span class="o">-lt</span> <span class="n">3</span> <span class="o">-and</span> <span class="n">3</span> <span class="o">-lt</span> <span class="n">2</span>  <span class="c"># =&gt; False</span>

<span class="c"># (-is vs. -eq) -is checks if two objects are the same type.</span>
<span class="c"># -eq checks if the objects have the same values, but sometimes doesn&#39;t work</span>
<span class="c"># as expected.</span>
<span class="c"># Note: we called &#39;[Math]&#39; from .NET previously without the preceeding</span>
<span class="c"># namespaces. We can do the same with [Collections.ArrayList] if preferred.</span>
<span class="no">[System.Collections.ArrayList]</span><span class="nv">$a</span> <span class="p">=</span> <span class="p">@()</span>  <span class="c"># Point a at a new list</span>
<span class="nv">$a</span> <span class="p">=</span> <span class="p">(</span><span class="n">1</span><span class="p">,</span><span class="n">2</span><span class="p">,</span><span class="n">3</span><span class="p">,</span><span class="n">4</span><span class="p">)</span>
<span class="nv">$b</span> <span class="p">=</span> <span class="nv">$a</span>                                 <span class="c"># =&gt; Point b at what a is pointing to</span>
<span class="nv">$b</span> <span class="o">-is</span> <span class="nv">$a</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span>                     <span class="c"># =&gt; True, a and b equal same type</span>
<span class="nv">$b</span> <span class="o">-eq</span> <span class="nv">$a</span>                               <span class="c"># =&gt; None! See below</span>
<span class="no">[System.Collections.Hashtable]</span><span class="nv">$b</span> <span class="p">=</span> <span class="p">@{}</span>  <span class="c"># =&gt; Point a at a new hash table</span>
<span class="nv">$b</span> <span class="p">=</span> <span class="p">@{</span><span class="s1">&#39;one&#39;</span> <span class="p">=</span> <span class="n">1</span> 
       <span class="s1">&#39;two&#39;</span> <span class="p">=</span> <span class="n">2</span><span class="p">}</span>
<span class="nv">$b</span> <span class="o">-is</span> <span class="nv">$a</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span>                     <span class="c"># =&gt; False, a and b types not equal</span>

<span class="c"># Strings are created with &quot; or &#39; but &quot; is required for string interpolation</span>
<span class="s2">&quot;This is a string.&quot;</span>
<span class="s1">&#39;This is also a string.&#39;</span>

<span class="c"># Strings can be added too! But try not to do this.</span>
<span class="s2">&quot;Hello &quot;</span> <span class="p">+</span> <span class="s2">&quot;world!&quot;</span>  <span class="c"># =&gt; &quot;Hello world!&quot;</span>

<span class="c"># A string can be treated like a list of characters</span>
<span class="s2">&quot;Hello world!&quot;</span><span class="p">[</span><span class="n">0</span><span class="p">]</span>  <span class="c"># =&gt; &#39;H&#39;</span>

<span class="c"># You can find the length of a string</span>
<span class="p">(</span><span class="s2">&quot;This is a string&quot;</span><span class="p">).</span><span class="n">Length</span>  <span class="c"># =&gt; 16</span>

<span class="c"># You can also format using f-strings or formatted string literals.</span>
<span class="nv">$name</span> <span class="p">=</span> <span class="s2">&quot;Steve&quot;</span>
<span class="nv">$age</span> <span class="p">=</span> <span class="n">22</span>
<span class="s2">&quot;He said his name is $name.&quot;</span> 
<span class="c"># =&gt; &quot;He said his name is Steve&quot;</span>
<span class="s2">&quot;{0} said he is {1} years old.&quot;</span> <span class="o">-f</span> <span class="nv">$name</span><span class="p">,</span> <span class="nv">$age</span> 
<span class="c"># =&gt; &quot;Steve said he is 22 years old&quot;</span>
<span class="s2">&quot;$name&#39;s name is </span><span class="p">$(</span><span class="nv">$name</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span><span class="s2"> characters long.&quot;</span> 
<span class="c"># =&gt; &quot;Steve&#39;s name is 5 characters long.&quot;</span>

<span class="c"># Strings can be compared with -eq, but are case insensitive. We can</span>
<span class="c"># force with -ceq or -ieq.</span>
<span class="s2">&quot;ab&quot;</span> <span class="o">-eq</span> <span class="s2">&quot;ab&quot;</span>  <span class="c"># =&gt; True</span>
<span class="s2">&quot;ab&quot;</span> <span class="o">-eq</span> <span class="s2">&quot;AB&quot;</span>  <span class="c"># =&gt; True!</span>
<span class="s2">&quot;ab&quot;</span> <span class="o">-ceq</span> <span class="s2">&quot;AB&quot;</span>  <span class="c"># =&gt; False</span>
<span class="s2">&quot;ab&quot;</span> <span class="o">-ieq</span> <span class="s2">&quot;AB&quot;</span>  <span class="c"># =&gt; True</span>

<span class="c"># Escape Characters in Powershell</span>
<span class="c"># Many languages use the &#39;\&#39;, but Windows uses this character for </span>
<span class="c"># file paths. Powershell thus uses &#39;`&#39; to escape characters</span>
<span class="c"># Take caution when working with files, as &#39;`&#39; is a</span>
<span class="c"># valid character in NTFS filenames.</span>
<span class="s2">&quot;Showing</span><span class="se">`n</span><span class="s2">Escape Chars&quot;</span> <span class="c"># =&gt; new line between Showing and Escape</span>
<span class="s2">&quot;Making</span><span class="se">`t</span><span class="s2">Tables</span><span class="se">`t</span><span class="s2">With</span><span class="se">`t</span><span class="s2">Tabs&quot;</span> <span class="c"># =&gt; Format things with tabs</span>

<span class="c"># Negate pound sign to prevent comment</span>
<span class="c"># Note that the function of &#39;#&#39; is removed, but &#39;#&#39; is still present</span>
<span class="p">`</span><span class="c">#Get-Process # =&gt; Fail: not a recognized cmdlet</span>

<span class="c"># $null is not an object</span>
<span class="nv">$null</span>  <span class="c"># =&gt; None</span>

<span class="c"># $null, 0, and empty strings and arrays all evaluate to False.</span>
<span class="c"># All other values are True</span>
<span class="k">function</span> <span class="nb">Test-Value</span> <span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s1">&#39;True&#39;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s1">&#39;False&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nb">Test-Value</span> <span class="p">(</span><span class="nv">$null</span><span class="p">)</span> <span class="c"># =&gt; False</span>
<span class="nb">Test-Value</span> <span class="p">(</span><span class="n">0</span><span class="p">)</span>     <span class="c"># =&gt; False</span>
<span class="nb">Test-Value</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>    <span class="c"># =&gt; False</span>
<span class="nb">Test-Value</span> <span class="p">[]</span>      <span class="c"># =&gt; True </span>
<span class="c"># *[] calls .NET class; creates &#39;[]&#39; string when passed to function</span>
<span class="nb">Test-Value</span> <span class="p">({})</span>    <span class="c"># =&gt; True</span>
<span class="nb">Test-Value</span> <span class="p">@()</span>     <span class="c"># =&gt; False</span>


<span class="c">####################################################</span>
<span class="c">## 2. Variables and Collections</span>
<span class="c">####################################################</span>

<span class="c"># Powershell uses the &quot;Write-Output&quot; function to print</span>
<span class="nb">Write-Output</span> <span class="s2">&quot;I&#39;m Posh. Nice to meet you!&quot;</span>  <span class="c"># =&gt; I&#39;m Posh. Nice to meet you!</span>

<span class="c"># Simple way to get input data from console</span>
<span class="nv">$userInput</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Enter some data: &quot;</span> <span class="c"># Returns the data as a string</span>

<span class="c"># There are no declarations, only assignments.</span>
<span class="c"># Convention is to use camelCase or PascalCase, whatever your team uses.</span>
<span class="nv">$someVariable</span> <span class="p">=</span> <span class="n">5</span>
<span class="nv">$someVariable</span>  <span class="c"># =&gt; 5</span>

<span class="c"># Accessing a previously unassigned variable does not throw exception.</span>
<span class="c"># The value is $null by default</span>

<span class="c"># Ternary Operators exist in Powershell 7 and up</span>
<span class="n">0</span> <span class="p">?</span> <span class="s1">&#39;yes&#39;</span> <span class="p">:</span> <span class="s1">&#39;no&#39;</span>  <span class="c"># =&gt; no</span>


<span class="c"># The default array object in Powershell is an fixed length array.</span>
<span class="nv">$defaultArray</span> <span class="p">=</span> <span class="s2">&quot;thing&quot;</span><span class="p">,</span><span class="s2">&quot;thing2&quot;</span><span class="p">,</span><span class="s2">&quot;thing3&quot;</span>
<span class="c"># you can add objects with &#39;+=&#39;, but cannot remove objects.</span>
<span class="nv">$defaultArray</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">&quot;thing4&quot;</span><span class="p">)</span> <span class="c"># =&gt; Exception &quot;Collection was of a fixed size.&quot;</span>
<span class="c"># To have a more workable array, you&#39;ll want the .NET [ArrayList] class</span>
<span class="c"># It is also worth noting that ArrayLists are significantly faster</span>

<span class="c"># ArrayLists store sequences</span>
<span class="no">[System.Collections.ArrayList]</span><span class="nv">$array</span> <span class="p">=</span> <span class="p">@()</span>
<span class="c"># You can start with a prefilled ArrayList</span>
<span class="no">[System.Collections.ArrayList]</span><span class="nv">$otherArray</span> <span class="p">=</span> <span class="p">@(</span><span class="n">5</span><span class="p">,</span> <span class="n">6</span><span class="p">,</span> <span class="n">7</span><span class="p">,</span> <span class="n">8</span><span class="p">)</span>

<span class="c"># Add to the end of a list with &#39;Add&#39; (Note: produces output, append to $null)</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">1</span><span class="p">)</span> <span class="p">&gt;</span> <span class="nv">$null</span>    <span class="c"># $array is now [1]</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">2</span><span class="p">)</span> <span class="p">&gt;</span> <span class="nv">$null</span>    <span class="c"># $array is now [1, 2]</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">4</span><span class="p">)</span> <span class="p">&gt;</span> <span class="nv">$null</span>    <span class="c"># $array is now [1, 2, 4]</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">3</span><span class="p">)</span> <span class="p">&gt;</span> <span class="nv">$null</span>    <span class="c"># $array is now [1, 2, 4, 3]</span>
<span class="c"># Remove from end with index of count of objects-1; array index starts at 0</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">RemoveAt</span><span class="p">(</span><span class="nv">$array</span><span class="p">.</span><span class="n">Count</span><span class="p">-</span><span class="n">1</span><span class="p">)</span> <span class="c"># =&gt; 3 and array is now [1, 2, 4]</span>
<span class="c"># Let&#39;s put it back</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">3</span><span class="p">)</span> <span class="p">&gt;</span> <span class="nv">$null</span>   <span class="c"># array is now [1, 2, 4, 3] again.</span>

<span class="c"># Access a list like you would any array</span>
<span class="nv">$array</span><span class="p">[</span><span class="n">0</span><span class="p">]</span>   <span class="c"># =&gt; 1</span>
<span class="c"># Look at the last element</span>
<span class="nv">$array</span><span class="p">[-</span><span class="n">1</span><span class="p">]</span>  <span class="c"># =&gt; 3</span>
<span class="c"># Looking out of bounds returns nothing</span>
<span class="nv">$array</span><span class="p">[</span><span class="n">4</span><span class="p">]</span>  <span class="c"># blank line returned</span>

<span class="c"># Remove elements from a array</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">Remove</span><span class="p">(</span><span class="nv">$array</span><span class="p">[</span><span class="n">3</span><span class="p">])</span>  <span class="c"># $array is now [1, 2, 4]</span>

<span class="c"># Insert at index an element </span>
<span class="nv">$array</span><span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">2</span><span class="p">,</span> <span class="n">3</span><span class="p">)</span>  <span class="c"># $array is now [1, 2, 3, 4]</span>

<span class="c"># Get the index of the first item found matching the argument</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">2</span><span class="p">)</span>  <span class="c"># =&gt; 1</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">6</span><span class="p">)</span>  <span class="c"># Returns -1 as &quot;outside array&quot; </span>

<span class="c"># You can add arrays</span>
<span class="c"># Note: values for $array and for $otherArray are not modified.</span>
<span class="nv">$array</span> <span class="p">+</span> <span class="nv">$otherArray</span>  <span class="c"># =&gt; [1, 2, 3, 4, 5, 6, 7, 8]</span>

<span class="c"># Concatenate arrays with &quot;AddRange()&quot;</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="nv">$otherArray</span><span class="p">)</span>  <span class="c"># Now $array is [1, 2, 3, 4, 5, 6, 7, 8]</span>

<span class="c"># Check for existence in a array with &quot;in&quot;</span>
<span class="n">1</span> <span class="n">-in</span> <span class="nv">$array</span>  <span class="c"># =&gt; True</span>

<span class="c"># Examine length with &quot;Count&quot; (Note: &quot;Length&quot; on arrayList = each items length)</span>
<span class="nv">$array</span><span class="p">.</span><span class="n">Count</span>  <span class="c"># =&gt; 8</span>

<span class="c"># You can look at ranges with slice syntax.</span>
<span class="nv">$array</span><span class="p">[</span><span class="n">1</span><span class="p">,</span><span class="n">3</span><span class="p">,</span><span class="n">5</span><span class="p">]</span>     <span class="c"># Return selected index  =&gt; [2, 4, 6]</span>
<span class="nv">$array</span><span class="p">[</span><span class="n">1</span><span class="p">..</span><span class="n">3</span><span class="p">]</span>      <span class="c"># Return from index 1 to 3 =&gt; [2, 3, 4]</span>
<span class="nv">$array</span><span class="p">[-</span><span class="n">3</span><span class="p">..-</span><span class="n">1</span><span class="p">]</span>    <span class="c"># Return from last 3 to last 1 =&gt; [6, 7, 8]</span>
<span class="nv">$array</span><span class="p">[-</span><span class="n">1</span><span class="p">..-</span><span class="n">3</span><span class="p">]</span>    <span class="c"># Return from last 1 to last 3 =&gt; [8, 7, 6]</span>
<span class="nv">$array</span><span class="p">[</span><span class="n">2</span><span class="p">..-</span><span class="n">1</span><span class="p">]</span>     <span class="c"># Return from index 2 to last (NOT as most expect) =&gt; [3, 2, 1, 8]</span>
<span class="nv">$array</span><span class="p">[</span><span class="n">0</span><span class="p">,</span><span class="n">2</span><span class="p">+</span><span class="n">4</span><span class="p">..</span><span class="n">6</span><span class="p">]</span>  <span class="c"># Return multiple ranges with the + =&gt; [1, 3, 5, 6, 7]</span>

<span class="c"># -eq doesn&#39;t compare array but extract the matching elements</span>
<span class="nv">$array</span> <span class="p">=</span> <span class="n">1</span><span class="p">,</span><span class="n">2</span><span class="p">,</span><span class="n">3</span><span class="p">,</span><span class="n">1</span><span class="p">,</span><span class="n">1</span>
<span class="nv">$array</span> <span class="o">-eq</span> <span class="n">1</span>          <span class="c"># =&gt; 1,1,1</span>
<span class="p">(</span><span class="nv">$array</span> <span class="o">-eq</span> <span class="n">1</span><span class="p">).</span><span class="n">Count</span>  <span class="c"># =&gt; 3</span>

<span class="c"># Tuples are like arrays but are immutable.</span>
<span class="c"># To use Tuples in powershell, you must use the .NET tuple class.</span>
<span class="nv">$tuple</span> <span class="p">=</span> <span class="no">[System.Tuple]</span><span class="p">::</span><span class="n">Create</span><span class="p">(</span><span class="n">1</span><span class="p">,</span> <span class="n">2</span><span class="p">,</span> <span class="n">3</span><span class="p">)</span>
<span class="nv">$tuple</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="n">0</span><span class="p">)</span>      <span class="c"># =&gt; 1</span>
<span class="nv">$tuple</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="n">0</span><span class="p">)</span> <span class="p">=</span> <span class="n">3</span>  <span class="c"># Raises a TypeError</span>

<span class="c"># You can do some of the array methods on tuples, but they are limited.</span>
<span class="nv">$tuple</span><span class="p">.</span><span class="n">Length</span>       <span class="c"># =&gt; 3</span>
<span class="nv">$tuple</span> <span class="p">+</span> <span class="p">(</span><span class="n">4</span><span class="p">,</span> <span class="n">5</span><span class="p">,</span> <span class="n">6</span><span class="p">)</span>  <span class="c"># =&gt; Exception</span>
<span class="nv">$tuple</span><span class="p">[</span><span class="n">0</span><span class="p">..</span><span class="n">2</span><span class="p">]</span>        <span class="c"># =&gt; $null (in powershell 5)    =&gt; [1, 2, 3] (in powershell 7)</span>
<span class="n">2</span> <span class="n">-in</span> <span class="nv">$tuple</span>        <span class="c"># =&gt; False</span>


<span class="c"># Hashtables store mappings from keys to values, similar to (but distinct from) Dictionaries.</span>
<span class="c"># Hashtables do not hold entry order as arrays do. </span>
<span class="nv">$emptyHash</span> <span class="p">=</span> <span class="p">@{}</span>
<span class="c"># Here is a prefilled hashtable</span>
<span class="nv">$filledHash</span> <span class="p">=</span> <span class="p">@{</span><span class="s2">&quot;one&quot;</span><span class="p">=</span> <span class="n">1</span> 
                <span class="s2">&quot;two&quot;</span><span class="p">=</span> <span class="n">2</span> 
                <span class="s2">&quot;three&quot;</span><span class="p">=</span> <span class="n">3</span><span class="p">}</span>

<span class="c"># Look up values with []</span>
<span class="nv">$filledHash</span><span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">]</span>  <span class="c"># =&gt; 1</span>

<span class="c"># Get all keys as an iterable with &quot;.Keys&quot;.</span>
<span class="nv">$filledHash</span><span class="p">.</span><span class="n">Keys</span>  <span class="c"># =&gt; [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span>

<span class="c"># Get all values as an iterable with &quot;.Values&quot;.</span>
<span class="nv">$filledHash</span><span class="p">.</span><span class="n">Values</span>  <span class="c"># =&gt; [1, 2, 3]</span>

<span class="c"># Check for existence of keys or values in a hash with &quot;-in&quot;</span>
<span class="s2">&quot;one&quot;</span> <span class="n">-in</span> <span class="nv">$filledHash</span><span class="p">.</span><span class="n">Keys</span>  <span class="c"># =&gt; True</span>
<span class="n">1</span> <span class="n">-in</span> <span class="nv">$filledHash</span><span class="p">.</span><span class="n">Values</span>    <span class="c"># =&gt; False (in powershell 5)    =&gt; True (in powershell 7)</span>

<span class="c"># Looking up a non-existing key returns $null</span>
<span class="nv">$filledHash</span><span class="p">[</span><span class="s2">&quot;four&quot;</span><span class="p">]</span>  <span class="c"># $null</span>

<span class="c"># Adding to a hashtable</span>
<span class="nv">$filledHash</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">&quot;five&quot;</span><span class="p">,</span><span class="n">5</span><span class="p">)</span>  <span class="c"># $filledHash[&quot;five&quot;] is set to 5</span>
<span class="nv">$filledHash</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">&quot;five&quot;</span><span class="p">,</span><span class="n">6</span><span class="p">)</span>  <span class="c"># exception &quot;Item with key &quot;five&quot; has already been added&quot;</span>
<span class="nv">$filledHash</span><span class="p">[</span><span class="s2">&quot;four&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="n">4</span>    <span class="c"># $filledHash[&quot;four&quot;] is set to 4, running again does nothing</span>

<span class="c"># Remove keys from a hashtable</span>
<span class="nv">$filledHash</span><span class="p">.</span><span class="n">Remove</span><span class="p">(</span><span class="s2">&quot;one&quot;</span><span class="p">)</span> <span class="c"># Removes the key &quot;one&quot; from filled hashtable</span>


<span class="c">####################################################</span>
<span class="c">## 3. Control Flow and Iterables</span>
<span class="c">####################################################</span>

<span class="c"># Let&#39;s just make a variable</span>
<span class="nv">$someVar</span> <span class="p">=</span> <span class="n">5</span>

<span class="c"># Here is an if statement.</span>
<span class="c"># This prints &quot;$someVar is smaller than 10&quot;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$someVar</span> <span class="o">-gt</span> <span class="n">10</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;$someVar is bigger than 10.&quot;</span>
<span class="p">}</span>
<span class="k">elseif</span> <span class="p">(</span><span class="nv">$someVar</span> <span class="o">-lt</span> <span class="n">10</span><span class="p">)</span> <span class="p">{</span>    <span class="c"># This elseif clause is optional.</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;$someVar is smaller than 10.&quot;</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>                        <span class="c"># This is optional too.</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;$someVar is indeed 10.&quot;</span>
<span class="p">}</span>


<span class="cm">&lt;#</span>
<span class="cm">Foreach loops iterate over arrays</span>
<span class="cm">prints:</span>
<span class="cm">    dog is a mammal</span>
<span class="cm">    cat is a mammal</span>
<span class="cm">    mouse is a mammal</span>
<span class="cm">#&gt;</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$animal</span> <span class="k">in</span> <span class="p">(</span><span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;mouse&quot;</span><span class="p">))</span> <span class="p">{</span>
    <span class="c"># You can use -f to interpolate formatted strings</span>
    <span class="s2">&quot;{0} is a mammal&quot;</span> <span class="o">-f</span> <span class="nv">$animal</span>
<span class="p">}</span>

<span class="cm">&lt;#</span>
<span class="cm">For loops iterate over arrays and you can specify indices</span>
<span class="cm">prints:</span>
<span class="cm">   0 a</span>
<span class="cm">   1 b</span>
<span class="cm">   2 c</span>
<span class="cm">   3 d</span>
<span class="cm">   4 e</span>
<span class="cm">   5 f</span>
<span class="cm">   6 g</span>
<span class="cm">   7 h</span>
<span class="cm">#&gt;</span>
<span class="nv">$letters</span> <span class="p">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-le</span> <span class="nv">$letters</span><span class="p">.</span><span class="n">Count</span><span class="p">-</span><span class="n">1</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++){</span>
    <span class="nb">Write-Host</span> <span class="nv">$i</span><span class="p">,</span> <span class="nv">$letters</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span>
<span class="p">}</span>

<span class="cm">&lt;#</span>
<span class="cm">While loops go until a condition is no longer met.</span>
<span class="cm">prints:</span>
<span class="cm">    0</span>
<span class="cm">    1</span>
<span class="cm">    2</span>
<span class="cm">    3</span>
<span class="cm">#&gt;</span>
<span class="nv">$x</span> <span class="p">=</span> <span class="n">0</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$x</span> <span class="o">-lt</span> <span class="n">4</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="nv">$x</span>
    <span class="nv">$x</span> <span class="p">+=</span> <span class="n">1</span>  <span class="c"># Shorthand for x = x + 1</span>
<span class="p">}</span>

<span class="c"># Switch statements are more powerful compared to most languages</span>
<span class="nv">$val</span> <span class="p">=</span> <span class="s2">&quot;20&quot;</span>
<span class="k">switch</span><span class="p">(</span><span class="nv">$val</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-eq</span> <span class="n">42</span> <span class="p">}</span>           <span class="p">{</span> <span class="s2">&quot;The answer equals 42&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="s1">&#39;20&#39;</span>                    <span class="p">{</span> <span class="s2">&quot;Exactly 20&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-like</span> <span class="s1">&#39;s*&#39;</span> <span class="p">}</span>       <span class="p">{</span> <span class="s2">&quot;Case insensitive&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-clike</span> <span class="s1">&#39;s*&#39;</span><span class="p">}</span>       <span class="p">{</span> <span class="s2">&quot;clike, ceq, cne for case sensitive&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-notmatch</span> <span class="s1">&#39;^.*$&#39;</span><span class="p">}</span>  <span class="p">{</span> <span class="s2">&quot;Regex matching. cnotmatch, cnotlike, ...&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="k">default</span>                 <span class="p">{</span> <span class="s2">&quot;Others&quot;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="c"># Handle exceptions with a try/catch block</span>
<span class="k">try</span> <span class="p">{</span>
    <span class="c"># Use &quot;throw&quot; to raise an error</span>
    <span class="k">throw</span> <span class="s2">&quot;This is an error&quot;</span>
<span class="p">}</span>
<span class="k">catch</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="nv">$Error</span><span class="p">.</span><span class="n">ExceptionMessage</span>
<span class="p">}</span>
<span class="k">finally</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;We can clean up resources here&quot;</span>
<span class="p">}</span>


<span class="c"># Writing to a file</span>
<span class="nv">$contents</span> <span class="p">=</span> <span class="p">@{</span><span class="s2">&quot;aa&quot;</span><span class="p">=</span> <span class="n">12</span> 
             <span class="s2">&quot;bb&quot;</span><span class="p">=</span> <span class="n">21</span><span class="p">}</span>
<span class="nv">$contents</span> <span class="p">|</span> <span class="nb">Export-CSV</span> <span class="s2">&quot;$env:HOMEDRIVE\file.csv&quot;</span> <span class="c"># writes to a file</span>

<span class="nv">$contents</span> <span class="p">=</span> <span class="s2">&quot;test string here&quot;</span>
<span class="nv">$contents</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="s2">&quot;$env:HOMEDRIVE\file.txt&quot;</span> <span class="c"># writes to another file</span>

<span class="c"># Read file contents and convert to json</span>
<span class="nb">Get-Content</span> <span class="s2">&quot;$env:HOMEDRIVE\file.csv&quot;</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span>


<span class="c">####################################################</span>
<span class="c">## 4. Functions</span>
<span class="c">####################################################</span>

<span class="c"># Use &quot;function&quot; to create new functions</span>
<span class="c"># Keep the Verb-Noun naming convention for functions</span>
<span class="k">function</span> <span class="nb">Add-Numbers</span> <span class="p">{</span>
 <span class="nv">$args</span><span class="p">[</span><span class="n">0</span><span class="p">]</span> <span class="p">+</span> <span class="nv">$args</span><span class="p">[</span><span class="n">1</span><span class="p">]</span>
<span class="p">}</span>

<span class="nb">Add-Numbers</span> <span class="n">1</span> <span class="n">2</span> <span class="c"># =&gt; 3</span>

<span class="c"># Calling functions with parameters</span>
<span class="k">function</span> <span class="nb">Add-ParamNumbers</span> <span class="p">{</span>
 <span class="k">param</span><span class="p">(</span> <span class="no">[int]</span><span class="nv">$firstNumber</span><span class="p">,</span> <span class="no">[int]</span><span class="nv">$secondNumber</span> <span class="p">)</span>
 <span class="nv">$firstNumber</span> <span class="p">+</span> <span class="nv">$secondNumber</span>
<span class="p">}</span>

<span class="nb">Add-ParamNumbers</span> <span class="n">-FirstNumber</span> <span class="n">1</span> <span class="n">-SecondNumber</span> <span class="n">2</span> <span class="c"># =&gt; 3 </span>

<span class="c"># Functions with named parameters, parameter attributes, parsable documentation</span>
<span class="cm">&lt;#</span>
<span class="sd">.SYNOPSIS</span>
<span class="cm">Setup a new website</span>
<span class="sd">.DESCRIPTION</span>
<span class="cm">Creates everything your new website needs for much win</span>
<span class="sd">.PARAMETER</span><span class="cm"> siteName</span>
<span class="cm">The name for the new website</span>
<span class="sd">.EXAMPLE</span>
<span class="cm">New-Website -Name FancySite -Po 5000</span>
<span class="cm">New-Website SiteWithDefaultPort</span>
<span class="cm">New-Website siteName 2000 # ERROR! Port argument could not be validated</span>
<span class="cm">(&#39;name1&#39;,&#39;name2&#39;) | New-Website -Verbose</span>
<span class="cm">#&gt;</span>
<span class="k">function</span> <span class="nb">New-Website</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">[</span><span class="k">CmdletBinding</span><span class="p">()]</span>
    <span class="k">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="k">Parameter</span><span class="p">(</span><span class="k">ValueFromPipeline</span><span class="p">=</span><span class="nv">$true</span><span class="p">,</span> <span class="k">Mandatory</span><span class="p">=</span><span class="nv">$true</span><span class="p">)]</span>
        <span class="p">[</span><span class="k">Alias</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)]</span>
        <span class="no">[string]</span><span class="nv">$siteName</span><span class="p">,</span>
        <span class="p">[</span><span class="k">ValidateSet</span><span class="p">(</span><span class="n">3000</span><span class="p">,</span><span class="n">5000</span><span class="p">,</span><span class="n">8000</span><span class="p">)]</span>
        <span class="no">[int]</span><span class="nv">$port</span> <span class="p">=</span> <span class="n">3000</span>
    <span class="p">)</span>
    <span class="k">BEGIN</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s1">&#39;Creating new website(s)&#39;</span> <span class="p">}</span>
    <span class="k">PROCESS</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s2">&quot;name: $siteName, port: $port&quot;</span> <span class="p">}</span>
    <span class="k">END</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s1">&#39;Website(s) created&#39;</span> <span class="p">}</span>
<span class="p">}</span>


<span class="c">####################################################</span>
<span class="c">## 5. Modules</span>
<span class="c">####################################################</span>

<span class="c"># You can import modules and install modules</span>
<span class="c"># The Install-Module is similar to pip or npm, pulls from Powershell Gallery</span>
<span class="nb">Install-Module</span> <span class="n">dbaTools</span>
<span class="nb">Import-Module</span> <span class="n">dbaTools</span>

<span class="nv">$query</span> <span class="p">=</span> <span class="s2">&quot;SELECT * FROM dbo.sometable&quot;</span>
<span class="nv">$queryParams</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="n">SqlInstance</span> <span class="p">=</span> <span class="s1">&#39;testInstance&#39;</span>
    <span class="n">Database</span>    <span class="p">=</span> <span class="s1">&#39;testDatabase&#39;</span>
    <span class="n">Query</span>       <span class="p">=</span> <span class="nv">$query</span>
<span class="p">}</span>
<span class="nb">Invoke-DbaQuery</span> <span class="nv">@queryParams</span>

<span class="c"># You can get specific functions from a module</span>
<span class="nb">Import-Module</span> <span class="n">-Function</span> <span class="nb">Invoke-DbaQuery</span>


<span class="c"># Powershell modules are just ordinary Posh files. You</span>
<span class="c"># can write your own, and import them. The name of the</span>
<span class="c"># module is the same as the name of the file.</span>

<span class="c"># You can find out which functions and attributes</span>
<span class="c"># are defined in a module.</span>
<span class="nb">Get-Command</span> <span class="n">-module</span> <span class="n">dbaTools</span>
<span class="nb">Get-Help</span> <span class="n">dbaTools</span> <span class="n">-Full</span>


<span class="c">####################################################</span>
<span class="c">## 6. Classes</span>
<span class="c">####################################################</span>

<span class="c"># We use the &quot;class&quot; statement to create a class</span>
<span class="n">class</span> <span class="n">Instrument</span> <span class="p">{</span>
    <span class="no">[string]</span><span class="nv">$Type</span>
    <span class="no">[string]</span><span class="nv">$Family</span>
<span class="p">}</span>

<span class="nv">$instrument</span> <span class="p">=</span> <span class="no">[Instrument]</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="nv">$instrument</span><span class="p">.</span><span class="nb">Type </span><span class="p">=</span> <span class="s2">&quot;String Instrument&quot;</span>
<span class="nv">$instrument</span><span class="p">.</span><span class="n">Family</span> <span class="p">=</span> <span class="s2">&quot;Plucked String&quot;</span>

<span class="nv">$instrument</span>

<span class="cm">&lt;# Output:</span>
<span class="cm">Type              Family        </span>
<span class="cm">----              ------        </span>
<span class="cm">String Instrument Plucked String</span>
<span class="cm">#&gt;</span>


<span class="c">####################################################</span>
<span class="c">## 6.1 Inheritance</span>
<span class="c">####################################################</span>

<span class="c"># Inheritance allows new child classes to be defined that inherit </span>
<span class="c"># methods and variables from their parent class.</span>

<span class="n">class</span> <span class="n">Guitar</span> <span class="p">:</span> <span class="n">Instrument</span>
<span class="p">{</span>
    <span class="no">[string]</span><span class="nv">$Brand</span>
    <span class="no">[string]</span><span class="nv">$SubType</span>
    <span class="no">[string]</span><span class="nv">$ModelType</span>
    <span class="no">[string]</span><span class="nv">$ModelNumber</span>
<span class="p">}</span>

<span class="nv">$myGuitar</span> <span class="p">=</span> <span class="no">[Guitar]</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="nv">$myGuitar</span><span class="p">.</span><span class="n">Brand</span>       <span class="p">=</span> <span class="s2">&quot;Taylor&quot;</span>
<span class="nv">$myGuitar</span><span class="p">.</span><span class="n">SubType</span>     <span class="p">=</span> <span class="s2">&quot;Acoustic&quot;</span>
<span class="nv">$myGuitar</span><span class="p">.</span><span class="n">ModelType</span>   <span class="p">=</span> <span class="s2">&quot;Presentation&quot;</span>
<span class="nv">$myGuitar</span><span class="p">.</span><span class="n">ModelNumber</span> <span class="p">=</span> <span class="s2">&quot;PS14ce Blackwood&quot;</span>

<span class="nv">$myGuitar</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span>

<span class="cm">&lt;#</span>
<span class="cm">IsPublic IsSerial Name                                     BaseType                                               </span>
<span class="cm">-------- -------- ----                                     --------                                               </span>
<span class="cm">True     False    Guitar                                   Instrument  </span>
<span class="cm">#&gt;</span>


<span class="c">####################################################</span>
<span class="c">## 7. Advanced</span>
<span class="c">####################################################</span>

<span class="c"># The powershell pipeline allows things like High-Order Functions.</span>

<span class="c"># Group-Object is a handy cmdlet that does incredible things.</span>
<span class="c"># It works much like a GROUP BY in SQL.</span>

<span class="cm">&lt;#</span>
<span class="cm"> The following will get all the running processes,</span>
<span class="cm"> group them by Name,</span>
<span class="cm"> and tell us how many instances of each process we have running.</span>
<span class="cm"> Tip: Chrome and svcHost are usually big numbers in this regard.</span>
<span class="cm">#&gt;</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="k">Foreach</span><span class="n">-Object</span> <span class="n">ProcessName</span> <span class="p">|</span> <span class="nb">Group-Object</span>

<span class="c"># Useful pipeline examples are iteration and filtering.</span>
<span class="n">1</span><span class="p">..</span><span class="n">10</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="s2">&quot;Loop number $PSITEM&quot;</span> <span class="p">}</span>
<span class="n">1</span><span class="p">..</span><span class="n">10</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$PSITEM</span> <span class="o">-gt</span> <span class="n">5</span> <span class="p">}</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span>

<span class="c"># A notable pitfall of the pipeline is its performance when</span>
<span class="c"># compared with other options.</span>
<span class="c"># Additionally, raw bytes are not passed through the pipeline,</span>
<span class="c"># so passing an image causes some issues.</span>
<span class="c"># See more on that in the link at the bottom.</span>

<span class="cm">&lt;#</span>
<span class="cm"> Asynchronous functions exist in the form of jobs.</span>
<span class="cm"> Typically a procedural language,</span>
<span class="cm"> Powershell can operate non-blocking functions when invoked as Jobs.</span>
<span class="cm">#&gt;</span>

<span class="c"># This function is known to be non-optimized, and therefore slow.</span>
<span class="nv">$installedApps</span> <span class="p">=</span> <span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">Win32_Product</span>

<span class="c"># If we had a script, it would hang at this func for a period of time.</span>
<span class="nv">$scriptBlock</span> <span class="p">=</span> <span class="p">{</span><span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">Win32_Product</span><span class="p">}</span>
<span class="nb">Start-Job</span> <span class="n">-ScriptBlock</span> <span class="nv">$scriptBlock</span>

<span class="c"># This will start a background job that runs the command.</span>
<span class="c"># You can then obtain the status of jobs and their returned results.</span>
<span class="nv">$allJobs</span> <span class="p">=</span> <span class="nb">Get-Job</span>
<span class="nv">$jobResponse</span> <span class="p">=</span> <span class="nb">Get-Job</span> <span class="p">|</span> <span class="nb">Receive-Job</span>


<span class="c"># Math is built in to powershell and has many functions.</span>
<span class="nv">$r</span><span class="p">=</span><span class="n">2</span>
<span class="nv">$pi</span><span class="p">=</span><span class="no">[math]</span><span class="p">::</span><span class="n">pi</span>
<span class="nv">$r2</span><span class="p">=</span><span class="no">[math]</span><span class="p">::</span><span class="n">pow</span><span class="p">(</span> <span class="nv">$r</span><span class="p">,</span> <span class="n">2</span> <span class="p">)</span>
<span class="nv">$area</span> <span class="p">=</span> <span class="nv">$pi</span><span class="p">*</span><span class="nv">$r2</span>
<span class="nv">$area</span>

<span class="c"># To see all possibilities, check the members.</span>
<span class="no">[System.Math]</span> <span class="p">|</span> <span class="nb">Get-Member</span> <span class="n">-Static</span> <span class="n">-MemberType</span> <span class="n">All</span>


<span class="cm">&lt;#</span>
<span class="cm"> This is a silly one:</span>
<span class="cm"> You may one day be asked to create a func that could take $start and $end</span>
<span class="cm"> and reverse anything in an array within the given range</span>
<span class="cm"> based on an arbitrary array without mutating the original array.</span>
<span class="cm"> Let&#39;s see one way to do that and introduce another data structure.</span>
<span class="cm">#&gt;</span>

<span class="nv">$targetArray</span> <span class="p">=</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;j&#39;</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span>

<span class="k">function</span> <span class="nb">Format-Range</span> <span class="p">(</span><span class="nv">$start</span><span class="p">,</span> <span class="nv">$end</span><span class="p">,</span> <span class="nv">$array</span><span class="p">)</span> <span class="p">{</span>
    <span class="no">[System.Collections.ArrayList]</span><span class="nv">$firstSectionArray</span> <span class="p">=</span> <span class="p">@()</span>
    <span class="no">[System.Collections.ArrayList]</span><span class="nv">$secondSectionArray</span> <span class="p">=</span> <span class="p">@()</span>
    <span class="no">[System.Collections.Stack]</span><span class="nv">$stack</span> <span class="p">=</span> <span class="p">@()</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$index</span> <span class="p">=</span> <span class="n">0</span><span class="p">;</span> <span class="nv">$index</span> <span class="o">-lt</span> <span class="nv">$array</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="nv">$index</span><span class="p">++)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$index</span> <span class="o">-lt</span> <span class="nv">$start</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$firstSectionArray</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="nv">$array</span><span class="p">[</span><span class="nv">$index</span><span class="p">])</span> <span class="p">&gt;</span> <span class="nv">$null</span>
        <span class="p">}</span>
        <span class="k">elseif</span> <span class="p">(</span><span class="nv">$index</span> <span class="o">-ge</span> <span class="nv">$start</span> <span class="o">-and</span> <span class="nv">$index</span> <span class="o">-le</span> <span class="nv">$end</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$stack</span><span class="p">.</span><span class="n">Push</span><span class="p">(</span><span class="nv">$array</span><span class="p">[</span><span class="nv">$index</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$secondSectionArray</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="nv">$array</span><span class="p">[</span><span class="nv">$index</span><span class="p">])</span> <span class="p">&gt;</span> <span class="nv">$null</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nv">$finalArray</span> <span class="p">=</span> <span class="nv">$firstSectionArray</span> <span class="p">+</span> <span class="nv">$stack</span><span class="p">.</span><span class="n">ToArray</span><span class="p">()</span> <span class="p">+</span> <span class="nv">$secondSectionArray</span>
    <span class="k">return</span> <span class="nv">$finalArray</span>
<span class="p">}</span>

<span class="nb">Format-Range</span> <span class="n">2</span> <span class="n">6</span> <span class="nv">$targetArray</span> 
<span class="c"># =&gt; &#39;a&#39;,&#39;b&#39;,&#39;g&#39;,&#39;f&#39;,&#39;e&#39;,&#39;d&#39;,&#39;c&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;l&#39;,&#39;m&#39;</span>

<span class="c"># The previous method works, but uses extra memory by allocating new arrays.</span>
<span class="c"># It&#39;s also kind of lengthy.</span>
<span class="c"># Let&#39;s see how we can do this without allocating a new array.</span>
<span class="c"># This is slightly faster as well.</span>

<span class="k">function</span> <span class="nb">Format-Range</span> <span class="p">(</span><span class="nv">$start</span><span class="p">,</span> <span class="nv">$end</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">while</span> <span class="p">(</span><span class="nv">$start</span> <span class="o">-lt</span> <span class="nv">$end</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="nv">$temp</span> <span class="p">=</span> <span class="nv">$targetArray</span><span class="p">[</span><span class="nv">$start</span><span class="p">]</span>
      <span class="nv">$targetArray</span><span class="p">[</span><span class="nv">$start</span><span class="p">]</span> <span class="p">=</span> <span class="nv">$targetArray</span><span class="p">[</span><span class="nv">$end</span><span class="p">]</span>
      <span class="nv">$targetArray</span><span class="p">[</span><span class="nv">$end</span><span class="p">]</span> <span class="p">=</span> <span class="nv">$temp</span>
      <span class="nv">$start</span><span class="p">++</span>
      <span class="nv">$end</span><span class="p">--</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nv">$targetArray</span>
<span class="p">}</span>

<span class="nb">Format-Range</span> <span class="n">2</span> <span class="n">6</span> <span class="c"># =&gt; &#39;a&#39;,&#39;b&#39;,&#39;g&#39;,&#39;f&#39;,&#39;e&#39;,&#39;d&#39;,&#39;c&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;l&#39;,&#39;m&#39;</span>
</pre></div>
<p>Powershell as a Tool:</p>

<p>Getting Help:</p>
<div class="highlight"><pre><span></span><span class="c"># Find commands</span>
<span class="nb">Get-Command</span> <span class="n">about_</span><span class="p">*</span> <span class="c"># alias: gcm</span>
<span class="nb">Get-Command</span> <span class="n">-Verb</span> <span class="n">Add</span>
<span class="nb">Get-Alias</span> <span class="nb">ps</span>
<span class="nb">Get-Alias</span> <span class="n">-Definition</span> <span class="nb">Get-Process</span>

<span class="nb">Get-Help</span> <span class="nb">ps </span><span class="p">|</span> <span class="n">less</span> <span class="c"># alias: help</span>
<span class="nb">ps </span><span class="p">|</span> <span class="nb">Get-Member</span> <span class="c"># alias: gm</span>

<span class="nb">Show-Command</span> <span class="nb">Get-WinEvent</span> <span class="c"># Display GUI to fill in the parameters</span>

<span class="nb">Update-Help</span> <span class="c"># Run as admin</span>
</pre></div>
<p>If you are uncertain about your environment:</p>
<div class="highlight"><pre><span></span><span class="nb">Get-ExecutionPolicy</span> <span class="n">-List</span>
<span class="nb">Set-ExecutionPolicy</span> <span class="n">AllSigned</span>
<span class="c"># Execution policies include:</span>
<span class="c"># - Restricted: Scripts won&#39;t run.</span>
<span class="c"># - RemoteSigned: Downloaded scripts run only if signed by a trusted publisher. </span>
<span class="c"># - AllSigned: Scripts need to be signed by a trusted publisher.</span>
<span class="c"># - Unrestricted: Run all scripts.</span>
<span class="n">help</span> <span class="n">about_Execution_Policies</span> <span class="c"># for more info</span>

<span class="c"># Current PowerShell version:</span>
<span class="nv">$PSVersionTable</span>
</pre></div><div class="highlight"><pre><span></span><span class="c"># Calling external commands, executables, </span>
<span class="c"># and functions with the call operator.</span>
<span class="c"># Exe paths with arguments passed or containing spaces can create issues.</span>
<span class="n">C</span><span class="p">:\</span><span class="n">Program</span> <span class="n">Files</span><span class="p">\</span><span class="n">dotnet</span><span class="p">\</span><span class="n">dotnet</span><span class="p">.</span><span class="n">exe</span>
<span class="c"># The term &#39;C:\Program&#39; is not recognized as a name of a cmdlet,</span>
<span class="c"># function, script file, or executable program.</span>
<span class="c"># Check the spelling of the name, or if a path was included, </span>
<span class="c"># verify that the path is correct and try again</span>

<span class="s2">&quot;C:\Program Files\dotnet\dotnet.exe&quot;</span>
<span class="n">C</span><span class="p">:\</span><span class="n">Program</span> <span class="n">Files</span><span class="p">\</span><span class="n">dotnet</span><span class="p">\</span><span class="n">dotnet</span><span class="p">.</span><span class="n">exe</span>    <span class="c"># returns string rather than execute</span>

<span class="p">&amp;</span><span class="s2">&quot;C:\Program Files\dotnet\dotnet.exe --help&quot;</span>   <span class="c"># fail</span>
<span class="p">&amp;</span><span class="s2">&quot;C:\Program Files\dotnet\dotnet.exe&quot;</span> <span class="p">-</span><span class="n">-help</span>   <span class="c"># success</span>
<span class="c"># Alternatively, you can use dot-sourcing here</span>
<span class="p">.</span><span class="s2">&quot;C:\Program Files\dotnet\dotnet.exe&quot;</span> <span class="p">-</span><span class="n">-help</span>   <span class="c"># success</span>

<span class="c"># the call operator (&amp;) is similar to Invoke-Expression, </span>
<span class="c"># but IEX runs in current scope.</span>
<span class="c"># One usage of &#39;&amp;&#39; would be to invoke a scriptblock inside of your script.</span>
<span class="c"># Notice the variables are scoped</span>
<span class="nv">$i</span> <span class="p">=</span> <span class="n">2</span>
<span class="nv">$scriptBlock</span> <span class="p">=</span> <span class="p">{</span> <span class="nv">$i</span><span class="p">=</span><span class="n">5</span><span class="p">;</span> <span class="nb">Write-Output</span> <span class="nv">$i</span> <span class="p">}</span>
<span class="p">&amp;</span> <span class="nv">$scriptBlock</span> <span class="c"># =&gt; 5</span>
<span class="nv">$i</span> <span class="c"># =&gt; 2</span>

<span class="nb">invoke-expression</span> <span class="s1">&#39; $i=5; Write-Output $i &#39;</span> <span class="c"># =&gt; 5</span>
<span class="nv">$i</span> <span class="c"># =&gt; 5</span>

<span class="c"># Alternatively, to preserve changes to public variables</span>
<span class="c"># you can use &quot;Dot-Sourcing&quot;. This will run in the current scope.</span>
<span class="nv">$x</span><span class="p">=</span><span class="n">1</span>
<span class="p">&amp;{</span><span class="nv">$x</span><span class="p">=</span><span class="n">2</span><span class="p">};</span><span class="nv">$x</span> <span class="c"># =&gt; 1</span>

<span class="p">.{</span><span class="nv">$x</span><span class="p">=</span><span class="n">2</span><span class="p">};</span><span class="nv">$x</span> <span class="c"># =&gt; 2</span>


<span class="c"># Remoting into computers is easy.</span>
<span class="nb">Enter-PSSession</span> <span class="n">-ComputerName</span> <span class="n">RemoteComputer</span>

<span class="c"># Once remoted in, you can run commands as if you&#39;re local.</span>
<span class="n">RemoteComputer</span><span class="p">\</span><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Process</span> <span class="n">powershell</span>

<span class="cm">&lt;#</span>
<span class="cm">Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                             </span>
<span class="cm">-------  ------    -----      -----     ------     --  -- -----------                                             </span>
<span class="cm">   1096      44   156324     179068      29.92  11772   1 powershell                                              </span>
<span class="cm">    545      25    49512      49852             25348   0 powershell </span>
<span class="cm">#&gt;</span>
<span class="n">RemoteComputer</span><span class="p">\</span><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Exit-PSSession</span>

<span class="cm">&lt;#</span>
<span class="cm"> Powershell is an incredible tool for Windows management and Automation.</span>
<span class="cm"> Let&#39;s take the following scenario:</span>
<span class="cm"> You have 10 servers.</span>
<span class="cm"> You need to check whether a service is running on all of them.</span>
<span class="cm"> You can RDP and log in, or PSSession to all of them, but why?</span>
<span class="cm"> Check out the following</span>
<span class="cm">#&gt;</span>

<span class="nv">$serverList</span> <span class="p">=</span> <span class="p">@(</span>
    <span class="s1">&#39;server1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;server2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;server3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;server4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;server5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;server6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;server7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;server8&#39;</span><span class="p">,</span>
    <span class="s1">&#39;server9&#39;</span><span class="p">,</span>
    <span class="s1">&#39;server10&#39;</span>
<span class="p">)</span>

<span class="no">[scriptblock]</span><span class="nv">$script</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nb">Get-Service</span> <span class="n">-DisplayName</span> <span class="s1">&#39;Task Scheduler&#39;</span>
<span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$server</span> <span class="k">in</span> <span class="nv">$serverList</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$cmdSplat</span> <span class="p">=</span> <span class="p">@{</span>
        <span class="n">ComputerName</span>  <span class="p">=</span> <span class="nv">$server</span>
        <span class="n">JobName</span>       <span class="p">=</span> <span class="s1">&#39;checkService&#39;</span>
        <span class="n">ScriptBlock</span>   <span class="p">=</span> <span class="nv">$script</span>
        <span class="n">AsJob</span>         <span class="p">=</span> <span class="nv">$true</span>
        <span class="n">ErrorAction</span>   <span class="p">=</span> <span class="s1">&#39;SilentlyContinue&#39;</span>
    <span class="p">}</span>
    <span class="nb">Invoke-Command</span> <span class="nv">@cmdSplat</span> <span class="p">|</span> <span class="nb">Out-Null</span>
<span class="p">}</span>

<span class="cm">&lt;#</span>
<span class="cm"> Here we&#39;ve invoked jobs across many servers.</span>
<span class="cm"> We can now Receive-Job and see if they&#39;re all running.</span>
<span class="cm"> Now scale this up 100x as many servers :)</span>
<span class="cm">#&gt;</span>
</pre></div>
<p>Interesting Projects  </p>

<ul>
<li><a href="https://channel9.msdn.com/Search?term=powershell%20pipeline#ch9Search&amp;lang-en=en">Channel9</a> PowerShell tutorials</li>
<li><a href="https://powershellexplained.com/">KevinMarquette&rsquo;s Powershell Blog</a> Excellent blog that goes into great detail on Powershell</li>
<li><a href="https://github.com/psget/psget">PSGet</a> NuGet for PowerShell</li>
<li><a href="https://github.com/lzybkr/PSReadLine/">PSReadLine</a> A bash inspired readline implementation for PowerShell (So good that it now ships with Windows10 by default!)</li>
<li><a href="https://github.com/dahlbyk/posh-git/">Posh-Git</a> Fancy Git Prompt (Recommended!)</li>
<li><a href="https://github.com/JanDeDobbeleer/oh-my-posh">Oh-My-Posh</a> Shell customization similar to the popular Oh-My-Zsh on Mac</li>
<li><a href="https://github.com/psake/psake">PSake</a> Build automation tool</li>
<li><a href="https://github.com/pester/Pester">Pester</a> BDD Testing Framework</li>
<li><a href="https://github.com/vors/ZLocation">ZLocation</a> Powershell <code>cd</code> that reads your mind</li>
<li><a href="https://github.com/Pscx/Pscx">PowerShell Community Extensions</a></li>
<li><a href="https://github.com/PowerShell/PowerShell/issues/1908">More on the Powershell Pipeline Issue</a></li>
</ul>

    <hr>
    <p>Got a suggestion? A correction, perhaps? <a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">Open an Issue</a> on the GitHub Repo, or make a <a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/powershell.html.markdown">pull request</a> yourself!
    </p>
    <p class="contributed">
    Originally contributed by Wouter Van Schandevijl, and updated by <a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/powershell.html.markdown">10 contributors</a>.
    </p>

    <footer>
    <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>
    <p>
    &copy; 2024
        <a href="https://github.com/laoujin">Wouter Van Schandevijl</a>,
        <a href="https://github.com/AndrewDavis1191">Andrew Ryan Davis</a>
    </p>

    <p>

    </footer>
  </div>

        </div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script src="/js/script.js"></script>
    </body>
</html>
