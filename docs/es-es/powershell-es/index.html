<!DOCTYPE html lang="es-es" xml:lang="es-es" xmlns="http://www.w3.org/1999/xhtml">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
      <!-- Google tag (gtag.js) -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-WXC8R75DEN');
      </script>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta http-equiv="Content-Language" content="es-es">
        <!-- Use title if it's in the page YAML frontmatter -->
        <title>Learn X in Y Minutes: Scenic Programming Language Tours</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="/css/index.css">

        <link rel="canonical" href="https://learnxinyminutes.com/docs/es-es/powershell-es/">
        <script>
            var THEME_KEY = "lxiym_theme";
            function set_theme(theme) {
                var el = document.getElementsByTagName("html")[0];
                if (!el) {
                  return;
                }

                if (theme === "dark" ) {
                    el.className = "dark";
                } else {
                    el.className = "light";
                }

                localStorage.setItem(THEME_KEY, theme);
            }

            function load_theme() {
              var theme = localStorage.getItem(THEME_KEY);
              if (theme) {
                set_theme(theme);
              }
            }

            // Attempt immediate application of html style
            load_theme();

            // Backup: do it onload. Will flash, but better than nothing.
            window.addEventListener("load", function(){
              load_theme();
            });
        </script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="container">
            <div class="share">
    <span class="sharemsg">
      <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fdocs%2Fes-es%2Fpowershell-es%2F&text=Aprende+X+en+Y+minutos%2C+donde+X%3Dpowershell">
        Comparte esta página
      </a></span>

      <span class='st_facebook_large' displayText='Facebook'></span>
      <span class='st_twitter_large' displayText='Tweet'></span>
  </div>
  <div class="theme-choice">
    <label id="theme-label">Seleccione el tema:</label>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('light');">ligero</button>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('dark');">oscuro</button>
  </div>
  <h1><a href="/">Aprende X en Y minutos</a></h1>
  <h2>Donde X=powershell</h2>
    <p class="filelink">
    Descarga el código:
    <a href="/docs/files/LearnPowershell-es.ps1">LearnPowershell-es.ps1</a>
    </p>
  <div id="doc">
    <p>PowerShell es el lenguaje de automatización y gestión de configuraciones de Windows hecho por Microsoft basado en .NET Framework. Desde Windows 7 en adelante, esos sistemas operativos incluyen un intérprete de PowerShell.
Casi todos los ejemplos a continuación pueden ser parte de un script o ejecutados directamente en la consola de PowerShell.</p>

<p>Una diferencia clave con respecto a Bash es que en PowerShell casi todo son manipulaciones de objetos en vez de análisis sobre flujos de texto plano.</p>

<p><a href="https://technet.microsoft.com/en-us/library/bb978526.aspx">Leer más acá.</a> (EN)</p>

<p>Si no está seguro sobre el ambiente de ejecución en su sistema:</p>
<div class="highlight"><pre class="highlight powershell"><code><span class="n">Get-ExecutionPolicy</span><span class="w"> </span><span class="nt">-List</span><span class="w">
</span><span class="n">Set-ExecutionPolicy</span><span class="w"> </span><span class="nx">AllSigned</span><span class="w">
</span><span class="c"># Otras opciones de políticas de ejecución son:</span><span class="w">
</span><span class="c"># - Restricted: Los scripts no correrán.</span><span class="w">
</span><span class="c"># - RemoteSigned: Los scripts que se hayan descargado sólo correrán si han sido firmados por un editor de confianza. </span><span class="w">
</span><span class="c"># - AllSigned: Los scripts requieren ser firmados por un editor de confianza.</span><span class="w">
</span><span class="c"># - Unrestricted: Ejecuta cualquier script.</span><span class="w">
</span><span class="n">help</span><span class="w"> </span><span class="nx">about_Execution_Policies</span><span class="w"> </span><span class="c"># para obtener más ayuda sobre políticas de ejecución.</span><span class="w">

</span><span class="c"># Versión instalada de PowerShell:</span><span class="w">
</span><span class="bp">$PSVersionTable</span><span class="w">
</span></code></pre></div>
<p>Para obtener ayuda:</p>
<div class="highlight"><pre class="highlight powershell"><code><span class="c"># Si necesita encontrar algún comando</span><span class="w">
</span><span class="n">Get-Command</span><span class="w"> </span><span class="nx">about_</span><span class="o">*</span><span class="w"> </span><span class="c"># tiene por abreviación (o alias): gcm</span><span class="w">
</span><span class="n">Get-Command</span><span class="w"> </span><span class="nt">-Verb</span><span class="w"> </span><span class="nx">Add</span><span class="w"> </span><span class="c"># lista todos los comandos que tienen por verbo 'Add'</span><span class="w">
</span><span class="n">Get-Alias</span><span class="w"> </span><span class="nx">ps</span><span class="w">
</span><span class="n">Get-Alias</span><span class="w"> </span><span class="nt">-Definition</span><span class="w"> </span><span class="nx">Get-Process</span><span class="w">

</span><span class="n">Get-Help</span><span class="w"> </span><span class="nx">ps</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="c"># alias: help</span><span class="w">
</span><span class="n">ps</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Get-Member</span><span class="w"> </span><span class="c"># alias: gm</span><span class="w">

</span><span class="n">Show-Command</span><span class="w"> </span><span class="nx">Get-EventLog</span><span class="w"> </span><span class="c"># Muestra un formulario para llenar los parámetros del comando Get-EventLog</span><span class="w">

</span><span class="n">Update-Help</span><span class="w"> </span><span class="c"># Actualiza la ayuda (debe ser ejecutado en una consola elevada como admin)</span><span class="w">
</span></code></pre></div>
<p>Acá inicia el tutorial:</p>
<div class="highlight"><pre class="highlight powershell"><code><span class="c"># Como ya lo notó, los comentarios empiezan con #</span><span class="w">

</span><span class="c"># Ejemplo de un simple hola mundo:</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="nx">Hola</span><span class="w"> </span><span class="nx">mundo</span><span class="o">!</span><span class="w">
</span><span class="c"># echo es el alias del comando Write-Output (a los comandos también se les dice cmdlets)</span><span class="w">
</span><span class="c"># La mayoría de los cmdlets y funciones siguen la convención de llamarse de la forma: Verbo-Sustantivo</span><span class="w">

</span><span class="c"># Cada comando inicia en una nueva línea, o después de un punto y coma:</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s1">'Esta es la primer línea'</span><span class="p">;</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="s1">'Esta es la segunda'</span><span class="w">

</span><span class="c"># La declaración de una variable se ve así:</span><span class="w">
</span><span class="nv">$unaCadena</span><span class="w"> </span><span class="o">=</span><span class="s2">"Algún texto"</span><span class="w">
</span><span class="c"># O así:</span><span class="w">
</span><span class="nv">$unNumero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">-as</span><span class="w"> </span><span class="p">[</span><span class="n">double</span><span class="p">]</span><span class="w"> 
</span><span class="nv">$unaLista</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="w">
</span><span class="nv">$unaCadena</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$unaLista</span><span class="w"> </span><span class="o">-join</span><span class="w"> </span><span class="s1">'--'</span><span class="w"> </span><span class="c"># también existe el parámetro -split </span><span class="w">
</span><span class="nv">$unaTablaHash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="nx">nom1</span><span class="o">=</span><span class="s1">'val1'</span><span class="p">;</span><span class="w"> </span><span class="nx">nom2</span><span class="o">=</span><span class="s1">'val2'</span><span class="p">}</span><span class="w">

</span><span class="c"># Uso de variables:</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="nv">$unaCadena</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Interpolación: </span><span class="nv">$unaCadena</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"</span><span class="se">`$</span><span class="s2">unaCadena tiene longitud de </span><span class="si">$(</span><span class="nv">$unaCadena</span><span class="o">.</span><span class="nf">Length</span><span class="si">)</span><span class="s2">"</span><span class="w">  
</span><span class="n">echo</span><span class="w"> </span><span class="s1">'$unaCadena'</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="sh">@"
Esta es una Here-String
</span><span class="nv">$otraVariable</span><span class="sh">
"@</span><span class="w">
</span><span class="c"># Note que una ' (comilla simple) no expande las variables!</span><span class="w">
</span><span class="c"># Las Here-Strings también funcionan con comilla simple</span><span class="w">

</span><span class="c"># Variables Automáticas:</span><span class="w">
</span><span class="c"># Hay algunas variables previamente definidas en el ambiente que le pueden servir, tales como</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Booleanos: </span><span class="nv">$TRUE</span><span class="s2"> y </span><span class="nv">$FALSE</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Valor vacío: </span><span class="nv">$NULL</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Valor de retorno del último programa: </span><span class="bp">$?</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Código de salida del último programa en Windows: </span><span class="bp">$LastExitCode</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"El último token en la última línea de la sesión activa: </span><span class="bp">$$</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"El primer token: </span><span class="bp">$^</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"PID del script: </span><span class="bp">$PID</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Ruta completa del directorio dónde está el script actual: </span><span class="bp">$PSScriptRoot</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s1">'Ruta completa de script actual: '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">$MyInvocation</span><span class="o">.</span><span class="nf">MyCommand</span><span class="o">.</span><span class="nf">Path</span><span class="w">
</span><span class="nx">echo</span><span class="w"> </span><span class="s2">"Ruta completa de directorio actual: </span><span class="nv">$Pwd</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Argumentos pasados a la invocación de una función, script o bloque de código: </span><span class="bp">$PSBoundParameters</span><span class="s2">"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Argumentos no predefinidos: </span><span class="si">$(</span><span class="nv">$Args</span><span class="w"> </span><span class="o">-join</span><span class="w"> </span><span class="s1">', '</span><span class="si">)</span><span class="s2">."</span><span class="w">
</span><span class="c"># Para saber más sobre variables automáticas: `help about_Automatic_Variables`</span><span class="w">

</span><span class="c"># Para enlazar otro archivo (operador punto)</span><span class="w">
</span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="n">\otroNombreDeScript.ps1</span><span class="w">


</span><span class="c">### Control de Flujo</span><span class="w">
</span><span class="c"># Tenemos la estructura de if como es usual:</span><span class="w">
</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$Edad</span><span class="w"> </span><span class="o">-is</span><span class="w"> </span><span class="p">[</span><span class="n">string</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">echo</span><span class="w"> </span><span class="s1">'Pero... si $Edad no puede ser una cadena de texto!'</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">elseif</span><span class="w"> </span><span class="p">(</span><span class="nv">$Edad</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">-and</span><span class="w"> </span><span class="nv">$Edad</span><span class="w"> </span><span class="o">-gt</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">echo</span><span class="w"> </span><span class="s1">'Niño (Menor de 12. Mayor que 0)'</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">echo</span><span class="w"> </span><span class="s1">'Adulto'</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># Sentencias switch de PS son más poderosas comparadas con otros lenguajes</span><span class="w">
</span><span class="nv">$val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"20"</span><span class="w">
</span><span class="kr">switch</span><span class="p">(</span><span class="nv">$val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="p">}</span><span class="w">           </span><span class="p">{</span><span class="w"> </span><span class="s2">"La respuesta es 42"</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="s1">'20'</span><span class="w">                    </span><span class="p">{</span><span class="w"> </span><span class="s2">"Exactamente 20"</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s1">'s*'</span><span class="w"> </span><span class="p">}</span><span class="w">       </span><span class="p">{</span><span class="w"> </span><span class="s2">"No distingue entre mayúsculas/minúsculas"</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-clike</span><span class="w"> </span><span class="s1">'s*'</span><span class="p">}</span><span class="w">       </span><span class="p">{</span><span class="w"> </span><span class="s2">"clike, ceq, cne para ser diferenciar el caso entre mayúsculas/minúsculas"</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-notmatch</span><span class="w"> </span><span class="s1">'^.*$'</span><span class="p">}</span><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="s2">"Emparejamiento de expresiones regulares. cnotmatch, cnotlike, ..."</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="s1">'x'</span><span class="w"> </span><span class="o">-contains</span><span class="w"> </span><span class="s1">'x'</span><span class="p">}</span><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="s2">"FALSO! -contains es para listas!"</span><span class="p">;</span><span class="w"> </span><span class="kr">break</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="n">default</span><span class="w">                 </span><span class="p">{</span><span class="w"> </span><span class="s2">"Otros"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># El for clásico</span><span class="w">
</span><span class="kr">for</span><span class="p">(</span><span class="nv">$i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="nv">$i</span><span class="w"> </span><span class="o">-le</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"Número de ciclo </span><span class="nv">$i</span><span class="s2">"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="c"># O más corto</span><span class="w">
</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"Número de ciclo </span><span class="bp">$_</span><span class="s2">"</span><span class="w"> </span><span class="p">}</span><span class="w">

</span><span class="c"># PowerShell también incluye</span><span class="w">
</span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$var</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="s1">'valor1'</span><span class="p">,</span><span class="s1">'valor2'</span><span class="p">,</span><span class="s1">'valor3'</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="nv">$var</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="c"># while () {}</span><span class="w">
</span><span class="c"># do {} while ()</span><span class="w">
</span><span class="c"># do {} until ()</span><span class="w">

</span><span class="c"># Manejo de excepciones</span><span class="w">
</span><span class="kr">try</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="kr">finally</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="kr">try</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">[</span><span class="n">System.NullReferenceException</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">echo</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">Exception</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Format-List</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span><span class="p">}</span><span class="w">


</span><span class="c">### Proveedores</span><span class="w">
</span><span class="c"># Lista de archivos y directorios en la ubicación actual</span><span class="w">
</span><span class="n">ls</span><span class="w"> </span><span class="c"># o el alias `dir`</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nx">~</span><span class="w"> </span><span class="c"># ir al directorio principal del usuario</span><span class="w">

</span><span class="n">Get-Alias</span><span class="w"> </span><span class="nx">ls</span><span class="w"> </span><span class="c"># -&gt; Get-ChildItem</span><span class="w">
</span><span class="c"># ¿¡Eh!? Estos cmdlets tienen nombres genéricos porque a diferencia de otros lenguajes de scripting,</span><span class="w">
</span><span class="c"># PowerShell no opera únicamente en el directorio actual.</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nx">HKCU:</span><span class="w"> </span><span class="c"># se dirige a la rama HKEY_CURRENT_USER del registro de Windows</span><span class="w">

</span><span class="c"># Para hacer un listado de todos los proveedores disponibles</span><span class="w">
</span><span class="n">Get-PSProvider</span><span class="w">


</span><span class="c">### Tuberías</span><span class="w">
</span><span class="c"># Los Cmdlets tienen parámetros que controlan su ejecución:</span><span class="w">
</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="nt">-Filter</span><span class="w"> </span><span class="o">*.</span><span class="nf">txt</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="c"># Se obtiene sólo el nombre de todos los archivos txt</span><span class="w">
</span><span class="c"># Sólo se necesita escribir caracteres de un parámetro hasta que deja de ser ambiguo</span><span class="w">
</span><span class="n">ls</span><span class="w"> </span><span class="nt">-fi</span><span class="w"> </span><span class="o">*.</span><span class="nf">txt</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="c"># -f no se puede porque también existe -Force </span><span class="w">
</span><span class="c"># Use `Get-Help Get-ChildItem -Full` para un tratado más completo</span><span class="w">

</span><span class="c"># Los results del cmdlet anterior se le pueden pasar como entrada al siguiente.</span><span class="w">
</span><span class="c"># `$_` representa el objeto actual en el objeto de tubería.</span><span class="w">
</span><span class="n">ls</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">-match</span><span class="w"> </span><span class="s1">'c'</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Export-CSV</span><span class="w"> </span><span class="nx">exportado.txt</span><span class="w">
</span><span class="n">ls</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">?</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">-match</span><span class="w"> </span><span class="s1">'c'</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-HTML</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out-File</span><span class="w"> </span><span class="nx">exportado.html</span><span class="w">

</span><span class="c"># Si se confunde con la tubería use `Get-Member` para revisar</span><span class="w">
</span><span class="c"># los métodos y propiedades de los objetos de la tubería:</span><span class="w">
</span><span class="n">ls</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Get-Member</span><span class="w">
</span><span class="nx">Get-Date</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">gm</span><span class="w">

</span><span class="c"># ` es el caracter de continuación de línea. O termine la línea con un |</span><span class="w">
</span><span class="n">Get-Process</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Sort-Object</span><span class="w"> </span><span class="nx">ID</span><span class="w"> </span><span class="nt">-Descending</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select-Object</span><span class="w"> </span><span class="nt">-First</span><span class="w"> </span><span class="nx">10</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="nx">ID</span><span class="p">,</span><span class="nx">VM</span><span class="w"> </span><span class="se">`
</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">Stop-Process</span><span class="w"> </span><span class="nt">-WhatIf</span><span class="w">

</span><span class="n">Get-EventLog</span><span class="w"> </span><span class="nx">Application</span><span class="w"> </span><span class="nt">-After</span><span class="w"> </span><span class="p">(</span><span class="n">Get-Date</span><span class="p">)</span><span class="o">.</span><span class="nf">AddHours</span><span class="p">(</span><span class="nt">-2</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Format-List</span><span class="w">

</span><span class="c"># Use % como una abreviación de ForEach-Object</span><span class="w">
</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ForEach-Object</span><span class="w"> </span><span class="se">`
</span><span class="w">    </span><span class="nt">-Begin</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"Iniciando"</span><span class="p">;</span><span class="w"> </span><span class="nv">$counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="err">`</span><span class="w">
    </span><span class="nt">-Process</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"Procesando </span><span class="bp">$_</span><span class="s2">"</span><span class="p">;</span><span class="w"> </span><span class="nv">$counter</span><span class="o">++</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="err">`</span><span class="w">
    </span><span class="nt">-End</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"Terminando: </span><span class="nv">$counter</span><span class="s2">"</span><span class="w"> </span><span class="p">}</span><span class="w">

</span><span class="c"># El siguiente comando ps (alias de Get-Process) devuelve una tabla con 3 columnas</span><span class="w">
</span><span class="c"># La tercera columan es el valor de memoria virtual en MB y usando 2 dígitos decimales</span><span class="w">
</span><span class="c"># Las columnas calculadas pueden escribirse más extensamente como:</span><span class="w">
</span><span class="c"># `@{name='lbl';expression={$_}`</span><span class="w">
</span><span class="n">ps</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Format-Table</span><span class="w"> </span><span class="nx">ID</span><span class="p">,</span><span class="nx">Name</span><span class="p">,@{</span><span class="nx">n</span><span class="o">=</span><span class="s1">'VM(MB)'</span><span class="p">;</span><span class="nx">e</span><span class="o">=</span><span class="p">{</span><span class="s1">'{0:n2}'</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="p">(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">VM</span><span class="w"> </span><span class="n">/</span><span class="w"> </span><span class="nx">1MB</span><span class="p">)}}</span><span class="w"> </span><span class="nt">-autoSize</span><span class="w">


</span><span class="c">### Funciones</span><span class="w">
</span><span class="c"># El atributo [string] es opcional.</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">foo</span><span class="p">([</span><span class="n">string</span><span class="p">]</span><span class="nv">$nombre</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">echo</span><span class="w"> </span><span class="s2">"Hey </span><span class="nv">$nombre</span><span class="s2">, aquí tiene una función"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># Llamando una función</span><span class="w">
</span><span class="n">foo</span><span class="w"> </span><span class="s2">"Diga mi nombre"</span><span class="w">

</span><span class="c"># Funciones con parámetros nombrados, atributos de parámetros y documentación analizable</span><span class="w">
</span><span class="cm">&lt;#
</span><span class="cs">.SYNOPSIS</span><span class="cm">
Establecer un nuevo sitio web
</span><span class="cs">.DESCRIPTION</span><span class="cm">
Crea todo lo que su sitio necesite
</span><span class="cs">.PARAMETER</span><span class="cm"> siteName
El nombre para el nuevo sitio web
</span><span class="cs">.EXAMPLE</span><span class="cm">
Crear-SitioWeb -Nombre SitioBonito -Po 5000
Crear-SitioWeb SiteWithDefaultPort
Crear-SitioWeb nombreSitio 2000 # ERROR! No se pudo validar arguemento de puerto
('nombre1','nombre2') | Crear-SitioWeb -Verbose
#&gt;</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">Crear-SitioWeb</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">[</span><span class="n">CmdletBinding</span><span class="p">()]</span><span class="w">
    </span><span class="kr">param</span><span class="w"> </span><span class="p">(</span><span class="w">
        </span><span class="p">[</span><span class="n">Parameter</span><span class="p">(</span><span class="n">ValueFromPipeline</span><span class="o">=</span><span class="bp">$true</span><span class="p">,</span><span class="w"> </span><span class="n">Mandatory</span><span class="o">=</span><span class="bp">$true</span><span class="p">)]</span><span class="w">
        </span><span class="p">[</span><span class="n">Alias</span><span class="p">(</span><span class="s1">'nombre'</span><span class="p">)]</span><span class="w">
        </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$nombreSitio</span><span class="p">,</span><span class="w">
        </span><span class="p">[</span><span class="n">ValidateSet</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span><span class="mi">5000</span><span class="p">,</span><span class="mi">8000</span><span class="p">)]</span><span class="w">
        </span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="nv">$puerto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3000</span><span class="w">
    </span><span class="p">)</span><span class="w">
    </span><span class="kr">BEGIN</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Write-Verbose</span><span class="w"> </span><span class="s1">'Creando nuevo(s) sitio(s) web'</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="kr">PROCESS</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="s2">"nombre: </span><span class="nv">$nombreSitio</span><span class="s2">, puerto: </span><span class="nv">$puerto</span><span class="s2">"</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="kr">END</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Write-Verbose</span><span class="w"> </span><span class="s1">'Sitio(s) web creado(s)'</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">


</span><span class="c">### Todo es .NET</span><span class="w">
</span><span class="c"># Una cadena PS es, de hecho, una cadena tipo System.String de .NET </span><span class="w">
</span><span class="c"># Todos los métodos y propiedades de .NET están disponibles</span><span class="w">
</span><span class="s1">'cadena'</span><span class="o">.</span><span class="nf">ToUpper</span><span class="p">()</span><span class="o">.</span><span class="nf">Replace</span><span class="p">(</span><span class="s1">'E'</span><span class="p">,</span><span class="w"> </span><span class="s1">'eee'</span><span class="p">)</span><span class="w">
</span><span class="c"># O más powershellezco</span><span class="w">
</span><span class="s1">'cadena'</span><span class="o">.</span><span class="nf">ToUpper</span><span class="p">()</span><span class="w"> </span><span class="o">-replace</span><span class="w"> </span><span class="s1">'E'</span><span class="p">,</span><span class="w"> </span><span class="s1">'eee'</span><span class="w">

</span><span class="c"># ¿No recuerda cómo es que se llama cierto método .NET?</span><span class="w">
</span><span class="s1">'cadena'</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">gm</span><span class="w">

</span><span class="c"># Sintaxis para ejecutar métodos .NET estáticos</span><span class="w">
</span><span class="p">[</span><span class="n">System.Reflection.Assembly</span><span class="p">]::</span><span class="n">LoadWithPartialName</span><span class="p">(</span><span class="s1">'Microsoft.VisualBasic'</span><span class="p">)</span><span class="w">

</span><span class="c"># Nótese que cualquier función que proviene de .NET Framework REQUIERE paréntesis para ser invocada</span><span class="w">
</span><span class="c"># al contrario de las funciones definidas desde PS, las cuales NO PUEDEN ser invocadas con paréntesis.</span><span class="w">
</span><span class="c"># Si se invoca una función/cmdlet de PS usando paréntesis,</span><span class="w">
</span><span class="c"># es equivalente a que le estuviera pasando un parámetro de tipo lista</span><span class="w">
</span><span class="nv">$writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.IO.StreamWriter</span><span class="p">(</span><span class="nv">$ruta</span><span class="p">,</span><span class="w"> </span><span class="bp">$true</span><span class="p">)</span><span class="w">
</span><span class="nv">$writer</span><span class="o">.</span><span class="nf">Write</span><span class="p">([</span><span class="n">Environment</span><span class="p">]::</span><span class="nx">NewLine</span><span class="p">)</span><span class="w">
</span><span class="nv">$writer</span><span class="o">.</span><span class="nf">Dispose</span><span class="p">()</span><span class="w">

</span><span class="c">### Entrada/Salida</span><span class="w">
</span><span class="c"># Leyendo una variable </span><span class="w">
</span><span class="nv">$Nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Read-Host</span><span class="w"> </span><span class="s2">"¿Cómo se llama?"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"¡Hola </span><span class="nv">$Nombre</span><span class="s2">!"</span><span class="w">
</span><span class="p">[</span><span class="n">int</span><span class="p">]</span><span class="nv">$Edad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Read-Host</span><span class="w"> </span><span class="s2">"¿Cuál es su edad?"</span><span class="w">

</span><span class="c"># Test-Path, Split-Path, Join-Path, Resolve-Path</span><span class="w">
</span><span class="c"># Get-Content filename # devuelve un string[]</span><span class="w">
</span><span class="c"># Set-Content, Add-Content, Clear-Content</span><span class="w">
</span><span class="n">Get-Command</span><span class="w"> </span><span class="nx">ConvertTo-</span><span class="o">*</span><span class="p">,</span><span class="nx">ConvertFrom-</span><span class="o">*</span><span class="w">


</span><span class="c">### Material útil</span><span class="w">
</span><span class="c"># Actualizar la ruta de ejecuciones (PATH)</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">PATH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Environment</span><span class="p">]::</span><span class="n">GetEnvironmentVariable</span><span class="p">(</span><span class="s2">"Path"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Machine"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="s2">";"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">[</span><span class="n">System.Environment</span><span class="p">]::</span><span class="n">GetEnvironmentVariable</span><span class="p">(</span><span class="s2">"Path"</span><span class="p">,</span><span class="w"> </span><span class="s2">"User"</span><span class="p">)</span><span class="w">

</span><span class="c"># Encontrar Python en el path</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">PATH</span><span class="o">.</span><span class="nf">Split</span><span class="p">(</span><span class="s2">";"</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"*python*"</span><span class="p">}</span><span class="w">

</span><span class="c"># Cambiar el directorio de trabajo sin tener que memorizar la ruta anterior</span><span class="w">
</span><span class="n">Push-Location</span><span class="w"> </span><span class="nx">c:\temp</span><span class="w"> </span><span class="c"># se cambia el directorio de trabajo a c:\temp</span><span class="w">
</span><span class="n">Pop-Location</span><span class="w"> </span><span class="c"># revierte el cambio y se devuelve a donde estaba al principio</span><span class="w">
</span><span class="c"># Los aliases son : pushd y popd</span><span class="w">

</span><span class="c"># Desbloquear un archivo después de descargarlo de Internet</span><span class="w">
</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Unblock-File</span><span class="w">

</span><span class="c"># Abre Windows Explorer en la ruta actual (usando el alias ii de Invoke-Item)</span><span class="w">
</span><span class="n">ii</span><span class="w"> </span><span class="o">.</span><span class="w">

</span><span class="c"># Pulse cualquier tecla para salir</span><span class="w">
</span><span class="nv">$host</span><span class="o">.</span><span class="nf">UI</span><span class="o">.</span><span class="nf">RawUI</span><span class="o">.</span><span class="nf">ReadKey</span><span class="p">()</span><span class="w">
</span><span class="kr">return</span><span class="w">

</span><span class="c"># Para crear un acceso directo</span><span class="w">
</span><span class="nv">$WshShell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nt">-comObject</span><span class="w"> </span><span class="nx">WScript.Shell</span><span class="w">
</span><span class="nv">$Shortcut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$WshShell</span><span class="o">.</span><span class="nf">CreateShortcut</span><span class="p">(</span><span class="nv">$link</span><span class="p">)</span><span class="w">
</span><span class="nv">$Shortcut</span><span class="o">.</span><span class="nf">TargetPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$file</span><span class="w">
</span><span class="nv">$Shortcut</span><span class="o">.</span><span class="nf">WorkingDirectory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Split-Path</span><span class="w"> </span><span class="nv">$file</span><span class="w">
</span><span class="nv">$Shortcut</span><span class="o">.</span><span class="nf">Save</span><span class="p">()</span><span class="w">
</span></code></pre></div>
<p>Configurando el shell</p>
<div class="highlight"><pre class="highlight powershell"><code><span class="c"># $Profile es la ruta completa para su `Microsoft.PowerShell_profile.ps1`</span><span class="w">
</span><span class="c"># Todo el código alojado allí será ejecutado cuando se ejecuta una nueva sesión de PS </span><span class="w">
</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">-not</span><span class="w"> </span><span class="p">(</span><span class="n">Test-Path</span><span class="w"> </span><span class="nv">$Profile</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">New-Item</span><span class="w"> </span><span class="nt">-Type</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$Profile</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
    </span><span class="n">notepad</span><span class="w"> </span><span class="nv">$Profile</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="c"># Más información en: `help about_profiles`</span><span class="w">
</span><span class="c"># Para un shell más productivo, asegúrese de verifivar el proyecto PSReadLine descrito abajo</span><span class="w">
</span></code></pre></div>
<p>Proyectos interesantes (EN)</p>

<ul>
<li><a href="https://channel9.msdn.com/Search?term=powershell%20pipeline#ch9Search&amp;lang-en=en">Channel9</a> Tutoriales de PowerShell</li>
<li><a href="https://github.com/psget/psget">PSGet</a> NuGet para PowerShell</li>
<li><a href="https://github.com/lzybkr/PSReadLine/">PSReadLine</a> Una implementación inspirada en bash para PowerShell (¡Es tan buena que ahora viene con Windows10 por defecto!)</li>
<li><a href="https://github.com/dahlbyk/posh-git/">Posh-Git</a> Un intérprete bonito de Git (¡Recomendado!)</li>
<li><a href="https://github.com/psake/psake">PSake</a> Herramienta de automatización de compilaciones</li>
<li><a href="https://github.com/pester/Pester">Pester</a> Framework de pruebas BDD</li>
<li><a href="https://github.com/tkellogg/Jump-Location">Jump-Location</a> Powershell <code>cd</code> que lee su mente</li>
</ul>

<p>Material no cubierto en esta guía  </p>

<ul>
<li>WMI: Windows Management Intrumentation (Get-CimInstance)<br></li>
<li>Multitarea: Start-Job -scriptBlock {&hellip;}, </li>
<li>Firmas de código</li>
<li>Remoting (Enter-PSSession/Exit-PSSession; Invoke-Command)</li>
</ul>

    <hr>
    <p>¿Tienes una sugerencia o rectificación? <a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">Abre un issue</a> en el repositorio de Github, o haz un <a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/es-es/powershell-es.html.markdown">pull request</a> tu mismo
    </p>
    <p class="contributed">
    Originalmente contribuido por Wouter Van Schandevijl, y actualizado por <a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/es-es/powershell-es.html.markdown">2 colaborador(es)</a>.
    </p>

    <footer>
    <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>
    <p>
    &copy; 2024
        <a href="https://github.com/laoujin">Wouter Van Schandevijl</a>
    </p>

    <p>
      Translated by:
        <a href="https://github.com/alexitosrv">Alexander Salamanca</a>

    </footer>
  </div>

        </div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script src="/js/script.js"></script>
    </body>
</html>
