<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="zh-cn" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html lang="zh-cn" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html lang="zh-cn" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="zh-cn" class="no-js"> <!--<![endif]-->
    <head>
      <!-- Google tag (gtag.js) -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-WXC8R75DEN');
      </script>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta http-equiv="Content-Language" content="zh-cn">
        <!-- Use title if it's in the page YAML frontmatter -->
        <title>Learn X in Y Minutes: Scenic Programming Language Tours</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="/css/index.css">

        <link rel="canonical" href="https://learnxinyminutes.com/docs/zh-cn/powershell-cn/">
        <script>
            var THEME_KEY = "lxiym_theme";
            function set_theme(theme) {
                var el = document.getElementsByTagName("html")[0];
                if (!el) {
                  return;
                }

                if (theme === "dark" ) {
                    el.className = "dark";
                } else {
                    el.className = "light";
                }

                localStorage.setItem(THEME_KEY, theme);
            }

            function load_theme() {
              var theme = localStorage.getItem(THEME_KEY);
              if (theme) {
                set_theme(theme);
              }
            }

            // Attempt immediate application of html style
            load_theme();

            // Backup: do it onload. Will flash, but better than nothing.
            window.addEventListener("load", function(){
              load_theme();
            });
        </script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="container">
            <div class="share">
    <span class="sharemsg">
      <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fdocs%2Fzh-cn%2Fpowershell-cn%2F&text=Y%E5%88%86%E9%92%9F%E9%80%9F%E6%88%90X%2C+%E5%85%B6%E4%B8%AD+X%3Dpowershell">
        分享此页
      </a></span>

      <span class='st_facebook_large' displayText='Facebook'></span>
      <span class='st_twitter_large' displayText='Tweet'></span>
  </div>
  <div class="theme-choice">
    <label id="theme-label">选择主题：</label>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('light');">亮</button>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('dark');">暗</button>
  </div>
  <h1><a href="/">Y分钟速成X</a></h1>
  <h2>其中 X=powershell</h2>
    <p class="filelink">
    源代码下载：
    <a href="/docs/files/LearnPowershell-cn.ps1">LearnPowershell-cn.ps1</a>
    </p>
  <div id="doc">
    <p>PowerShell 是 Windows 平台下的脚本语言同时也是配置管理框架，它是建立在微软 .Net Framework 之上，Windows 7 以及之后版本都内置 Poweshell。下面的示例中都是 PoweShell 脚本的一部分或者直接能够在 Shell 交互窗口中执行。</p>

<p>与 Bash 最大的不同是你大部分操作的东西是对象而不是普通的文本。</p>

<p><a href="https://docs.microsoft.com/zh-cn/powershell/scripting/overview">延伸阅读</a></p>

<p>如果你不确定你的环境，执行如下操作：</p>
<div class="highlight"><pre><span></span><span class="nb">Get-ExecutionPolicy</span> <span class="n">-List</span>
<span class="nb">Set-ExecutionPolicy</span> <span class="n">AllSigned</span>
<span class="c"># Execution Policy 包含以下：</span>
<span class="c"># - Restricted: 不会运行脚本。</span>
<span class="c"># - RemoteSigned: 只会运行受信任的发行商下载的脚本。</span>
<span class="c"># - AllSigned: 运行需要被信任发行商签名的脚本。</span>
<span class="c"># - Unrestricted: 运行所有脚本</span>
<span class="n">help</span> <span class="n">about_Execution_Policies</span> <span class="c"># 查看更多信息</span>

<span class="c"># 当前 PowerShell 版本</span>
<span class="nv">$PSVersionTable</span>
</pre></div>
<p>获取帮助</p>
<div class="highlight"><pre><span></span><span class="c"># 查找命令</span>
<span class="nb">Get-Command</span> <span class="n">about_</span><span class="p">*</span> <span class="c"># 别名: gcm</span>
<span class="nb">Get-Command</span> <span class="n">-Verb</span> <span class="n">Add</span>
<span class="nb">Get-Alias</span> <span class="nb">ps</span>
<span class="nb">Get-Alias</span> <span class="n">-Definition</span> <span class="nb">Get-Process</span>

<span class="nb">Get-Help</span> <span class="nb">ps </span><span class="p">|</span> <span class="n">less</span> <span class="c"># 别名: help</span>
<span class="nb">ps </span><span class="p">|</span> <span class="nb">Get-Member</span> <span class="c"># 别名: gm</span>

<span class="nb">Show-Command</span> <span class="nb">Get-EventLog</span> <span class="c"># GUI 填充参数</span>

<span class="nb">Update-Help</span> <span class="c"># 管理员运行</span>
</pre></div>
<p>接下来是教程</p>
<div class="highlight"><pre><span></span><span class="c"># 正如你看到的，每一行开头是 # 都是注释</span>

<span class="c"># 简单的 Hello World 实例</span>
<span class="nb">echo </span><span class="n">Hello</span> <span class="n">world</span><span class="p">!</span>
<span class="c"># echo 是 Write-Output (cmdlet) 的别名</span>
<span class="c"># 大部分 cmdlet 和函数都遵循 &quot;动词-名词&quot; 命名规则。</span>

<span class="c"># 每个命令都从新的一行开始或者是一个分号</span>
<span class="nb">echo </span><span class="s1">&#39;This is the first line&#39;</span><span class="p">;</span> <span class="nb">echo </span><span class="s1">&#39;This is the second line&#39;</span>

<span class="c"># 声明一个变量如下：</span>
<span class="nv">$aString</span><span class="p">=</span><span class="s2">&quot;Some string&quot;</span>
<span class="c"># 或者像这样：</span>
<span class="nv">$aNumber</span> <span class="p">=</span> <span class="n">5</span> <span class="o">-as</span> <span class="no">[double]</span>
<span class="nv">$aList</span> <span class="p">=</span> <span class="n">1</span><span class="p">,</span><span class="n">2</span><span class="p">,</span><span class="n">3</span><span class="p">,</span><span class="n">4</span><span class="p">,</span><span class="n">5</span>
<span class="nv">$anEmptyList</span> <span class="p">=</span> <span class="p">@()</span>
<span class="nv">$aString</span> <span class="p">=</span> <span class="nv">$aList</span> <span class="n">-join</span> <span class="s1">&#39;--&#39;</span> <span class="c"># 也包含 join 方法</span>
<span class="nv">$aHashtable</span> <span class="p">=</span> <span class="p">@{</span><span class="n">name1</span><span class="p">=</span><span class="s1">&#39;val1&#39;</span><span class="p">;</span> <span class="n">name2</span><span class="p">=</span><span class="s1">&#39;val2&#39;</span><span class="p">}</span>

<span class="c"># 使用变量：</span>
<span class="nb">echo </span><span class="nv">$aString</span>
<span class="nb">echo </span><span class="s2">&quot;Interpolation: $aString&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;$aString has length of </span><span class="p">$(</span><span class="nv">$aString</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="nb">echo </span><span class="s1">&#39;$aString&#39;</span>
<span class="nb">echo </span><span class="sh">@&quot;</span>
<span class="sh">This is a Here-String</span>
<span class="sh">$aString</span>
<span class="sh">&quot;@</span>
<span class="c"># 注意 &#39; (单引号) 不是变量的一部分</span>
<span class="c"># 在这里字符串也可以是单引号</span>

<span class="c"># 内置变量:</span>
<span class="c"># 下面是一些有用的内置变量，比如：</span>
<span class="nb">echo </span><span class="s2">&quot;Booleans: $TRUE and $FALSE&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;Empty value: $NULL&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;Last program&#39;s return value: $?&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;Exit code of last run Windows-based program: $LastExitCode&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;The last token in the last line received by the session: $$&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;The first token: $^&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;Script&#39;s PID: $PID&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;Full path of current script directory: $PSScriptRoot&quot;</span>
<span class="nb">echo </span><span class="s1">&#39;Full path of current script: &#39;</span> <span class="p">+</span> <span class="nv">$MyInvocation</span><span class="p">.</span><span class="n">MyCommand</span><span class="p">.</span><span class="n">Path</span>
<span class="nb">echo </span><span class="s2">&quot;FUll path of current directory: $Pwd&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;Bound arguments in a function, script or code block: $PSBoundParameters&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;Unbound arguments: </span><span class="p">$(</span><span class="nv">$Args</span> <span class="n">-join</span> <span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="s2">.&quot;</span>
<span class="c"># 更多的内置类型: `help about_Automatic_Variables`</span>

<span class="c"># 内联其他文件 (点操作符)</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">otherScriptName</span><span class="p">.</span><span class="n">ps1</span>


<span class="c">### 控制流</span>
<span class="c"># 下面是条件判断结构</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$Age</span> <span class="o">-is</span> <span class="no">[string]</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">echo </span><span class="s1">&#39;But.. $Age cannot be a string!&#39;</span>
<span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$Age</span> <span class="o">-lt</span> <span class="n">12</span> <span class="o">-and</span> <span class="nv">$Age</span> <span class="o">-gt</span> <span class="n">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">echo </span><span class="s1">&#39;Child (Less than 12. Greater than 0)&#39;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">echo </span><span class="s1">&#39;Adult&#39;</span>
<span class="p">}</span>

<span class="c"># Switch 语句比其他语言更强大</span>
<span class="nv">$val</span> <span class="p">=</span> <span class="s2">&quot;20&quot;</span>
<span class="k">switch</span><span class="p">(</span><span class="nv">$val</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-eq</span> <span class="n">42</span> <span class="p">}</span>           <span class="p">{</span> <span class="s2">&quot;The answer equals 42&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="s1">&#39;20&#39;</span>                    <span class="p">{</span> <span class="s2">&quot;Exactly 20&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-like</span> <span class="s1">&#39;s*&#39;</span> <span class="p">}</span>       <span class="p">{</span> <span class="s2">&quot;Case insensitive&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-clike</span> <span class="s1">&#39;s*&#39;</span><span class="p">}</span>       <span class="p">{</span> <span class="s2">&quot;clike, ceq, cne for case sensitive&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-notmatch</span> <span class="s1">&#39;^.*$&#39;</span><span class="p">}</span>  <span class="p">{</span> <span class="s2">&quot;Regex matching. cnotmatch, cnotlike, ...&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="s1">&#39;x&#39;</span> <span class="o">-contains</span> <span class="s1">&#39;x&#39;</span><span class="p">}</span>    <span class="p">{</span> <span class="s2">&quot;FALSE! -contains is for lists!&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="k">default</span>                 <span class="p">{</span> <span class="s2">&quot;Others&quot;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="c"># 经典的 For 循环</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-le</span> <span class="n">10</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
  <span class="s2">&quot;Loop number $i&quot;</span>
<span class="p">}</span>
<span class="c"># 或者可以更简洁</span>
<span class="n">1</span><span class="p">..</span><span class="n">10</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="s2">&quot;Loop number $_&quot;</span> <span class="p">}</span>

<span class="c"># PowerShell 还提供其他循环方式</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$var</span> <span class="k">in</span> <span class="s1">&#39;val1&#39;</span><span class="p">,</span><span class="s1">&#39;val2&#39;</span><span class="p">,</span><span class="s1">&#39;val3&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="nb">echo </span><span class="nv">$var</span> <span class="p">}</span>
<span class="c"># while () {}</span>
<span class="c"># do {} while ()</span>
<span class="c"># do {} until ()</span>

<span class="c"># 异常处理</span>
<span class="k">try</span> <span class="p">{}</span> <span class="k">catch</span> <span class="p">{}</span> <span class="k">finally</span> <span class="p">{}</span>
<span class="k">try</span> <span class="p">{}</span> <span class="k">catch</span> <span class="no">[System.NullReferenceException]</span> <span class="p">{</span>
    <span class="nb">echo </span><span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span> <span class="p">|</span> <span class="nb">Format-List</span> <span class="n">-Force</span>
<span class="p">}</span>


<span class="c">### Providers</span>
<span class="c"># 列出当前目录下的文件和子目录</span>
<span class="nb">ls </span><span class="c"># 或者 `dir`</span>
<span class="nb">cd </span><span class="p">~</span> <span class="c"># 回到主目录</span>

<span class="nb">Get-Alias</span> <span class="nb">ls </span><span class="c"># -&gt; Get-ChildItem</span>
<span class="c"># 这些 cmdlet 有更加通用的名称，因为它不仅仅只操作当前目录，这一点和其他脚本语言不同。</span>
<span class="nb">cd </span><span class="n">HKCU</span><span class="p">:</span> <span class="c"># 跳转 HKEY_CURRENT_USER 注册表中的值</span>

<span class="c"># 获取当前会话中的提供者</span>
<span class="nb">Get-PSProvider</span>


<span class="c">### 管道</span>
<span class="c"># Cmdlets 中的参数用来控制它们的行为：</span>
<span class="nb">Get-ChildItem</span> <span class="n">-Filter</span> <span class="p">*.</span><span class="n">txt</span> <span class="n">-Name</span> <span class="c"># 获取所有 txt 文件名。</span>
<span class="c"># 需要输入足够多的参数来确保没有歧义。</span>
<span class="nb">ls </span><span class="n">-fi</span> <span class="p">*.</span><span class="n">txt</span> <span class="n">-n</span> <span class="c"># -f 是不可以的因为 -Force 同样存在。</span>
<span class="c"># 使用 `Get-Help Get-ChildItem -Full` 来查看全部参数。</span>

<span class="c"># 之前 cmdlet 获取的结果输出可以作为一下个输入。</span>
<span class="c"># `$_` 指代当前管道处理的对象。</span>
<span class="nb">ls </span><span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-match</span> <span class="s1">&#39;c&#39;</span> <span class="p">}</span> <span class="p">|</span> <span class="nb">Export-CSV</span> <span class="n">export</span><span class="p">.</span><span class="n">txt</span>
<span class="nb">ls </span><span class="p">|</span> <span class="p">?</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-match</span> <span class="s1">&#39;c&#39;</span> <span class="p">}</span> <span class="p">|</span> <span class="nb">ConvertTo-HTML</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="n">export</span><span class="p">.</span><span class="n">html</span>

<span class="c"># 如果对管道的对象感到疑惑，使用 `Get-Member` 来查看该对象的可使用的方法和属性。</span>
<span class="nb">ls </span><span class="p">|</span> <span class="nb">Get-Member</span>
<span class="nb">Get-Date</span> <span class="p">|</span> <span class="nb">gm</span>

<span class="c"># ` 是行连续标识符，或者在每一行结尾添加一个 |</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">ID</span> <span class="n">-Descending</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-First</span> <span class="n">10</span> <span class="n">Name</span><span class="p">,</span><span class="n">ID</span><span class="p">,</span><span class="n">VM</span> <span class="p">`</span>
    <span class="p">|</span> <span class="nb">Stop-Process</span> <span class="n">-WhatIf</span>

<span class="nb">Get-EventLog</span> <span class="n">Application</span> <span class="n">-After</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">AddHours</span><span class="p">(-</span><span class="n">2</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Format-List</span>

<span class="c"># 使用 % 作为 ForEach-Object 的简称。</span>
<span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">`</span>
    <span class="n">-Begin</span> <span class="p">{</span> <span class="s2">&quot;Starting&quot;</span><span class="p">;</span> <span class="nv">$counter</span> <span class="p">=</span> <span class="n">0</span> <span class="p">}</span> <span class="p">`</span>
    <span class="n">-Process</span> <span class="p">{</span> <span class="s2">&quot;Processing $_&quot;</span><span class="p">;</span> <span class="nv">$counter</span><span class="p">++</span> <span class="p">}</span> <span class="p">`</span>
    <span class="n">-End</span> <span class="p">{</span> <span class="s2">&quot;Finishing: $counter&quot;</span> <span class="p">}</span>

<span class="c"># Get-Process 返回包含三列的表</span>
<span class="c"># 第三列是使用 2 位精度数值表示 VM 属性</span>
<span class="c"># 计算出来的列也可以表示更多的信息:</span>
<span class="c"># `@{name=&#39;lbl&#39;;expression={$_}`</span>
<span class="nb">ps </span><span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">ID</span><span class="p">,</span><span class="n">Name</span><span class="p">,@{</span><span class="n">n</span><span class="p">=</span><span class="s1">&#39;VM(MB)&#39;</span><span class="p">;</span><span class="n">e</span><span class="p">={</span><span class="s1">&#39;{0:n2}&#39;</span> <span class="o">-f</span> <span class="p">(</span><span class="nv">$_</span><span class="p">.</span><span class="n">VM</span> <span class="p">/</span> <span class="n">1MB</span><span class="p">)}}</span> <span class="n">-autoSize</span>


<span class="c">### 函数</span>
<span class="c"># [string] 注记是可选的。</span>
<span class="k">function</span> <span class="n">foo</span><span class="p">(</span><span class="no">[string]</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">echo </span><span class="s2">&quot;Hey $name, have a function&quot;</span>
<span class="p">}</span>

<span class="c"># 调用你的函数</span>
<span class="n">foo</span> <span class="s2">&quot;Say my name&quot;</span>

<span class="c"># 函数可以包含命名参数、参数的注记和可解析的文档</span>
<span class="cm">&lt;#</span>
<span class="sd">.SYNOPSIS</span>
<span class="cm">Setup a new website</span>
<span class="sd">.DESCRIPTION</span>
<span class="cm">Creates everything your new website needs for much win</span>
<span class="sd">.PARAMETER</span><span class="cm"> siteName</span>
<span class="cm">The name for the new website</span>
<span class="sd">.EXAMPLE</span>
<span class="cm">New-Website -Name FancySite -Po 5000</span>
<span class="cm">New-Website SiteWithDefaultPort</span>
<span class="cm">New-Website siteName 2000 # ERROR! Port argument could not be validated</span>
<span class="cm">(&#39;name1&#39;,&#39;name2&#39;) | New-Website -Verbose</span>
<span class="cm">#&gt;</span>
<span class="k">function</span> <span class="nb">New-Website</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">[</span><span class="k">CmdletBinding</span><span class="p">()]</span>
    <span class="k">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="k">Parameter</span><span class="p">(</span><span class="k">ValueFromPipeline</span><span class="p">=</span><span class="nv">$true</span><span class="p">,</span> <span class="k">Mandatory</span><span class="p">=</span><span class="nv">$true</span><span class="p">)]</span>
        <span class="p">[</span><span class="k">Alias</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)]</span>
        <span class="no">[string]</span><span class="nv">$siteName</span><span class="p">,</span>
        <span class="p">[</span><span class="k">ValidateSet</span><span class="p">(</span><span class="n">3000</span><span class="p">,</span><span class="n">5000</span><span class="p">,</span><span class="n">8000</span><span class="p">)]</span>
        <span class="no">[int]</span><span class="nv">$port</span> <span class="p">=</span> <span class="n">3000</span>
    <span class="p">)</span>
    <span class="k">BEGIN</span> <span class="p">{</span> <span class="nb">Write-Verbose</span> <span class="s1">&#39;Creating new website(s)&#39;</span> <span class="p">}</span>
    <span class="k">PROCESS</span> <span class="p">{</span> <span class="nb">echo </span><span class="s2">&quot;name: $siteName, port: $port&quot;</span> <span class="p">}</span>
    <span class="k">END</span> <span class="p">{</span> <span class="nb">Write-Verbose</span> <span class="s1">&#39;Website(s) created&#39;</span> <span class="p">}</span>
<span class="p">}</span>


<span class="c">### 都是 .NET</span>
<span class="c"># PS 中的字符串事实上就是 .NET 的 System.String 类型</span>
<span class="c"># 所有 .NET 方法和属性都可用</span>
<span class="s1">&#39;string&#39;</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">().</span><span class="n">Replace</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;ggg&#39;</span><span class="p">)</span>
<span class="c"># 或者更加 PowerShell 一点</span>
<span class="s1">&#39;string&#39;</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">()</span> <span class="o">-replace</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;ggg&#39;</span>

<span class="c"># 不确定这样的话 .NET 方法如何调用</span>
<span class="s1">&#39;string&#39;</span> <span class="p">|</span> <span class="nb">gm</span>

<span class="c"># 调用静态 .NET 方法的语法：</span>
<span class="no">[System.Reflection.Assembly]</span><span class="p">::</span><span class="n">LoadWithPartialName</span><span class="p">(</span><span class="s1">&#39;Microsoft.VisualBasic&#39;</span><span class="p">)</span>

<span class="c"># 注意 .NET 方法调用必须使用括号，然而 PS 函数调用不能使用括号；</span>
<span class="c"># 如果你调用 cmdlet/PS 函数使用了括号，就相当于传递了参数列表。</span>
<span class="nv">$writer</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">StreamWriter</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span> <span class="nv">$true</span><span class="p">)</span>
<span class="nv">$writer</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="no">[Environment]</span><span class="p">::</span><span class="n">NewLine</span><span class="p">)</span>
<span class="nv">$writer</span><span class="p">.</span><span class="n">Dispose</span><span class="p">()</span>

<span class="c">### IO</span>
<span class="c"># 从输入读入一个值</span>
<span class="nv">$Name</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;What&#39;s your name?&quot;</span>
<span class="nb">echo </span><span class="s2">&quot;Hello, $Name!&quot;</span>
<span class="no">[int]</span><span class="nv">$Age</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;What&#39;s your age?&quot;</span>

<span class="c"># Test-Path, Split-Path, Join-Path, Resolve-Path</span>
<span class="c"># Get-Content filename # 返回字符串数组 string[]</span>
<span class="c"># Set-Content, Add-Content, Clear-Content</span>
<span class="nb">Get-Command</span> <span class="n">ConvertTo</span><span class="p">-*,</span><span class="n">ConvertFrom</span><span class="p">-*</span>


<span class="c">### 有用的东西</span>
<span class="c"># 更新 PATH</span>
<span class="nv">$env:PATH</span> <span class="p">=</span> <span class="no">[System.Environment]</span><span class="p">::</span><span class="n">GetEnvironmentVariable</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span> <span class="s2">&quot;Machine&quot;</span><span class="p">)</span> <span class="p">+</span>
    <span class="s2">&quot;;&quot;</span> <span class="p">+</span> <span class="no">[System.Environment]</span><span class="p">::</span><span class="n">GetEnvironmentVariable</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span> <span class="s2">&quot;User&quot;</span><span class="p">)</span>

<span class="c"># 找到 Python 的 PATH</span>
<span class="nv">$env:PATH</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">-like</span> <span class="s2">&quot;*python*&quot;</span><span class="p">}</span>

<span class="c"># 改变工作目录而不需要记住之前的路径</span>
<span class="nb">Push-Location</span> <span class="n">c</span><span class="p">:\</span><span class="n">temp</span> <span class="c"># 改变工作目录至 c:\temp</span>
<span class="nb">Pop-Location</span> <span class="c"># 改变到之前的工作目录</span>
<span class="c"># 别名: pushd 和 popd</span>

<span class="c"># 在下载之后解除目录阻塞</span>
<span class="nb">Get-ChildItem</span> <span class="n">-Recurse</span> <span class="p">|</span> <span class="nb">Unblock-File</span>

<span class="c"># Windows 资源管理器打开当前目录</span>
<span class="nb">ii </span><span class="p">.</span>

<span class="c"># 按任意键退出</span>
<span class="nv">$host</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">RawUI</span><span class="p">.</span><span class="n">ReadKey</span><span class="p">()</span>
<span class="k">return</span>

<span class="c"># 创建快捷方式</span>
<span class="nv">$WshShell</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">-comObject</span> <span class="n">WScript</span><span class="p">.</span><span class="n">Shell</span>
<span class="nv">$Shortcut</span> <span class="p">=</span> <span class="nv">$WshShell</span><span class="p">.</span><span class="n">CreateShortcut</span><span class="p">(</span><span class="nv">$link</span><span class="p">)</span>
<span class="nv">$Shortcut</span><span class="p">.</span><span class="n">TargetPath</span> <span class="p">=</span> <span class="nv">$file</span>
<span class="nv">$Shortcut</span><span class="p">.</span><span class="n">WorkingDirectory</span> <span class="p">=</span> <span class="nb">Split-Path</span> <span class="nv">$file</span>
<span class="nv">$Shortcut</span><span class="p">.</span><span class="n">Save</span><span class="p">()</span>
</pre></div>
<p>配置你的 PowerShell</p>
<div class="highlight"><pre><span></span><span class="c"># $Profile 是文件 `Microsoft.PowerShell_profile.ps1` 完整路径</span>
<span class="c"># 下面所有的代码都在 PS 会话开始的时候执行</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="nv">$Profile</span><span class="p">))</span> <span class="p">{</span>
    <span class="nb">New-Item</span> <span class="n">-Type</span> <span class="n">file</span> <span class="n">-Path</span> <span class="nv">$Profile</span> <span class="n">-Force</span>
    <span class="n">notepad</span> <span class="nv">$Profile</span>
<span class="p">}</span>
<span class="c"># 更多信息: `help about_profiles`</span>
<span class="c"># 更多关于 Shell 有用的信息，确保查看下面的 PSReadLine 项目。</span>
</pre></div>
<p>更多项目</p>

<ul>
<li><a href="https://channel9.msdn.com/Search?term=powershell%20pipeline#ch9Search&amp;lang-en=en">Channel9</a> PowerShell 教程</li>
<li><a href="https://github.com/psget/psget">PSGet</a> PowerShell NuGet 包</li>
<li><a href="https://github.com/lzybkr/PSReadLine/">PSReadLine</a> 仿 bash 按行读取（ Window10 默认包含）</li>
<li><a href="https://github.com/dahlbyk/posh-git/">Posh-Git</a> Git 命令提示 (推荐!)</li>
<li><a href="https://github.com/psake/psake">PSake</a> 自动构建工作</li>
<li><a href="https://github.com/pester/Pester">Pester</a> BDD 测试框架</li>
<li><a href="https://github.com/tkellogg/Jump-Location">Jump-Location</a> Poweshell 中 <code>cd</code> 来跳转目录</li>
<li><a href="http://pscx.codeplex.com/">PowerShell Community Extensions</a> (废弃)</li>
</ul>

<p>尚未涉及</p>

<ul>
<li>WMI: Windows 管理规范 (Get-CimInstance)</li>
<li>多任务: Start-Job -scriptBlock {&hellip;},</li>
<li>代码签名</li>
<li>远程 (Enter-PSSession/Exit-PSSession; Invoke-Command)</li>
</ul>

    <hr>
    <p>有建议？或者发现什么错误？在GitHub上<a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">开一个issue</a>，或者发起<a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/zh-cn/powershell-cn.html.markdown">pull request</a>！
    </p>
    <p class="contributed">
    原著Wouter Van Schandevijl，并由<a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/zh-cn/powershell-cn.html.markdown">2个好心人</a>修改。
    </p>

    <footer>
    <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>
    <p>
    &copy; 2024
        <a href="https://github.com/laoujin">Wouter Van Schandevijl</a>
    </p>

    <p>
      Translated by:
        <a href="https://github.com/gaufung">Feng Gao</a>

    </footer>
  </div>

        </div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script src="/js/script.js"></script>
    </body>
</html>
