<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="zh-cn" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html lang="zh-cn" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html lang="zh-cn" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="zh-cn" class="no-js"> <!--<![endif]-->
    <head>
      <!-- Google tag (gtag.js) -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-WXC8R75DEN');
      </script>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta http-equiv="Content-Language" content="zh-cn">
        <!-- Use title if it's in the page YAML frontmatter -->
        <title>Learn racket in Y Minutes</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="/css/index.css">

        <link rel="canonical" href="https://learnxinyminutes.com/docs/zh-cn/racket-cn/">
        <script>
            var THEME_KEY = "lxiym_theme";
            function set_theme(theme) {
                var el = document.getElementsByTagName("html")[0];
                if (!el) {
                  return;
                }

                if (theme === "dark" ) {
                    el.className = "dark";
                } else {
                    el.className = "light";
                }

                localStorage.setItem(THEME_KEY, theme);
            }

            function load_theme() {
              var theme = localStorage.getItem(THEME_KEY);
              if (theme) {
                set_theme(theme);
              }
            }

            // Attempt immediate application of html style
            load_theme();

            // Backup: do it onload. Will flash, but better than nothing.
            window.addEventListener("load", function(){
              load_theme();
            });
        </script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="container">
            <div class="share">
    <span class="sharemsg">
      <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fdocs%2Fzh-cn%2Fracket-cn%2F&text=Y%E5%88%86%E9%92%9F%E9%80%9F%E6%88%90X%2C+%E5%85%B6%E4%B8%AD+X%3Dracket">
        分享此页
      </a></span>

      <span class='st_facebook_large' displayText='Facebook'></span>
      <span class='st_twitter_large' displayText='Tweet'></span>
  </div>
  <div class="theme-choice">
    <label id="theme-label">选择主题：</label>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('light');">亮</button>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('dark');">暗</button>
  </div>
  <h1><a href="/">Y分钟速成X</a></h1>
  <h2>其中 X=racket</h2>
    <p class="filelink">
    源代码下载：
    <a href="/docs/files/learnracket-zh.rkt">learnracket-zh.rkt</a>
    </p>
  <div id="doc">
    <p>Racket是Lisp/Scheme家族中的一个通用的，多范式的编程语言。
非常期待您的反馈！你可以通过<a href="http://twitter.com/th3rac25">@th3rac25</a>或以用户名为 th3rac25 的Google邮箱服务和我取得联系</p>
<div class="highlight"><pre><span></span><span class="kn">#lang </span><span class="nn">racket</span><span class="w"> </span><span class="c1">; 声明我们使用的语言</span>

<span class="c1">;;; 注释</span>

<span class="c1">;; 单行注释以分号开始</span>

<span class="cm">#| 块注释</span>
<span class="cm">   可以横跨很多行而且...</span>
<span class="cm">    #|</span>
<span class="cm">       可以嵌套</span>
<span class="cm">    |#</span>
<span class="cm">|#</span>

<span class="c1">;; S表达式注释忽略剩下的表达式</span>
<span class="c1">;; 在调试的时候会非常有用</span>
<span class="c">#;</span><span class="w"> </span><span class="p">(</span><span class="n">被忽略的表达式</span><span class="p">)</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 1. 原始数据类型和操作符</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span class="c1">;;; 数字</span>
<span class="mi">9999999999999999999999</span><span class="w"> </span><span class="c1">; 整数</span>
<span class="mb">#b111</span><span class="w">                  </span><span class="c1">; 二进制数字 =&gt; 7</span>
<span class="mo">#o111</span><span class="w">                  </span><span class="c1">; 八进制数字 =&gt; 73</span>
<span class="mh">#x111</span><span class="w">                  </span><span class="c1">; 十六进制数字 =&gt; 273</span>
<span class="mf">3.14</span><span class="w">                   </span><span class="c1">; 实数</span>
<span class="mf">6.02e+23</span>
<span class="m">1/2</span><span class="w">                    </span><span class="c1">; 有理数</span>
<span class="m">1+2i</span><span class="w">                   </span><span class="c1">; 复数</span>

<span class="c1">;; 函数调用写作(f x y z ...)</span>
<span class="c1">;; 在这里 f 是一个函数， x, y, z, ... 是参数</span>
<span class="c1">;; 如果你想创建一个列表数据的字面量, 使用 &#39; 来阻止它们</span>
<span class="c1">;; 被求值</span>
<span class="o">&#39;</span><span class="p">(</span><span class="ss">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; (+ 1 2)</span>
<span class="c1">;; 接下来，是一些数学运算</span>
<span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">  </span><span class="c1">; =&gt; 2</span>
<span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">  </span><span class="c1">; =&gt; 7</span>
<span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 20</span>
<span class="p">(</span><span class="nb">expt</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 8</span>
<span class="p">(</span><span class="nb">quotient</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 2</span>
<span class="p">(</span><span class="nb">remainder</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 1</span>
<span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="mi">35</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 7</span>
<span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 1/3</span>
<span class="p">(</span><span class="nb">exact-&gt;inexact</span><span class="w"> </span><span class="m">1/3</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 0.3333333333333333</span>
<span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="m">1+2i</span><span class="w">  </span><span class="m">2-3i</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 3-1i</span>

<span class="c1">;;; 布尔类型</span>
<span class="no">#t</span><span class="w"> </span><span class="c1">; 为真</span>
<span class="no">#f</span><span class="w"> </span><span class="c1">; 为假，#f 之外的任何值都是真</span>
<span class="p">(</span><span class="nb">not</span><span class="w"> </span><span class="no">#t</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #f</span>
<span class="p">(</span><span class="k">and</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="no">#f</span><span class="w"> </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;doesn&#39;t get here&quot;</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; #f</span>
<span class="p">(</span><span class="k">or</span><span class="w"> </span><span class="no">#f</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;doesn&#39;t get here&quot;</span><span class="p">))</span><span class="w">  </span><span class="c1">; =&gt; 0</span>

<span class="c1">;;; 字符</span>
<span class="sc">#\A</span><span class="w"> </span><span class="c1">; =&gt; #\A</span>
<span class="sc">#\λ</span><span class="w"> </span><span class="c1">; =&gt; #\λ</span>
<span class="sc">#\u03BB</span><span class="w"> </span><span class="c1">; =&gt; #\λ</span>

<span class="c1">;;; 字符串是字符组成的定长数组</span>
<span class="s2">&quot;Hello, world!&quot;</span>
<span class="s2">&quot;Benjamin </span><span class="se">\&quot;</span><span class="s2">Bugsy</span><span class="se">\&quot;</span><span class="s2"> Siegel&quot;</span><span class="w">   </span><span class="c1">; \是转义字符</span>
<span class="s2">&quot;Foo</span><span class="se">\t</span><span class="s2">bar</span><span class="se">\41\x21\u0021\a\r\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="c1">; 包含C语言的转义字符，和Unicode</span>
<span class="s2">&quot;λx:(μα.α→α).xx&quot;</span><span class="w">              </span><span class="c1">; 字符串可以包含Unicode字符</span>

<span class="c1">;; 字符串可以相加</span>
<span class="p">(</span><span class="nb">string-append</span><span class="w"> </span><span class="s2">&quot;Hello &quot;</span><span class="w"> </span><span class="s2">&quot;world!&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;Hello world!&quot;</span>

<span class="c1">;; 一个字符串可以看做是一个包含字符的列表</span>
<span class="p">(</span><span class="nb">string-ref</span><span class="w"> </span><span class="s2">&quot;Apple&quot;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #\A</span>

<span class="c1">;; format 可以用来格式化字符串</span>
<span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;~a can be ~a&quot;</span><span class="w"> </span><span class="s2">&quot;strings&quot;</span><span class="w"> </span><span class="s2">&quot;formatted&quot;</span><span class="p">)</span>

<span class="c1">;; 打印字符串非常简单</span>
<span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;I&#39;m Racket. Nice to meet you!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 2. 变量</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 你可以使用 define 定义一个变量</span>
<span class="c1">;; 变量的名字可以使用任何字符除了: ()[]{}&quot;,&#39;`;#|\</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">some-var</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="n">some-var</span><span class="w"> </span><span class="c1">; =&gt; 5</span>

<span class="c1">;; 你也可以使用Unicode字符</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">⊆</span><span class="w"> </span><span class="nb">subset?</span><span class="p">)</span>
<span class="p">(</span><span class="n">⊆</span><span class="w"> </span><span class="p">(</span><span class="nb">set</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">set</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; #t</span>

<span class="c1">;; 访问未赋值的变量会引发一个异常</span>
<span class="c1">; x ; =&gt; x: undefined ...</span>

<span class="c1">;; 本地绑定: `me&#39; 被绑定到 &quot;Bob&quot;，并且只在 let 中生效</span>
<span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="n">me</span><span class="w"> </span><span class="s2">&quot;Bob&quot;</span><span class="p">])</span>
<span class="w">  </span><span class="s2">&quot;Alice&quot;</span>
<span class="w">  </span><span class="n">me</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;Bob&quot;</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 3. 结构和集合</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span class="c1">;; 结构体</span>
<span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="n">dog</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="n">breed</span><span class="w"> </span><span class="n">age</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">my-pet</span>
<span class="w">  </span><span class="p">(</span><span class="n">dog</span><span class="w"> </span><span class="s2">&quot;lassie&quot;</span><span class="w"> </span><span class="s2">&quot;collie&quot;</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span>
<span class="n">my-pet</span><span class="w"> </span><span class="c1">; =&gt; #&lt;dog&gt;</span>
<span class="p">(</span><span class="n">dog?</span><span class="w"> </span><span class="n">my-pet</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #t</span>
<span class="p">(</span><span class="n">dog-name</span><span class="w"> </span><span class="n">my-pet</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;lassie&quot;</span>

<span class="c1">;;; 对 (不可变的)</span>
<span class="c1">;; `cons&#39; 返回对, `car&#39; 和 `cdr&#39; 从对中提取第1个</span>
<span class="c1">;; 和第2个元素</span>
<span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &#39;(1 . 2)</span>
<span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; 1</span>
<span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; 2</span>

<span class="c1">;;; 列表</span>

<span class="c1">;; 列表由链表构成, 由 `cons&#39; 的结果</span>
<span class="c1">;; 和一个 `null&#39; (或者 &#39;()) 构成，后者标记了这个列表的结束</span>
<span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="nb">null</span><span class="p">)))</span><span class="w"> </span><span class="c1">; =&gt; &#39;(1 2 3)</span>
<span class="c1">;; `list&#39; 给列表提供了一个非常方便的可变参数的生成器</span>
<span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &#39;(1 2 3)</span>
<span class="c1">;; 一个单引号也可以用来表示一个列表字面量</span>
<span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &#39;(1 2 3)</span>

<span class="c1">;; 仍然可以使用 `cons&#39; 在列表的开始处添加一项</span>
<span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; &#39;(4 1 2 3)</span>

<span class="c1">;; `append&#39; 函数可以将两个列表合并</span>
<span class="p">(</span><span class="nb">append</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; &#39;(1 2 3 4)</span>

<span class="c1">;; 列表是非常基础的类型，所以有*很多*操作列表的方法</span>
<span class="c1">;; 下面是一些例子:</span>
<span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nb">add1</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w">          </span><span class="c1">; =&gt; &#39;(2 3 4)</span>
<span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nb">+</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">30</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; &#39;(11 22 33)</span>
<span class="p">(</span><span class="nb">filter</span><span class="w"> </span><span class="nb">even?</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w">    </span><span class="c1">; =&gt; &#39;(2 4)</span>
<span class="p">(</span><span class="nb">count</span><span class="w"> </span><span class="nb">even?</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w">     </span><span class="c1">; =&gt; 2</span>
<span class="p">(</span><span class="nb">take</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">          </span><span class="c1">; =&gt; &#39;(1 2)</span>
<span class="p">(</span><span class="nb">drop</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">          </span><span class="c1">; =&gt; &#39;(3 4)</span>

<span class="c1">;;; 向量</span>

<span class="c1">;; 向量是定长的数组</span>
<span class="o">#</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &#39;#(1 2 3)</span>

<span class="c1">;; 使用 `vector-append&#39; 方法将2个向量合并</span>
<span class="p">(</span><span class="nb">vector-append</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">6</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; #(1 2 3 4 5 6)</span>

<span class="c1">;;; Set(翻译成集合也不太合适，所以不翻译了..)</span>

<span class="c1">;; 从一个列表创建一个Set</span>
<span class="p">(</span><span class="nb">list-&gt;set</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; (set 1 2 3)</span>

<span class="c1">;; 使用 `set-add&#39; 增加一个成员</span>
<span class="c1">;; (函数式特性: 这里会返回一个扩展后的Set，而不是修改输入的值)</span>
<span class="p">(</span><span class="nb">set-add</span><span class="w"> </span><span class="p">(</span><span class="nb">set</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; (set 1 2 3 4)</span>

<span class="c1">;; 使用 `set-remove&#39; 移除一个成员</span>
<span class="p">(</span><span class="nb">set-remove</span><span class="w"> </span><span class="p">(</span><span class="nb">set</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; (set 2 3)</span>

<span class="c1">;; 使用 `set-member?&#39; 测试成员是否存在</span>
<span class="p">(</span><span class="nb">set-member?</span><span class="w"> </span><span class="p">(</span><span class="nb">set</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #t</span>
<span class="p">(</span><span class="nb">set-member?</span><span class="w"> </span><span class="p">(</span><span class="nb">set</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #f</span>

<span class="c1">;;; 散列表</span>

<span class="c1">;; 创建一个不变的散列表 (可变散列表的例子在下面)</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">(</span><span class="nb">hash</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">b</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">c</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span>

<span class="c1">;; 根据键取得值</span>
<span class="p">(</span><span class="nb">hash-ref</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 1</span>

<span class="c1">;; 获取一个不存在的键是一个异常</span>
<span class="c1">; (hash-ref m &#39;d) =&gt; 没有找到元素</span>

<span class="c1">;; 你可以给不存在的键提供一个默认值</span>
<span class="p">(</span><span class="nb">hash-ref</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">d</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 0</span>

<span class="c1">;; 使用 `hash-set&#39; 来扩展一个不可变的散列表</span>
<span class="c1">;; (返回的是扩展后的散列表而不是修改它)</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">m2</span><span class="w"> </span><span class="p">(</span><span class="nb">hash-set</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">d</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>
<span class="n">m2</span><span class="w"> </span><span class="c1">; =&gt; &#39;#hash((b . 2) (a . 1) (d . 4) (c . 3))</span>

<span class="c1">;; 记住，使用 `hash` 创建的散列表是不可变的</span>
<span class="n">m</span><span class="w"> </span><span class="c1">; =&gt; &#39;#hash((b . 2) (a . 1) (c . 3))  &lt;-- no `d&#39;</span>

<span class="c1">;; 使用 `hash-remove&#39; 移除一个键值对 (函数式特性，m并不变)</span>
<span class="p">(</span><span class="nb">hash-remove</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &#39;#hash((b . 2) (c . 3))</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 3. 函数</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span class="c1">;; 使用 `lambda&#39; 创建函数</span>
<span class="c1">;; 函数总是返回它最后一个表达式的值</span>
<span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #&lt;procedure&gt;</span>
<span class="c1">;; 也可以使用 Unicode 字符 `λ&#39;</span>
<span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span><span class="w">     </span><span class="c1">; =&gt; 同样的函数</span>

<span class="c1">;; 使用括号调用一个函数，也可以直接调用一个 lambda 表达式</span>
<span class="p">((</span><span class="k">lambda</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="s2">&quot;Hello World&quot;</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; &quot;Hello World&quot;</span>
<span class="p">((</span><span class="k">λ</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="s2">&quot;Hello World&quot;</span><span class="p">))</span><span class="w">      </span><span class="c1">; =&gt; &quot;Hello World&quot;</span>

<span class="c1">;; 将函数赋值为一个变量</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">hello-world</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="s2">&quot;Hello World&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="n">hello-world</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;Hello World&quot;</span>

<span class="c1">;; 你可以使用函数定义的语法糖来简化代码</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">hello-world2</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span>

<span class="c1">;; `()`是函数的参数列表</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">hello</span>
<span class="w">  </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">string-append</span><span class="w"> </span><span class="s2">&quot;Hello &quot;</span><span class="w"> </span><span class="n">name</span><span class="p">)))</span>
<span class="p">(</span><span class="n">hello</span><span class="w"> </span><span class="s2">&quot;Steve&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;Hello Steve&quot;</span>
<span class="c1">;; 同样的，可以使用语法糖来定义:</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">hello2</span><span class="w"> </span><span class="n">name</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">string-append</span><span class="w"> </span><span class="s2">&quot;Hello &quot;</span><span class="w"> </span><span class="n">name</span><span class="p">))</span>

<span class="c1">;; 你也可以使用可变参数， `case-lambda&#39;</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">hello3</span>
<span class="w">  </span><span class="p">(</span><span class="k">case-lambda</span>
<span class="w">    </span><span class="p">[()</span><span class="w"> </span><span class="s2">&quot;Hello World&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">[(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">string-append</span><span class="w"> </span><span class="s2">&quot;Hello &quot;</span><span class="w"> </span><span class="n">name</span><span class="p">)]))</span>
<span class="p">(</span><span class="n">hello3</span><span class="w"> </span><span class="s2">&quot;Jake&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;Hello Jake&quot;</span>
<span class="p">(</span><span class="n">hello3</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;Hello World&quot;</span>
<span class="c1">;; ... 或者给参数指定一个可选的默认值</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">hello4</span><span class="w"> </span><span class="p">[</span><span class="n">name</span><span class="w"> </span><span class="s2">&quot;World&quot;</span><span class="p">])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">string-append</span><span class="w"> </span><span class="s2">&quot;Hello &quot;</span><span class="w"> </span><span class="n">name</span><span class="p">))</span>

<span class="c1">;; 函数可以将多余的参数放到一个列表里</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">count-args</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;You passed ~a args: ~a&quot;</span><span class="w"> </span><span class="p">(</span><span class="nb">length</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="n">args</span><span class="p">))</span>
<span class="p">(</span><span class="n">count-args</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;You passed 3 args: (1 2 3)&quot;</span>
<span class="c1">;; ... 也可以使用不带语法糖的 `lambda&#39; 形式:</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">count-args2</span>
<span class="w">  </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="n">args</span>
<span class="w">    </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;You passed ~a args: ~a&quot;</span><span class="w"> </span><span class="p">(</span><span class="nb">length</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="n">args</span><span class="p">)))</span>

<span class="c1">;; 你可以混用两种用法</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">hello-count</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;Hello ~a, you passed ~a extra args&quot;</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">(</span><span class="nb">length</span><span class="w"> </span><span class="n">args</span><span class="p">)))</span>
<span class="p">(</span><span class="n">hello-count</span><span class="w"> </span><span class="s2">&quot;Finn&quot;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="c1">; =&gt; &quot;Hello Finn, you passed 3 extra args&quot;</span>
<span class="c1">;; ... 不带语法糖的形式:</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">hello-count2</span>
<span class="w">  </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;Hello ~a, you passed ~a extra args&quot;</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">(</span><span class="nb">length</span><span class="w"> </span><span class="n">args</span><span class="p">))))</span>

<span class="c1">;; 使用关键字</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">hello-k</span><span class="w"> </span><span class="kd">#:name</span><span class="w"> </span><span class="p">[</span><span class="n">name</span><span class="w"> </span><span class="s2">&quot;World&quot;</span><span class="p">]</span><span class="w"> </span><span class="kd">#:greeting</span><span class="w"> </span><span class="p">[</span><span class="n">g</span><span class="w"> </span><span class="s2">&quot;Hello&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;~a ~a, ~a extra args&quot;</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">(</span><span class="nb">length</span><span class="w"> </span><span class="n">args</span><span class="p">)))</span>
<span class="p">(</span><span class="n">hello-k</span><span class="p">)</span><span class="w">                 </span><span class="c1">; =&gt; &quot;Hello World, 0 extra args&quot;</span>
<span class="p">(</span><span class="n">hello-k</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">           </span><span class="c1">; =&gt; &quot;Hello World, 3 extra args&quot;</span>
<span class="p">(</span><span class="n">hello-k</span><span class="w"> </span><span class="kd">#:greeting</span><span class="w"> </span><span class="s2">&quot;Hi&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;Hi World, 0 extra args&quot;</span>
<span class="p">(</span><span class="n">hello-k</span><span class="w"> </span><span class="kd">#:name</span><span class="w"> </span><span class="s2">&quot;Finn&quot;</span><span class="w"> </span><span class="kd">#:greeting</span><span class="w"> </span><span class="s2">&quot;Hey&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;Hey Finn, 0 extra args&quot;</span>
<span class="p">(</span><span class="n">hello-k</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="kd">#:greeting</span><span class="w"> </span><span class="s2">&quot;Hi&quot;</span><span class="w"> </span><span class="kd">#:name</span><span class="w"> </span><span class="s2">&quot;Finn&quot;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span>
<span class="w">                                         </span><span class="c1">; =&gt; &quot;Hi Finn, 6 extra args&quot;</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 4. 判断是否相等</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span class="c1">;; 判断数字使用 `=&#39;</span>
<span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #t</span>
<span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #f</span>

<span class="c1">;; 判断对象使用 `eq?&#39;</span>
<span class="p">(</span><span class="nb">eq?</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #t</span>
<span class="p">(</span><span class="nb">eq?</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #f</span>
<span class="p">(</span><span class="nb">eq?</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; #f</span>

<span class="c1">;; 判断集合使用 `equal?&#39;</span>
<span class="p">(</span><span class="nb">equal?</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">b</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">b</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; #t</span>
<span class="p">(</span><span class="nb">equal?</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">b</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">b</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; #f</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 5. 控制结构</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span class="c1">;;; 条件判断</span>

<span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="no">#t</span><span class="w">               </span><span class="c1">; 测试表达式</span>
<span class="w">    </span><span class="s2">&quot;this is true&quot;</span><span class="w">   </span><span class="c1">; 为真的表达式</span>
<span class="w">    </span><span class="s2">&quot;this is false&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">; 为假的表达式</span>
<span class="c1">; =&gt; &quot;this is true&quot;</span>

<span class="c1">;; 注意, 除 `#f` 之外的所有值都认为是真</span>
<span class="p">(</span><span class="nb">member</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">Groucho</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">Harpo</span><span class="w"> </span><span class="ss">Groucho</span><span class="w"> </span><span class="ss">Zeppo</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; &#39;(Groucho Zeppo)</span>
<span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">member</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">Groucho</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">Harpo</span><span class="w"> </span><span class="ss">Groucho</span><span class="w"> </span><span class="ss">Zeppo</span><span class="p">))</span>
<span class="w">    </span><span class="o">&#39;</span><span class="ss">yep</span>
<span class="w">    </span><span class="o">&#39;</span><span class="ss">nope</span><span class="p">)</span>
<span class="c1">; =&gt; &#39;yep</span>

<span class="c1">;; `cond&#39; 会进行一系列的判断来选择一个结果</span>
<span class="p">(</span><span class="k">cond</span><span class="w"> </span><span class="p">[(</span><span class="nb">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;wrong!&quot;</span><span class="p">)]</span>
<span class="w">      </span><span class="p">[(</span><span class="nb">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;wrong again!&quot;</span><span class="p">)]</span>
<span class="w">      </span><span class="p">[</span><span class="k">else</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">ok</span><span class="p">])</span><span class="w"> </span><span class="c1">; =&gt; &#39;ok</span>

<span class="c1">;;; 模式匹配</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">fizzbuzz?</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="p">(</span><span class="nb">remainder</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">remainder</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span>
<span class="w">    </span><span class="p">[(</span><span class="nb">list</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">fizzbuzz</span><span class="p">]</span>
<span class="w">    </span><span class="p">[(</span><span class="nb">list</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">_</span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">fizz</span><span class="p">]</span>
<span class="w">    </span><span class="p">[(</span><span class="nb">list</span><span class="w"> </span><span class="k">_</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">buzz</span><span class="p">]</span>
<span class="w">    </span><span class="p">[</span><span class="k">_</span><span class="w">          </span><span class="no">#f</span><span class="p">]))</span>

<span class="p">(</span><span class="n">fizzbuzz?</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &#39;fizzbuzz</span>
<span class="p">(</span><span class="n">fizzbuzz?</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; #f</span>

<span class="c1">;;; 循环</span>

<span class="c1">;; 循环可以使用递归(尾递归)</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">loop</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="nb">&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;i=~a</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">loop</span><span class="w"> </span><span class="p">(</span><span class="nb">add1</span><span class="w"> </span><span class="n">i</span><span class="p">))))</span>
<span class="p">(</span><span class="n">loop</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; i=5, i=6, ...</span>

<span class="c1">;; 类似的，可以使用 `let` 定义</span>
<span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="nb">&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;i=~a</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">loop</span><span class="w"> </span><span class="p">(</span><span class="nb">add1</span><span class="w"> </span><span class="n">i</span><span class="p">))))</span><span class="w"> </span><span class="c1">; =&gt; i=0, i=1, ...</span>

<span class="c1">;; 看上面的例子怎么增加一个新的 `loop&#39; 形式, 但是 Racket 已经有了一个非常</span>
<span class="c1">;; 灵活的 `for&#39; 了:</span>
<span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="mi">10</span><span class="p">])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;i=~a</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; i=0, i=1, ...</span>
<span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="p">(</span><span class="nb">in-range</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">10</span><span class="p">)])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;i=~a</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; i=5, i=6, ...</span>

<span class="c1">;;; 其他形式的迭代</span>
<span class="c1">;; `for&#39; 允许在很多数据结构中迭代:</span>
<span class="c1">;; 列表, 向量, 字符串, Set, 散列表, 等...</span>

<span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="p">(</span><span class="nb">in-list</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">l</span><span class="w"> </span><span class="ss">i</span><span class="w"> </span><span class="ss">s</span><span class="w"> </span><span class="ss">t</span><span class="p">))])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">displayln</span><span class="w"> </span><span class="n">i</span><span class="p">))</span>

<span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="p">(</span><span class="nb">in-vector</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="ss">v</span><span class="w"> </span><span class="ss">e</span><span class="w"> </span><span class="ss">c</span><span class="w"> </span><span class="ss">t</span><span class="w"> </span><span class="ss">o</span><span class="w"> </span><span class="ss">r</span><span class="p">))])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">displayln</span><span class="w"> </span><span class="n">i</span><span class="p">))</span>

<span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="p">(</span><span class="nb">in-string</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">)])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">displayln</span><span class="w"> </span><span class="n">i</span><span class="p">))</span>

<span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="p">(</span><span class="nb">in-set</span><span class="w"> </span><span class="p">(</span><span class="nb">set</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">x</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">y</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">z</span><span class="p">))])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">displayln</span><span class="w"> </span><span class="n">i</span><span class="p">))</span>

<span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">([(</span><span class="n">k</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">in-hash</span><span class="w"> </span><span class="p">(</span><span class="nb">hash</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">b</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">c</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">))])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;key:~a value:~a</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="n">v</span><span class="p">))</span>

<span class="c1">;;; 更多复杂的迭代</span>

<span class="c1">;; 并行扫描多个序列 (遇到长度小的就停止)</span>
<span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">x</span><span class="w"> </span><span class="ss">y</span><span class="w"> </span><span class="ss">z</span><span class="p">)])</span><span class="w"> </span><span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;~a:~a</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">j</span><span class="p">))</span>
<span class="c1">; =&gt; 0:x 1:y 2:z</span>

<span class="c1">;; 嵌套循环</span>
<span class="p">(</span><span class="k">for*</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">x</span><span class="w"> </span><span class="ss">y</span><span class="w"> </span><span class="ss">z</span><span class="p">)])</span><span class="w"> </span><span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;~a:~a</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">j</span><span class="p">))</span>
<span class="c1">; =&gt; 0:x, 0:y, 0:z, 1:x, 1:y, 1:z</span>

<span class="c1">;; 带有条件判断的 `for`</span>
<span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="mi">1000</span><span class="p">]</span>
<span class="w">      </span><span class="kd">#:when</span><span class="w"> </span><span class="p">(</span><span class="nb">&gt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">      </span><span class="kd">#:unless</span><span class="w"> </span><span class="p">(</span><span class="nb">odd?</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">      </span><span class="kd">#:break</span><span class="w"> </span><span class="p">(</span><span class="nb">&gt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;i=~a</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="n">i</span><span class="p">))</span>
<span class="c1">; =&gt; i=6, i=8, i=10</span>

<span class="c1">;;; 更多的例子帮助你加深理解..</span>
<span class="c1">;; 和 `for&#39; 循环非常像 -- 收集结果</span>

<span class="p">(</span><span class="k">for/list</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">add1</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; &#39;(2 3 4)</span>

<span class="p">(</span><span class="k">for/list</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)]</span><span class="w"> </span><span class="kd">#:when</span><span class="w"> </span><span class="p">(</span><span class="nb">even?</span><span class="w"> </span><span class="n">i</span><span class="p">))</span>
<span class="w">  </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &#39;(2)</span>

<span class="p">(</span><span class="k">for/list</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">x</span><span class="w"> </span><span class="ss">y</span><span class="w"> </span><span class="ss">z</span><span class="p">)])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; &#39;((0 x) (1 y) (2 z))</span>

<span class="p">(</span><span class="k">for/list</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="mi">1000</span><span class="p">]</span><span class="w"> </span><span class="kd">#:when</span><span class="w"> </span><span class="p">(</span><span class="nb">&gt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="kd">#:unless</span><span class="w"> </span><span class="p">(</span><span class="nb">odd?</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="kd">#:break</span><span class="w"> </span><span class="p">(</span><span class="nb">&gt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span>
<span class="w">  </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &#39;(6 8 10)</span>

<span class="p">(</span><span class="k">for/hash</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">values</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">(</span><span class="nb">number-&gt;string</span><span class="w"> </span><span class="n">i</span><span class="p">)))</span>
<span class="c1">; =&gt; &#39;#hash((1 . &quot;1&quot;) (2 . &quot;2&quot;) (3 . &quot;3&quot;))</span>

<span class="c1">;; 也有很多其他的内置方法来收集循环中的值:</span>
<span class="p">(</span><span class="k">for/sum</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="mi">10</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; 285</span>
<span class="p">(</span><span class="k">for/product</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="p">(</span><span class="nb">in-range</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">11</span><span class="p">)])</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; 13168189440000</span>
<span class="p">(</span><span class="k">for/and</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="p">(</span><span class="nb">in-range</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">)])</span><span class="w"> </span><span class="p">(</span><span class="nb">&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; #t</span>
<span class="p">(</span><span class="k">for/or</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="p">(</span><span class="nb">in-range</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">2</span><span class="p">)])</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; #t</span>
<span class="c1">;; 如果需要合并计算结果, 使用 `for/fold&#39;</span>
<span class="p">(</span><span class="k">for/fold</span><span class="w"> </span><span class="p">([</span><span class="n">sum</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">)])</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; 10</span>
<span class="c1">;; (这个函数可以在大部分情况下替代普通的命令式循环)</span>

<span class="c1">;;; 异常</span>

<span class="c1">;; 要捕获一个异常，使用 `with-handlers&#39; 形式</span>
<span class="p">(</span><span class="k">with-handlers</span><span class="w"> </span><span class="p">([</span><span class="nb">exn:fail?</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nb">exn</span><span class="p">)</span><span class="w"> </span><span class="mi">999</span><span class="p">)])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="s2">&quot;2&quot;</span><span class="p">))</span><span class="w"> </span><span class="c1">; =&gt; 999</span>
<span class="p">(</span><span class="k">with-handlers</span><span class="w"> </span><span class="p">([</span><span class="nb">exn:break?</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nb">exn</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;no time&quot;</span><span class="p">)])</span>
<span class="w">  </span><span class="p">(</span><span class="nb">sleep</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="w">  </span><span class="s2">&quot;phew&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; &quot;phew&quot;, 如果你打断了它，那么结果 =&gt; &quot;no time&quot;</span>

<span class="c1">;; 使用 `raise&#39; 抛出一个异常后者其他任何值</span>
<span class="p">(</span><span class="k">with-handlers</span><span class="w"> </span><span class="p">([</span><span class="nb">number?</span><span class="w">    </span><span class="c1">; 捕获抛出的数字类型的值</span>
<span class="w">                 </span><span class="nb">identity</span><span class="p">])</span><span class="w"> </span><span class="c1">; 将它们作为普通值</span>
<span class="w">  </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">raise</span><span class="w"> </span><span class="mi">2</span><span class="p">)))</span><span class="w"> </span><span class="c1">; =&gt; 2</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 6. 可变的值</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span class="c1">;; 使用 `set!&#39; 给一个已经存在的变量赋一个新值</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="k">set!</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="nb">add1</span><span class="w"> </span><span class="n">n</span><span class="p">))</span>
<span class="n">n</span><span class="w"> </span><span class="c1">; =&gt; 6</span>

<span class="c1">;; 给那些明确地需要变化的值使用 `boxes` (在其他语言里类似指针</span>
<span class="c1">;; 或者引用)</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">n*</span><span class="w"> </span><span class="p">(</span><span class="nb">box</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span>
<span class="p">(</span><span class="nb">set-box!</span><span class="w"> </span><span class="n">n*</span><span class="w"> </span><span class="p">(</span><span class="nb">add1</span><span class="w"> </span><span class="p">(</span><span class="nb">unbox</span><span class="w"> </span><span class="n">n*</span><span class="p">)))</span>
<span class="p">(</span><span class="nb">unbox</span><span class="w"> </span><span class="n">n*</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 6</span>

<span class="c1">;; 很多 Racket 数据类型是不可变的 (对，列表，等)，有一些既是可变的</span>
<span class="c1">;; 又是不可变的 (字符串，向量，散列表</span>
<span class="c1">;; 等...)</span>

<span class="c1">;; 使用 `vector&#39; 或者 `make-vector&#39; 创建一个可变的向量</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">vec</span><span class="w"> </span><span class="p">(</span><span class="nb">vector</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">wall</span><span class="w"> </span><span class="p">(</span><span class="nb">make-vector</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">bottle-of-beer</span><span class="p">))</span>
<span class="c1">;; 使用 `vector-set!` 更新一项</span>
<span class="p">(</span><span class="nb">vector-set!</span><span class="w"> </span><span class="n">vec</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="nb">vector-set!</span><span class="w"> </span><span class="n">wall</span><span class="w"> </span><span class="mi">99</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">down</span><span class="p">)</span>
<span class="n">vec</span><span class="w"> </span><span class="c1">; =&gt; #(1 2 3 4)</span>

<span class="c1">;; 创建一个空的可变散列表，然后操作它</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="p">(</span><span class="nb">make-hash</span><span class="p">))</span>
<span class="p">(</span><span class="nb">hash-set!</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="nb">hash-set!</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">b</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="nb">hash-set!</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">c</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="nb">hash-ref</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="p">)</span><span class="w">   </span><span class="c1">; =&gt; 1</span>
<span class="p">(</span><span class="nb">hash-ref</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">d</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 0</span>
<span class="p">(</span><span class="nb">hash-remove!</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="p">)</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 7. 模块</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span class="c1">;; 模块让你将你的代码组织为多个文件，成为可重用的模块，</span>
<span class="c1">;; 在这里，我们使用嵌套在本文的整个大模块</span>
<span class="c1">;; 里的子模块(从 &quot;#lang&quot; 这一行开始)</span>

<span class="p">(</span><span class="k">module</span><span class="w"> </span><span class="n">cake</span><span class="w"> </span><span class="n">racket/base</span><span class="w"> </span><span class="c1">; 基于 racket/base 定义一个 `cake` 模块</span>

<span class="w">  </span><span class="p">(</span><span class="k">provide</span><span class="w"> </span><span class="n">print-cake</span><span class="p">)</span><span class="w"> </span><span class="c1">; 这个模块导出的函数</span>

<span class="w">  </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">print-cake</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">show</span><span class="w"> </span><span class="s2">&quot;   ~a   &quot;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="sc">#\.</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">show</span><span class="w"> </span><span class="s2">&quot; .-~a-. &quot;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="sc">#\|</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">show</span><span class="w"> </span><span class="s2">&quot; | ~a | &quot;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="sc">#\space</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">show</span><span class="w"> </span><span class="s2">&quot;---~a---&quot;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="sc">#\-</span><span class="p">))</span>

<span class="w">  </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">show</span><span class="w"> </span><span class="n">fmt</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">ch</span><span class="p">)</span><span class="w"> </span><span class="c1">; 内部函数</span>
<span class="w">    </span><span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="n">fmt</span><span class="w"> </span><span class="p">(</span><span class="nb">make-string</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">ch</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">newline</span><span class="p">)))</span>

<span class="c1">;; 使用 `require` 从模块中得到所有 `provide` 的函数</span>
<span class="p">(</span><span class="k">require</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">cake</span><span class="p">)</span><span class="w"> </span><span class="c1">; 这里的 `&#39;`表示是本地的子模块</span>
<span class="p">(</span><span class="n">print-cake</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="c1">; (show &quot;~a&quot; 1 #\A) ; =&gt; 报错, `show&#39; 没有被导出，不存在</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 8. 类和对象</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span class="c1">;; 创建一个 fish% 类(%是给类绑定用的)</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">fish%</span>
<span class="w">  </span><span class="p">(</span><span class="k">class</span><span class="w"> </span><span class="nb">object%</span>
<span class="w">    </span><span class="p">(</span><span class="k">init</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="c1">; 初始化的参数</span>
<span class="w">    </span><span class="p">(</span><span class="k">super-new</span><span class="p">)</span><span class="w"> </span><span class="c1">; 父类的初始化</span>
<span class="w">    </span><span class="c1">;; 域</span>
<span class="w">    </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">current-size</span><span class="w"> </span><span class="n">size</span><span class="p">)</span>
<span class="w">    </span><span class="c1">;; 公共方法</span>
<span class="w">    </span><span class="p">(</span><span class="k">define/public</span><span class="w"> </span><span class="p">(</span><span class="n">get-size</span><span class="p">)</span>
<span class="w">      </span><span class="n">current-size</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">define/public</span><span class="w"> </span><span class="p">(</span><span class="n">grow</span><span class="w"> </span><span class="n">amt</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="k">set!</span><span class="w"> </span><span class="n">current-size</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="n">amt</span><span class="w"> </span><span class="n">current-size</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="k">define/public</span><span class="w"> </span><span class="p">(</span><span class="n">eat</span><span class="w"> </span><span class="n">other-fish</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="n">grow</span><span class="w"> </span><span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">other-fish</span><span class="w"> </span><span class="n">get-size</span><span class="p">)))))</span>

<span class="c1">;; 创建一个 fish% 类的示例</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">charlie</span>
<span class="w">  </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">fish%</span><span class="w"> </span><span class="p">[</span><span class="n">size</span><span class="w"> </span><span class="mi">10</span><span class="p">]))</span>

<span class="c1">;; 使用 `send&#39; 调用一个对象的方法</span>
<span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">charlie</span><span class="w"> </span><span class="n">get-size</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 10</span>
<span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">charlie</span><span class="w"> </span><span class="n">grow</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span>
<span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">charlie</span><span class="w"> </span><span class="n">get-size</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 16</span>

<span class="c1">;; `fish%&#39; 是一个普通的值，我们可以用它来混入</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">add-color</span><span class="w"> </span><span class="n">c%</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">class</span><span class="w"> </span><span class="n">c%</span>
<span class="w">    </span><span class="p">(</span><span class="k">init</span><span class="w"> </span><span class="n">color</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">super-new</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">my-color</span><span class="w"> </span><span class="n">color</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">define/public</span><span class="w"> </span><span class="p">(</span><span class="n">get-color</span><span class="p">)</span><span class="w"> </span><span class="n">my-color</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">colored-fish%</span><span class="w"> </span><span class="p">(</span><span class="n">add-color</span><span class="w"> </span><span class="n">fish%</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">charlie2</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">colored-fish%</span><span class="w"> </span><span class="p">[</span><span class="n">size</span><span class="w"> </span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">color</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">red</span><span class="p">]))</span>
<span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">charlie2</span><span class="w"> </span><span class="n">get-color</span><span class="p">)</span>
<span class="c1">;; 或者，不带名字</span>
<span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="p">(</span><span class="n">add-color</span><span class="w"> </span><span class="n">fish%</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">size</span><span class="w"> </span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">color</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">red</span><span class="p">])</span><span class="w"> </span><span class="n">get-color</span><span class="p">)</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 9. 宏</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span class="c1">;; 宏让你扩展这门语言的语法</span>

<span class="c1">;; 让我们定义一个while循环</span>
<span class="p">(</span><span class="k">define-syntax-rule</span><span class="w"> </span><span class="p">(</span><span class="n">while</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="k">...</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">when</span><span class="w"> </span><span class="n">condition</span>
<span class="w">      </span><span class="n">body</span><span class="w"> </span><span class="k">...</span>
<span class="w">      </span><span class="p">(</span><span class="n">loop</span><span class="p">))))</span>

<span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span>
<span class="w">  </span><span class="p">(</span><span class="n">while</span><span class="w"> </span><span class="p">(</span><span class="nb">&lt;</span><span class="w"> </span><span class="n">i</span><span class="w">  </span><span class="mi">10</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">displayln</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">set!</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">(</span><span class="nb">add1</span><span class="w"> </span><span class="n">i</span><span class="p">))))</span>

<span class="c1">;; 宏是安全的，你不能修改现有的变量</span>
<span class="p">(</span><span class="k">define-syntax-rule</span><span class="w"> </span><span class="p">(</span><span class="n">swap!</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="c1">; !表示会修改</span>
<span class="w">  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="n">tmp</span><span class="w"> </span><span class="n">x</span><span class="p">])</span>
<span class="w">    </span><span class="p">(</span><span class="k">set!</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">set!</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">tmp</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="n">swap!</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="n">other</span><span class="p">)</span>
<span class="p">(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;tmp = ~a; other = ~a</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="n">other</span><span class="p">)</span>
<span class="c1">;; 变量 `tmp` 被重命名为 `tmp_1`</span>
<span class="c1">;; 避免名字冲突</span>
<span class="c1">;; (let ([tmp_1 tmp])</span>
<span class="c1">;;   (set! tmp other)</span>
<span class="c1">;;   (set! other tmp_1))</span>

<span class="c1">;; 但它们仍然会导致错误代码，比如:</span>
<span class="p">(</span><span class="k">define-syntax-rule</span><span class="w"> </span><span class="p">(</span><span class="n">bad-while</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="k">...</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">when</span><span class="w"> </span><span class="n">condition</span>
<span class="w">    </span><span class="n">body</span><span class="w"> </span><span class="k">...</span>
<span class="w">    </span><span class="p">(</span><span class="n">bad-while</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="k">...</span><span class="p">)))</span>
<span class="c1">;; 这个宏会挂掉，它产生了一个无限循环，如果你试图去使用它</span>
<span class="c1">;; 编译器会进入死循环</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; 10. 契约</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span class="c1">;; 契约限制变量从模块中导入</span>

<span class="p">(</span><span class="k">module</span><span class="w"> </span><span class="n">bank-account</span><span class="w"> </span><span class="n">racket</span>
<span class="w">  </span><span class="p">(</span><span class="k">provide</span><span class="w"> </span><span class="p">(</span><span class="k">contract-out</span>
<span class="w">            </span><span class="p">[</span><span class="n">deposit</span><span class="w"> </span><span class="p">(</span><span class="k">-&gt;</span><span class="w"> </span><span class="nb">positive?</span><span class="w"> </span><span class="k">any</span><span class="p">)]</span><span class="w"> </span><span class="c1">; 数量一直是正值</span>
<span class="w">            </span><span class="p">[</span><span class="n">balance</span><span class="w"> </span><span class="p">(</span><span class="k">-&gt;</span><span class="w"> </span><span class="nb">positive?</span><span class="p">)]))</span>

<span class="w">  </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">deposit</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">set!</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">a</span><span class="p">)))</span>
<span class="w">  </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">balance</span><span class="p">)</span><span class="w"> </span><span class="n">amount</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>

<span class="p">(</span><span class="k">require</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">bank-account</span><span class="p">)</span>
<span class="p">(</span><span class="n">deposit</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>

<span class="p">(</span><span class="n">balance</span><span class="p">)</span><span class="w"> </span><span class="c1">; =&gt; 5</span>

<span class="c1">;; 客户端尝试存储一个负值时会出错</span>
<span class="c1">;; (deposit -5) ; =&gt; deposit: contract violation</span>
<span class="c1">;; expected: positive?</span>
<span class="c1">;; given: -5</span>
<span class="c1">;; more details....</span>
</pre></div>
<h2>进一步阅读</h2>

<p>想知道更多吗？ 尝试 <a href="http://docs.racket-lang.org/getting-started/">Getting Started with Racket</a></p>

    <hr>
    <p>有建议？或者发现什么错误？在Github上<a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">开一个issue</a>，或者发起<a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/zh-cn/racket-cn.html.markdown">pull request</a>！
    </p>
    <p class="contributed">
    原著th3rac25，并由<a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/zh-cn/racket-cn.html.markdown">4个好心人</a>修改。
    </p>

    <footer>
    <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>
    <p>
    &copy; 2024
        <a href="https://github.com/voila">th3rac25</a>,
        <a href="https://github.com/elibarzilay">Eli Barzilay</a>,
        <a href="https://github.com/gustavoschmidt">Gustavo Schmidt</a>
    </p>

    <p>
      Translated by:
        <a href="https://github.com/lyuehh">lyuehh</a>

    </footer>
  </div>

        </div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script src="/js/script.js"></script>
    </body>
</html>
