<!DOCTYPE html lang="en-us" xml:lang="en-us" xmlns="http://www.w3.org/1999/xhtml">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
      <!-- Google tag (gtag.js) -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-WXC8R75DEN');
      </script>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta http-equiv="Content-Language" content="en-us">
        <!-- Use title if it's in the page YAML frontmatter -->
        <title>Learn X in Y Minutes: Scenic Programming Language Tours</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="/css/index.css">

        <link rel="canonical" href="https://learnxinyminutes.com/docs/messagepack/">
        <script>
            var THEME_KEY = "lxiym_theme";
            function set_theme(theme) {
                var el = document.getElementsByTagName("html")[0];
                if (!el) {
                  return;
                }

                if (theme === "dark" ) {
                    el.className = "dark";
                } else {
                    el.className = "light";
                }

                localStorage.setItem(THEME_KEY, theme);
            }

            function load_theme() {
              var theme = localStorage.getItem(THEME_KEY);
              if (theme) {
                set_theme(theme);
              }
            }

            // Attempt immediate application of html style
            load_theme();

            // Backup: do it onload. Will flash, but better than nothing.
            window.addEventListener("load", function(){
              load_theme();
            });
        </script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="container">
            <div class="share">
    <span class="sharemsg">
      <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fdocs%2Fmessagepack%2F&text=Learn+X+in+Y+minutes%2C+where+X%3Dmessagepack">
        Share this page
      </a></span>

      <span class='st_facebook_large' displayText='Facebook'></span>
      <span class='st_twitter_large' displayText='Tweet'></span>
  </div>
  <div class="theme-choice">
    <label id="theme-label">Select theme:</label>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('light');">light</button>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('dark');">dark</button>
  </div>
  <h1><a href="/">Learn X in Y minutes</a></h1>
  <h2>Where X=messagepack</h2>
    <p class="filelink">
    Get the code:
    <a href="/docs/files/learnmessagepack.mpac">learnmessagepack.mpac</a>
    </p>
  <div id="doc">
    <p>MessagePack is an efficient binary serialization format. It lets you exchange data among multiple languages like JSON. The benefits over other formats is that it&rsquo;s faster and smaller. </p>

<p>In MessagePack, small integers are encoded into a single byte, and typical short strings require only one extra byte in addition to the strings themselves. This makes MessagePack useful for efficient transmission over wire.</p>
<div class="highlight"><pre><span></span><span class="err">#</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w"> </span><span class="nx">Understanding</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="nx">Structure</span><span class="w"> </span><span class="o">====</span>

<span class="nx">JSON</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="nx">Bytes</span><span class="w"> </span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>

<span class="o">----------------------------------------------</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;John Doe&quot;</span><span class="p">,</span><span class="s">&quot;age&quot;</span><span class="p">:</span><span class="mi">12</span><span class="p">}</span><span class="w">               </span><span class="o">|</span>
<span class="o">----------------------------------------------</span>
<span class="o">|</span><span class="w">  </span><span class="p">{</span><span class="s">&quot;         | 7B 22                        |</span>
<span class="s">|    name     | 6E 61 6D 65                  |</span>
<span class="s">|  &quot;</span><span class="p">:</span><span class="s">&quot;        | 22 3A 22                     |</span>
<span class="s">|    John Doe | 4A 6F 68 6E 20 44 6F 65      |</span>
<span class="s">|  &quot;</span><span class="p">,</span><span class="s">&quot;        | 22 2C 22                     |</span>
<span class="s">|    age      | 61 67 65                     |</span>
<span class="s">|  &quot;</span><span class="p">:</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="mi">3</span><span class="nx">A</span><span class="w"> </span><span class="mi">20</span><span class="w">                     </span><span class="o">|</span>
<span class="o">|</span><span class="w">    </span><span class="mi">12</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="mi">31</span><span class="w"> </span><span class="mi">32</span><span class="w">                        </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="p">}</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">7</span><span class="nx">D</span><span class="w">                           </span><span class="o">|</span>
<span class="o">----------------------------------------------</span>


<span class="nx">MessagePack</span><span class="p">,</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="nx">Bytes</span><span class="w"> </span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>

<span class="o">----------------------------------------------</span>
<span class="o">|</span><span class="w"> </span><span class="err">‚¤</span><span class="nx">name</span><span class="err">¨</span><span class="nx">John</span><span class="w"> </span><span class="nx">Doe</span><span class="err">£</span><span class="nx">age</span><span class="m m-Double">.1</span><span class="mi">2</span><span class="w">                     </span><span class="o">|</span>
<span class="o">----------------------------------------------</span>
<span class="o">|</span><span class="w">  </span><span class="err">‚¤</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="mi">82</span><span class="w"> </span><span class="mi">84</span><span class="w">                        </span><span class="o">|</span>
<span class="o">|</span><span class="w">    </span><span class="nx">name</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="mi">6</span><span class="nx">E</span><span class="w"> </span><span class="mi">61</span><span class="w"> </span><span class="mi">6</span><span class="nx">D</span><span class="w"> </span><span class="mi">65</span><span class="w">                  </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="err">¨</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="nx">A8</span><span class="w">                           </span><span class="o">|</span>
<span class="o">|</span><span class="w">    </span><span class="nx">John</span><span class="w"> </span><span class="nx">Doe</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="nx">A</span><span class="w"> </span><span class="mi">6</span><span class="nx">F</span><span class="w"> </span><span class="mi">68</span><span class="w"> </span><span class="mi">6</span><span class="nx">E</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">6</span><span class="nx">F</span><span class="w"> </span><span class="mi">65</span><span class="w">      </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="err">£</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="nx">A3</span><span class="w">                           </span><span class="o">|</span>
<span class="o">|</span><span class="w">    </span><span class="nx">age</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">61</span><span class="w"> </span><span class="mi">67</span><span class="w"> </span><span class="mi">65</span><span class="w">                     </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="p">.</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="nx">C</span><span class="w">                           </span><span class="o">|</span>
<span class="o">|</span><span class="w">    </span><span class="mi">12</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="mi">31</span><span class="w"> </span><span class="mi">32</span><span class="w">                        </span><span class="o">|</span>
<span class="o">----------------------------------------------</span>

<span class="err">#</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">JAVA</span><span class="w"> </span><span class="o">====</span>

<span class="s">&quot;&quot;&quot; Installing with Maven</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="p">&lt;</span><span class="nx">dependencies</span><span class="p">&gt;</span>
<span class="w">  </span><span class="o">...</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nx">dependency</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nx">groupId</span><span class="p">&gt;</span><span class="nx">org</span><span class="p">.</span><span class="nx">msgpack</span><span class="p">&lt;</span><span class="o">/</span><span class="nx">groupId</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nx">artifactId</span><span class="p">&gt;</span><span class="nx">msgpack</span><span class="p">&lt;</span><span class="o">/</span><span class="nx">artifactId</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nx">version</span><span class="p">&gt;</span><span class="err">$</span><span class="p">{</span><span class="nx">msgpack</span><span class="p">.</span><span class="nx">version</span><span class="p">}&lt;</span><span class="o">/</span><span class="nx">version</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">&lt;</span><span class="o">/</span><span class="nx">dependency</span><span class="p">&gt;</span>
<span class="w">  </span><span class="o">...</span>
<span class="p">&lt;</span><span class="o">/</span><span class="nx">dependencies</span><span class="p">&gt;</span>


<span class="s">&quot;&quot;&quot; Simple Serialization/Deserialization</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="c1">// Create serialize objects.</span>
<span class="nx">List</span><span class="p">&lt;</span><span class="nx">String</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">src</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">ArrayList</span><span class="p">&lt;</span><span class="nx">String</span><span class="p">&gt;();</span>
<span class="nx">src</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s">&quot;msgpack&quot;</span><span class="p">);</span>
<span class="nx">src</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s">&quot;kumofs&quot;</span><span class="p">);</span>

<span class="nx">MessagePack</span><span class="w"> </span><span class="nx">msgpack</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">MessagePack</span><span class="p">();</span>
<span class="c1">// Serialize</span>
<span class="nx">byte</span><span class="p">[]</span><span class="w"> </span><span class="nx">raw</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">msgpack</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">src</span><span class="p">);</span>

<span class="c1">// Deserialize directly using a template</span>
<span class="nx">List</span><span class="p">&lt;</span><span class="nx">String</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">dst1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">msgpack</span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">raw</span><span class="p">,</span><span class="w"> </span><span class="nx">Templates</span><span class="p">.</span><span class="nx">tList</span><span class="p">(</span><span class="nx">Templates</span><span class="p">.</span><span class="nx">TString</span><span class="p">));</span>
<span class="nx">System</span><span class="p">.</span><span class="nx">out</span><span class="p">.</span><span class="nx">println</span><span class="p">(</span><span class="nx">dst1</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="nx">System</span><span class="p">.</span><span class="nx">out</span><span class="p">.</span><span class="nx">println</span><span class="p">(</span><span class="nx">dst1</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>

<span class="c1">// Or, Deserialze to Value then convert type.</span>
<span class="nx">Value</span><span class="w"> </span><span class="nx">dynamic</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">msgpack</span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">raw</span><span class="p">);</span>
<span class="nx">List</span><span class="p">&lt;</span><span class="nx">String</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">dst2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">Converter</span><span class="p">(</span><span class="nx">dynamic</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">Templates</span><span class="p">.</span><span class="nx">tList</span><span class="p">(</span><span class="nx">Templates</span><span class="p">.</span><span class="nx">TString</span><span class="p">));</span>
<span class="nx">System</span><span class="p">.</span><span class="nx">out</span><span class="p">.</span><span class="nx">println</span><span class="p">(</span><span class="nx">dst2</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="nx">System</span><span class="p">.</span><span class="nx">out</span><span class="p">.</span><span class="nx">println</span><span class="p">(</span><span class="nx">dst2</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>


<span class="err">#</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">RUBY</span><span class="w"> </span><span class="o">====</span>

<span class="s">&quot;&quot;&quot; Installing the Gem</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="nx">gem</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">msgpack</span>

<span class="s">&quot;&quot;&quot; Streaming API</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="err">#</span><span class="w"> </span><span class="nx">serialize</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="mi">2</span><span class="o">-</span><span class="nx">element</span><span class="w"> </span><span class="nx">array</span><span class="w"> </span><span class="p">[</span><span class="nx">e1</span><span class="p">,</span><span class="w"> </span><span class="nx">e2</span><span class="p">]</span>
<span class="nx">pk</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">MessagePack</span><span class="o">::</span><span class="nx">Packer</span><span class="p">.</span><span class="nx">new</span><span class="p">(</span><span class="nx">io</span><span class="p">)</span>
<span class="nx">pk</span><span class="p">.</span><span class="nx">write_array_header</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="nx">write</span><span class="p">(</span><span class="nx">e1</span><span class="p">).</span><span class="nx">write</span><span class="p">(</span><span class="nx">e2</span><span class="p">).</span><span class="nx">flush</span>

<span class="err">#</span><span class="w"> </span><span class="nx">deserialize</span><span class="w"> </span><span class="nx">objects</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">IO</span>
<span class="nx">u</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">MessagePack</span><span class="o">::</span><span class="nx">Unpacker</span><span class="p">.</span><span class="nx">new</span><span class="p">(</span><span class="nx">io</span><span class="p">)</span>
<span class="nx">u</span><span class="p">.</span><span class="nx">each</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">|</span><span class="nx">obj</span><span class="o">|</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="p">}</span>

<span class="err">#</span><span class="w"> </span><span class="nx">event</span><span class="o">-</span><span class="nx">driven</span><span class="w"> </span><span class="nx">deserialization</span>
<span class="nx">def</span><span class="w"> </span><span class="nx">on_read</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="w">  </span><span class="err">@</span><span class="nx">u</span><span class="w"> </span><span class="o">||</span><span class="p">=</span><span class="w"> </span><span class="nx">MessagePack</span><span class="o">::</span><span class="nx">Unpacker</span><span class="p">.</span><span class="nx">new</span>
<span class="w">  </span><span class="err">@</span><span class="nx">u</span><span class="p">.</span><span class="nx">feed_each</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">|</span><span class="nx">obj</span><span class="o">|</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="p">}</span>
<span class="nx">end</span>

<span class="err">#</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nx">NODE</span><span class="p">.</span><span class="nx">JS</span><span class="w"> </span><span class="o">====</span>

<span class="s">&quot;&quot;&quot; Installing with NPM</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="nx">npm</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">msgpack5</span><span class="w"> </span><span class="o">--</span><span class="nx">save</span>

<span class="s">&quot;&quot;&quot; Using in Node</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">msgpack</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">msgpack5</span><span class="err">&#39;</span><span class="p">)()</span><span class="w"> </span><span class="c1">// namespace our extensions</span>
<span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">MyType</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="nx">encode</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nx">msgpack</span><span class="p">.</span><span class="nx">encode</span>
<span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="nx">decode</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nx">msgpack</span><span class="p">.</span><span class="nx">decode</span>

<span class="nx">msgpack</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="mh">0x4</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">MyType</span><span class="p">,</span><span class="w"> </span><span class="nx">mytipeEncode</span><span class="p">,</span><span class="w"> </span><span class="nx">mytipeDecode</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">encode</span><span class="p">({</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">hello</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">world</span><span class="err">&#39;</span><span class="w"> </span><span class="p">}).</span><span class="nx">toString</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">hex</span><span class="err">&#39;</span><span class="p">))</span>
<span class="c1">// 81a568656c6c6fa5776f726c64</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">decode</span><span class="p">(</span><span class="nx">encode</span><span class="p">({</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">hello</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">world</span><span class="err">&#39;</span><span class="w"> </span><span class="p">})))</span>
<span class="c1">// { hello: &#39;world&#39; }</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">encode</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">hex</span><span class="err">&#39;</span><span class="p">))</span>
<span class="c1">// d5426161</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">decode</span><span class="p">(</span><span class="nx">encode</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="w"> </span><span class="nx">instanceof</span><span class="w"> </span><span class="nx">MyType</span><span class="p">)</span>
<span class="c1">// true</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">decode</span><span class="p">(</span><span class="nx">encode</span><span class="p">(</span><span class="nx">a</span><span class="p">)))</span>
<span class="c1">// { value: &#39;a&#39;, size: 2 }</span>

<span class="nx">function</span><span class="w"> </span><span class="nx">MyType</span><span class="p">(</span><span class="nx">size</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">this</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">value</span>
<span class="w">  </span><span class="nx">this</span><span class="p">.</span><span class="nx">size</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nx">size</span>
<span class="p">}</span>

<span class="nx">function</span><span class="w"> </span><span class="nx">mytipeEncode</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">buf</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">Buffer</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">size</span><span class="p">)</span>
<span class="w">  </span><span class="nx">buf</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">buf</span>
<span class="p">}</span>

<span class="nx">function</span><span class="w"> </span><span class="nx">mytipeDecode</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">MyType</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">utf8</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nx">i</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">readUInt8</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">readUInt8</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">throw</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">Error</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">should</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">same</span><span class="err">&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span>
<span class="p">}</span>
</pre></div>
<h1>References</h1>

<ul>
<li><a href="http://msgpack.org/index.html">MessagePack</a></li>
<li><a href="http://indiegamr.com/cut-your-data-exchange-traffic-by-up-to-50-with-one-line-of-code-msgpack-vs-json/">MsgPack vs. JSON: Cut your client-server exchange traffic by 50% with one line of code</a></li>
</ul>

    <hr>
    <p>Got a suggestion? A correction, perhaps? <a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">Open an Issue</a> on the Github Repo, or make a <a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/messagepack.html.markdown">pull request</a> yourself!
    </p>
    <p class="contributed">
    Originally contributed by Gabriel Chuan, and updated by <a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/messagepack.html.markdown">1 contributor(s)</a>.
    </p>

    <footer>
    <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>
    <p>
    &copy; 2024
        <a href="https://github.com/gczh">Gabriel Chuan</a>
    </p>

    <p>

    </footer>
  </div>

        </div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script src="/js/script.js"></script>
    </body>
</html>
