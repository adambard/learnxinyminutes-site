<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WXC8R75DEN');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Language" content="zh-CN">
    <title>Learn Fortran in Y Minutes</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto+Slab:wght@100..900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/screen.css">
    <link rel="stylesheet" href="/css/light.css">
    <link rel="stylesheet" href="/css/dark.css">

    <link rel="canonical" href="https://learnxinyminutes.com/zh-cn/fortran/">
    <script>
      localStorage.removeItem("lxiym_theme");
    </script>
  </head>
  <body>
    <div class="container">
      <div class="share">
        <span class="sharemsg">
          <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fzh-cn%2Ffortran%2F&amp;text=Y%E5%88%86%E9%92%9F%E9%80%9F%E6%88%90X%2C+%E5%85%B6%E4%B8%AD+X%3DFortran">
            分享此页
          </a>
        </span>
        <span class='st_facebook_large' displayText='Facebook'></span>
        <span class='st_twitter_large' displayText='Tweet'></span>
      </div>
      <h1><a href="/">Y分钟速成X</a></h1>
      <h2>其中 X=Fortran</h2>
      <p class="filelink">
        源代码下载：
        <a href="/zh-cn/files/learnfortran.f90">learnfortran.f90</a>
      </p>
      <div id="doc">
<p>Fortran 是最古老的计算机语言之一。它由 IBM 开发于 1950 年用于数值运算（Fortran 为 &quot;Formula
Translation&quot; 的缩写）。虽然该语言已年代久远，但目前仍用于高性能计算，如天气预报。
该语言仍在持续发展，并且基本保持向下兼容。知名的版本为 Fortran 77, Fortran 90,
Fortran 95, Fortran 2008, Fortran 2015 和 Fortran 2023。</p>
<p>这篇概要将讨论 Fortran 2008 的一些特征。因为它是目前所广泛采用的标准版本，并且与最新版本的内容
也基本相同（而 Fortran 77 则是一个非常不同的版本）。</p>
<div class="highlight"><pre lang="fortran"><span class="c">! 这是一个注释</span>

<span class="k">program </span><span class="n">example</span><span class="w">         </span><span class="c">! 声明一个名为 example 的程序</span>

<span class="w">    </span><span class="c">! 代码只能存在于程序、函数、子程序或模块中</span>
<span class="w">    </span><span class="c">! 使用缩进不是必需的，但推荐使用</span>

<span class="w">    </span><span class="c">! 声明变量</span>
<span class="w">    </span><span class="c">! =========</span>

<span class="w">    </span><span class="c">! 所有的声明必须在语句和表达式之前</span>

<span class="w">    </span><span class="k">implicit none</span><span class="w">       </span><span class="c">! 防止动态声明变量（推荐！）</span>
<span class="w">    </span><span class="c">! implicit none 推荐在每个函数/程序/模块中重新声明...</span>

<span class="w">    </span><span class="c">! 注意 - Fortran 中对大小写不敏感</span>
<span class="w">    </span><span class="kt">real </span><span class="n">z</span>
<span class="w">    </span><span class="kt">REAL </span><span class="n">Z2</span>

<span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w">        </span><span class="c">! 警告：默认的初始值取决于编译器！</span>
<span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2E12</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">PI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.1415926535897931</span><span class="w">    </span><span class="c">! 声明一个常数</span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w">            </span><span class="c">! 布尔类型</span>
<span class="w">    </span><span class="kt">complex</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">                         </span><span class="c">! 单位虚数</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">month</span><span class="w">                     </span><span class="c">! 字符串，长度为 3 个字符</span>

<span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="k">array</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">                              </span><span class="c">! 声明一个包含 6 个实数的数组</span>
<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">arrayb</span><span class="w">                  </span><span class="c">! 另一种声明数组的方式</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">arrayc</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span><span class="w">                     </span><span class="c">! 具有自定义索引的数组</span>
<span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">array2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">                         </span><span class="c">! 多维数组</span>

<span class="w">    </span><span class="c">! 这些分隔符 &#39;::&#39; 并不总是必需的，但推荐使用</span>

<span class="w">    </span><span class="c">! 还有许多其他的变量属性：</span>
<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p</span><span class="w">                            </span><span class="c">! 声明一个指针</span>

<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">LP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">selected_real_kind</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">LP</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">d</span><span class="w">                            </span><span class="c">! 长精度变量</span>

<span class="w">    </span><span class="c">! 警告：在声明过程中初始化变量会在函数中造成问题，</span>
<span class="w">    </span><span class="c">! 因为这会自动暗示 &#39;save&#39; 属性，</span>
<span class="w">    </span><span class="c">! 在函数调用之间保存变量的值一般情况下，</span>
<span class="w">    </span><span class="c">! 除了常量外，声明和初始化的代码应该分开！</span>

<span class="w">    </span><span class="c">! 字符串</span>
<span class="w">    </span><span class="c">! =======</span>

<span class="w">    </span><span class="kt">character</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_char</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;i&#39;</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;qwerty&quot;</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">str_b</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_long_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;This is a long string.&quot;</span>
<span class="w">    </span><span class="c">! 使用 (len=*) 可以自动计算长度，但只适用于常量</span>

<span class="w">    </span><span class="n">str_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a_str</span><span class="o">//</span><span class="s2">&quot; keyboard&quot;</span><span class="w">      </span><span class="c">! 使用 // 运算符连接字符串</span>

<span class="w">    </span><span class="c">! 赋值和算术</span>
<span class="w">    </span><span class="c">! =============</span>

<span class="w">    </span><span class="n">Z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">                           </span><span class="c">! 对上面声明的变量 z 进行赋值（对大小写不敏感）</span>
<span class="w">    </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="mf">1.54</span><span class="o">/</span><span class="p">(</span><span class="mf">2.3</span><span class="o">*</span><span class="mf">3.1</span><span class="p">)</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">**</span><span class="mi">3</span><span class="w">                        </span><span class="c">! 幂运算</span>

<span class="w">    </span><span class="c">! 流程控制语句和操作符</span>
<span class="w">    </span><span class="c">! ===================</span>

<span class="w">    </span><span class="c">! 单行 if 语句</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w">               </span><span class="c">! 条件始终需要在括号中</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">                </span><span class="c">! z 不等于 a</span>
<span class="w">        </span><span class="c">! 其他的比较操作符包括 &lt; &gt; &lt;= &gt;= == /=</span>
<span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="w">    </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">         </span><span class="c">! z 大于 a</span>
<span class="w">        </span><span class="c">! 文本等价于符号操作符中的 .LT. .GT. .LE. .GE. .EQ. .NE.</span>
<span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
<span class="w">    </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">            </span><span class="c">! &#39;then&#39; 必须在本行上</span>
<span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">                       </span><span class="c">! 执行块必须在新的一行上</span>
<span class="w">    </span><span class="k">else</span>
<span class="k">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="k">end if</span><span class="w">                          </span><span class="c">! end 语句后需要 &#39;if&#39;（或可以使用 &#39;endif&#39;）</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w">    </span><span class="c">! 布尔运算符</span>
<span class="w">        </span><span class="n">inner</span><span class="p">:</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="n">TRUE</span><span class="p">.)</span><span class="w"> </span><span class="k">then</span><span class="w">     </span><span class="c">! 可以对 if 结构命名</span>
<span class="w">            </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">end if </span><span class="n">inner</span><span class="w">                </span><span class="c">! then 必须命名对应的 endif 语句</span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span>
<span class="w">    </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">                     </span><span class="c">! 当 i == 0 或 i == 1 时</span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span><span class="w">                     </span><span class="c">! 当 i 在 2 到 10 之间（包括边界）时</span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="p">:)</span><span class="w">                      </span><span class="c">! 当 i &gt;= 11 时</span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="k">case </span><span class="n">default</span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="k">end select</span>

<span class="k">    </span><span class="n">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;jan&#39;</span>
<span class="w">    </span><span class="c">! 条件可以是整数、逻辑、或字符类型</span>
<span class="w">    </span><span class="c">! Select 结构也可以命名</span>
<span class="w">    </span><span class="n">monthly</span><span class="p">:</span><span class="k">select case</span><span class="p">(</span><span class="n">month</span><span class="p">)</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;jan&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="k">case </span><span class="n">default</span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">    </span><span class="k">end select </span><span class="n">monthly</span>

<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w">             </span><span class="c">! 循环从 2 到 10（包括）以 2 为步长</span>
<span class="w">        </span><span class="n">innerloop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="c">! 循环也可以命名</span>
<span class="w">            </span><span class="k">exit</span><span class="w">                </span><span class="c">! 退出循环</span>
<span class="w">        </span><span class="k">end do </span><span class="n">innerloop</span>
<span class="w">        </span><span class="k">cycle</span><span class="w">                   </span><span class="c">! 跳到下一个循环迭代</span>
<span class="w">    </span><span class="k">end do</span>

<span class="w">    </span><span class="c">! 虽然存在 Goto 语句，但它被强烈不推荐</span>
<span class="w">    </span><span class="k">goto</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="k">stop </span><span class="mi">1</span><span class="w">                      </span><span class="c">! 立即停止代码（并返回指定的条件代码）</span>
<span class="mi">10</span><span class="w">  </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">201</span><span class="w">                     </span><span class="c">! 这一行被标记为 10 行</span>

<span class="w">    </span><span class="c">! 数组</span>
<span class="w">    </span><span class="c">! =====</span>
<span class="w">    </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="o">/</span><span class="p">)</span>
<span class="w">    </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">]</span><span class="w">  </span><span class="c">! 使用 Fortran 2003 的表示法</span>
<span class="w">    </span><span class="n">arrayb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">3e3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.41</span><span class="p">,</span><span class="w"> </span><span class="mf">4e-5</span><span class="p">]</span>
<span class="w">    </span><span class="n">array2d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">reshape</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0</span><span class="p">,</span><span class="w"> </span><span class="mf">6.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">])</span>

<span class="w">    </span><span class="c">! Fortran 数组索引从 1 开始</span>
<span class="w">    </span><span class="c">! （默认情况下，但对于特定数组可以定义不同的索引）</span>
<span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">                </span><span class="c">! 取数组的第一个元素</span>
<span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>

<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="w">         </span><span class="c">! 打印从第三个到第五个元素（包括）</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">array2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w">      </span><span class="c">! 打印二维数组的第一列</span>

<span class="w">    </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">array</span><span class="o">*</span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w">         </span><span class="c">! 可以对数组应用数学表达式</span>
<span class="w">    </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">array</span><span class="o">*</span><span class="k">array</span><span class="w">         </span><span class="c">! 数组操作是逐元素进行的</span>
<span class="w">    </span><span class="c">! array = array*array2d     ! 这两个数组是不兼容的</span>

<span class="w">    </span><span class="c">! 有许多内置函数可用于数组</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="k">array</span><span class="p">,</span><span class="w"> </span><span class="k">array</span><span class="p">)</span><span class="w">   </span><span class="c">! 这是点积</span>
<span class="w">    </span><span class="c">! 使用 matmul() 进行矩阵运算</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="k">array</span><span class="p">)</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="k">array</span><span class="p">)</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nb">minloc</span><span class="p">(</span><span class="k">array</span><span class="p">)</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="k">array</span><span class="p">)</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nb">shape</span><span class="p">(</span><span class="k">array</span><span class="p">)</span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="k">array</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>

<span class="w">    </span><span class="c">! 循环数组（通常使用 product() 函数）</span>
<span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="k">array</span><span class="p">)</span>
<span class="w">        </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="o">*</span><span class="k">array</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>

<span class="w">    </span><span class="c">! 条件性地执行逐元素赋值</span>
<span class="w">    </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">]</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="p">(</span><span class="k">array</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="w">        </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="n">elsewhere</span><span class="p">(</span><span class="k">array</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="n">elsewhere</span>
<span class="w">        </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="k">end where</span>

<span class="w">    </span><span class="c">! 隐含 do 循环是创建数组的紧凑方式</span>
<span class="w">    </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)]</span><span class="w">       </span><span class="c">! 创建一个数组 [1,2,3,4,5,6]</span>
<span class="w">    </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)]</span><span class="w">   </span><span class="c">! 创建一个数组 [1,3,5,7,9,11]</span>
<span class="w">    </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)]</span><span class="w">    </span><span class="c">! 创建一个数组 [1,4,9,16,25,36]</span>
<span class="w">    </span><span class="k">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)]</span><span class="w">    </span><span class="c">! 创建一个数组 [4,5,4,5,4,5]</span>

<span class="w">    </span><span class="c">! 输入/输出</span>
<span class="w">    </span><span class="c">! =========</span>

<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w">                  </span><span class="c">! 将变量 &#39;b&#39; 打印到命令行</span>

<span class="w">    </span><span class="c">! 可以对打印的输出进行格式化</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s2">&quot;(I6)&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">320</span><span class="w">           </span><span class="c">! 打印 &#39;   320&#39;</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s2">&quot;(I6.4)&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w">           </span><span class="c">! 打印 &#39;  0003&#39;</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s2">&quot;(F6.3)&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">4.32</span><span class="w">        </span><span class="c">! 打印 &#39; 4.320&#39;</span>

<span class="w">    </span><span class="c">! 字母表示预期的类型，后面的数字表示用于打印值的字符数</span>
<span class="w">    </span><span class="c">! 字母可以是 I（整数），F（实数），E（工程表示法），</span>
<span class="w">    </span><span class="c">! L（逻辑），A（字符串）...</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s2">&quot;(I3)&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3200</span><span class="w">          </span><span class="c">! 打印 &#39;***&#39;，因为该数字不适合</span>

<span class="w">    </span><span class="c">! 可以有多个格式规范</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s2">&quot;(I5,F6.2,E6.2)&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="mf">3.41</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="mf">3.41</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s2">&quot;(3I5)&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="w">                       </span><span class="c">! 整数的三次重复（字段宽度为 5）</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s2">&quot;(2(I5,F6.2))&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="mf">3.42</span><span class="p">,</span><span class="w"> </span><span class="mi">340</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="mf">5.3</span><span class="w">     </span><span class="c">! 格式重复组合</span>

<span class="w">    </span><span class="c">! 我们还可以从终端读取输入</span>
<span class="w">    </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">v</span>
<span class="w">    </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2F6.2)&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w">                        </span><span class="c">! 读取两个数字</span>

<span class="w">    </span><span class="c">! 写入文件</span>
<span class="w">    </span><span class="k">open</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;records.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="c">! 文件通过 &#39;unit number&#39; 引用，这个数字可以在 9:99 范围内选择</span>
<span class="w">    </span><span class="c">! Status 可以是 {&#39;old&#39;,&#39;replace&#39;,&#39;new&#39;} 中的一个</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.2,F10.2,F10.2)&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span>
<span class="w">    </span><span class="k">close</span><span class="w"> </span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="w">    </span><span class="c">! 读取文件</span>
<span class="w">    </span><span class="k">open</span><span class="w"> </span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="s2">&quot;records.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;old&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="c">! 文件通过 &#39;new unit number&#39; 引用，编译器为您选择一个整数</span>
<span class="w">    </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;(3F10.2)&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span>
<span class="w">    </span><span class="k">close</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="w">    </span><span class="c">! 还有更多功能可用，超出了本文所讨论的范围，</span>
<span class="w">    </span><span class="c">! 还有由于与旧版本的 Fortran 的向后兼容性而存在的替代方案</span>

<span class="w">    </span><span class="c">! 内置函数</span>
<span class="w">    </span><span class="c">! ===========</span>

<span class="w">    </span><span class="c">! Fortran 大约有 200 个语言内部的函数/子程序</span>
<span class="w">    </span><span class="c">! 例如 -</span>
<span class="w">    </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">        </span><span class="c">! 将 &#39;v&#39; 设置为以秒为单位的时间</span>
<span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ior</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w">           </span><span class="c">! 两个整数的位 OR 运算</span>
<span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">            </span><span class="c">! 以 10 为底的对数</span>
<span class="w">    </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">floor</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w">            </span><span class="c">! 返回小于或等于 x 的最接近的整数</span>
<span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">aimag</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="w">            </span><span class="c">! 复数的虚部</span>

<span class="w">    </span><span class="c">! 函数和子程序</span>
<span class="w">    </span><span class="c">! ==============</span>

<span class="w">    </span><span class="c">! 子程序运行一些代码，并可以对输入值产生副作用或修改输入值</span>

<span class="w">    </span><span class="k">call </span><span class="n">routine</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="c">! 子程序调用</span>

<span class="w">    </span><span class="c">! 函数采用一系列输入参数，并返回一个单个值</span>
<span class="w">    </span><span class="c">! 不过，输入参数可能仍会被修改，并且会执行副作用</span>

<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w">       </span><span class="c">! 函数调用</span>

<span class="w">    </span><span class="c">! 函数调用还可以在表达式中使用</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">func2</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>

<span class="w">    </span><span class="c">! 一个纯函数是一个不修改其输入参数，</span>
<span class="w">    </span><span class="c">! 也不会引起任何副作用的函数</span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func3</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>

<span class="k">contains</span><span class="w">                    </span><span class="c">! 包含程序内部定义的子程序的区域</span>

<span class="w">    </span><span class="c">! Fortran 有几种稍微不同的方式来定义函数</span>

<span class="w">    </span><span class="kt">integer </span><span class="k">function </span><span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w">      </span><span class="c">! 函数返回一个整数值</span>
<span class="w">        </span><span class="c">! implicit none                 ! 子变量域可以不再声明 implicit none</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w">  </span><span class="c">! 在函数内部定义输入参数的类型</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w">            </span><span class="c">! 返回变量默认为函数名</span>
<span class="w">            </span><span class="k">return</span><span class="w">                      </span><span class="c">! 随时可以从函数返回当前值</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span>

<span class="w">        </span><span class="c">! 在函数的末尾不需要 return 语句</span>
<span class="w">    </span><span class="k">end function </span><span class="n">func</span>

<span class="w">    </span><span class="k">function </span><span class="n">func2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w">   </span><span class="c">! 返回变量声明为 &#39;f&#39;</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w">     </span><span class="c">! 可以声明和强制约定变量</span>
<span class="w">        </span><span class="c">! 不会被函数修改</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">c</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">f</span><span class="w">                    </span><span class="c">! 函数返回类型在函数内部声明</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">              </span><span class="c">! 注意：初始化暗示变量在函数调用之间保存</span>
<span class="w">        </span><span class="c">!</span>

<span class="w">        </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">c</span>
<span class="w">        </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w">                           </span><span class="c">! 修改输入变量的值</span>
<span class="w">        </span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="c">! 计算函数调用的次数</span>

<span class="w">    </span><span class="k">end function </span><span class="n">func2</span>

<span class="w">    </span><span class="k">pure function </span><span class="n">func3</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w">        </span><span class="c">! 纯函数不能有副作用</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">func3</span>

<span class="w">        </span><span class="n">func3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">c</span>

<span class="w">    </span><span class="k">end function </span><span class="n">func3</span>

<span class="w">    </span><span class="k">subroutine </span><span class="n">routine</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">f</span>
<span class="w">        </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">e</span>

<span class="w">        </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">d</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">e</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f</span>

<span class="w">    </span><span class="k">end subroutine </span><span class="n">routine</span>

<span class="k">end program </span><span class="n">example</span><span class="w">                     </span><span class="c">! 程序定义结束--------------------------</span>

<span class="c">! 函数和子程序在程序列表之外声明，在程序之间以及模块中声明时，需要使用 interface 声明（即使它们在同一源文件中）（见下面）将它们定义在模块或程序的 &#39;contains&#39; 部分更容易</span>

<span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">func4</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="c">! elemental 函数是一个纯函数，它采用标量输入变量，</span>
<span class="c">! 但也可以在数组上独立应用，并返回一个新的数组</span>
<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span>

<span class="w">    </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0</span>

<span class="k">end function </span><span class="n">func4</span>

<span class="c">! 模块</span>
<span class="c">! =======</span>

<span class="c">! 模块是在可重用性中将相关的声明、函数和子程序结合在一起的有用方式</span>

<span class="k">module </span><span class="n">fruit</span>

<span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">apple</span>
<span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pear</span>
<span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">orange</span>

<span class="k">end module </span><span class="n">fruit</span>

<span class="k">module </span><span class="n">fruity</span>
<span class="w">    </span><span class="c">! 声明的顺序必须是：模块、接口、变量</span>
<span class="w">    </span><span class="c">!（也可以在程序中声明模块和接口）</span>

<span class="w">    </span><span class="k">use </span><span class="n">fruit</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">apple</span><span class="p">,</span><span class="w"> </span><span class="n">pear</span><span class="w">    </span><span class="c">! 使用 fruit 模块中的 apple 和 pear</span>
<span class="w">    </span><span class="k">implicit none</span><span class="w">                   </span><span class="c">! 导入模块之后</span>

<span class="w">    </span><span class="k">private</span><span class="w">                         </span><span class="c">! 将一些内容私有化（默认为公共）</span>
<span class="w">    </span><span class="c">! 显式将一些变量/函数声明为公共</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">apple</span><span class="p">,</span><span class="w"> </span><span class="n">mycar</span><span class="p">,</span><span class="w"> </span><span class="n">create_mycar</span>
<span class="w">    </span><span class="c">! 将一些变量/函数声明为模块私有（本例中是多余的）</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">func4</span>

<span class="w">    </span><span class="c">! 接口</span>
<span class="w">    </span><span class="c">! ========</span>
<span class="w">    </span><span class="c">! 在模块内部（最好放在 &#39;contains&#39; 部分）显式声明外部函数/过程</span>
<span class="w">    </span><span class="k">interface</span>
<span class="k">        elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">func4</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span>
<span class="w">        </span><span class="k">end function </span><span class="n">func4</span>
<span class="w">    </span><span class="k">end interface</span>

<span class="w">    </span><span class="c">! 可以使用命名接口定义重载函数</span>
<span class="w">    </span><span class="k">interface </span><span class="n">myabs</span>
<span class="w">        </span><span class="c">! 可以使用 &#39;module procedure&#39; 关键字包括模块内已经定义的函数</span>
<span class="w">        </span><span class="k">module procedure </span><span class="n">real_abs</span><span class="p">,</span><span class="w"> </span><span class="n">complex_abs</span>
<span class="w">    </span><span class="k">end interface</span>

<span class="w">    </span><span class="c">! 派生数据类型</span>
<span class="w">    </span><span class="c">! ==================</span>
<span class="w">    </span><span class="c">! 可以创建自定义的结构化数据集合</span>
<span class="w">    </span><span class="k">type </span><span class="n">car</span>
<span class="w">        </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">model</span>
<span class="w">        </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">weight</span><span class="w">              </span><span class="c">!（千克）</span>
<span class="w">        </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dimensions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">       </span><span class="c">! 即，长度-宽度-高度（米）</span>
<span class="w">        </span><span class="kt">character</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">colour</span>
<span class="w">    </span><span class="k">contains</span>
<span class="k">        procedure</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">info</span><span class="w">           </span><span class="c">! 将过程绑定到类型</span>
<span class="w">    </span><span class="k">end type </span><span class="n">car</span>

<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">car</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mycar</span><span class="w">              </span><span class="c">! 声明自定义类型的变量</span>
<span class="w">    </span><span class="c">! 请查看 create_mycar() 程序的用法</span>

<span class="w">    </span><span class="c">! 注意：模块中没有可以执行的语句</span>

<span class="k">contains</span>

<span class="k">    subroutine </span><span class="n">create_mycar</span><span class="p">(</span><span class="n">mycar</span><span class="p">)</span>
<span class="w">        </span><span class="c">! 演示派生数据类型的用法</span>
<span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="n">car</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mycar</span>

<span class="w">        </span><span class="c">! 使用 &#39;%&#39; 运算符访问类型元素</span>
<span class="w">        </span><span class="n">mycar</span><span class="p">%</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Ford Prefect&quot;</span>
<span class="w">        </span><span class="n">mycar</span><span class="p">%</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;r&#39;</span>
<span class="w">        </span><span class="n">mycar</span><span class="p">%</span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1400</span>
<span class="w">        </span><span class="n">mycar</span><span class="p">%</span><span class="n">dimensions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.0</span><span class="w">   </span><span class="c">! 默认索引从 1 开始！</span>
<span class="w">        </span><span class="n">mycar</span><span class="p">%</span><span class="n">dimensions</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.0</span>
<span class="w">        </span><span class="n">mycar</span><span class="p">%</span><span class="n">dimensions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.5</span>

<span class="w">    </span><span class="k">end subroutine </span><span class="n">create_mycar</span>

<span class="w">    </span><span class="k">subroutine </span><span class="n">info</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<span class="w">        </span><span class="k">class</span><span class="p">(</span><span class="n">car</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">self</span>
<span class="w">        </span><span class="c">! 使用 &#39;class&#39; 关键字将过程绑定到类型</span>

<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Model     : &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">model</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Colour    : &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">colour</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Weight    : &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">weight</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Dimensions: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">dimensions</span>

<span class="w">    </span><span class="k">end subroutine </span><span class="n">info</span>

<span class="w">    </span><span class="kt">real </span><span class="k">pure function </span><span class="n">real_abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">real_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">x</span>
<span class="w">        </span><span class="k">else</span>
<span class="k">            </span><span class="n">real_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>
<span class="w">        </span><span class="k">end if</span>

<span class="k">    end function </span><span class="n">real_abs</span>

<span class="w">    </span><span class="kt">real </span><span class="k">pure function </span><span class="n">complex_abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="w">        </span><span class="kt">complex</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">z</span>
<span class="w">        </span><span class="c">! 长行可以使用继续字符 &#39;&amp;&#39; 进行延续</span>

<span class="w">        </span><span class="n">complex_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="nb">aimag</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="w">    </span><span class="k">end function </span><span class="n">complex_abs</span>

<span class="k">end module </span><span class="n">fruity</span>
</pre></div>
<h3>更多资源</h3>
<p>了解更多的 Fortran 信息:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Fortran">wikipedia</a></li>
<li><a href="https://fortran-lang.org/">Fortran-lang Organization</a></li>
<li><a href="https://en.wikipedia.org/wiki/Fortran_95_language_features">Fortran_95_language_features</a></li>
<li><a href="http://fortranwiki.org">fortranwiki.org</a></li>
<li><a href="http://www.fortran90.org">www.fortran90.org/</a></li>
<li><a href="http://www.dmoz.org/Computers/Programming/Languages/Fortran/FAQs%2C_Help%2C_and_Tutorials/Fortran_90_and_95/">list of Fortran 95 tutorials</a></li>
<li><a href="https://en.wikibooks.org/wiki/Fortran">Fortran wikibook</a></li>
<li><a href="http://www.fortranplus.co.uk/resources/fortran_resources.pdf">Fortran resources</a></li>
<li><a href="http://www.cs.rpi.edu/~szymansk/OOF90/bugs.html">Mistakes in Fortran 90 Programs That Might Surprise You</a></li>
</ul>

        <hr>
        <p>
          有建议？或者发现什么错误？在GitHub上<a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">开一个issue</a>，或者发起<a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/zh-cn/fortran.md">pull request</a>！
        </p>
        <p class="contributed">
          原著Robert Steed，并由<a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/zh-cn/fortran.md">1个好心人</a>修改。
        </p>

        <footer>
          <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0; width: 80px; height: 28px; padding-bottom: 5px;" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-sa.svg" /></a>
          <p>
            &copy; 2025
            <a href="https://github.com/robochat">Robert Steed</a>
          </p>
        </footer>
      </div>
    </div>
  </body>
</html>