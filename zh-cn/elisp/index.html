<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WXC8R75DEN');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Language" content="zh-CN">
    <title>Learn Emacs Lisp in Y Minutes</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto+Slab:wght@100..900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/screen.css">
    <link rel="stylesheet" href="/css/light.css">
    <link rel="stylesheet" href="/css/dark.css">

    <link rel="canonical" href="https://learnxinyminutes.com/zh-cn/elisp/">
    <script>
      localStorage.removeItem("lxiym_theme");
    </script>
  </head>
  <body>
    <div class="container">
      <div class="share">
        <span class="sharemsg">
          <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fzh-cn%2Felisp%2F&amp;text=Y%E5%88%86%E9%92%9F%E9%80%9F%E6%88%90X%2C+%E5%85%B6%E4%B8%AD+X%3DEmacs+Lisp">
            分享此页
          </a>
        </span>
        <span class='st_facebook_large' displayText='Facebook'></span>
        <span class='st_twitter_large' displayText='Tweet'></span>
      </div>
      <h1><a href="/">Y分钟速成X</a></h1>
      <h2>其中 X=Emacs Lisp</h2>
      <p class="filelink">
        源代码下载：
        <a href="/zh-cn/files/learn-emacs-lisp.el">learn-emacs-lisp.el</a>
      </p>
      <div id="doc">
<div class="highlight"><pre lang="scheme"><span class="c1">;; 15分钟学会Emacs Lisp (v0.2a)</span>
<span class="c1">;;（作者：bzg，https://github.com/bzg </span>
<span class="c1">;;  译者：lichenbo，http://douban.com/people/lichenbo）</span>
<span class="c1">;;</span>
<span class="c1">;; 请先阅读Peter Norvig的一篇好文:</span>
<span class="c1">;; http://norvig.com/21-days.html</span>
<span class="c1">;; （译者注：中文版请见http://blog.youxu.info/21-days/）</span>
<span class="c1">;;</span>
<span class="c1">;; 之后安装GNU Emacs 24.3:</span>
<span class="c1">;;</span>
<span class="c1">;; Debian: apt-get install emacs (视具体发行版而定)</span>
<span class="c1">;; MacOSX: http://emacsformacosx.com/emacs-builds/Emacs-24.3-universal-10.6.8.dmg</span>
<span class="c1">;; Windows: http://ftp.gnu.org/gnu/windows/emacs/emacs-24.3-bin-i386.zip</span>
<span class="c1">;;</span>
<span class="c1">;; 更多信息可以在这里找到:</span>
<span class="c1">;; http://www.gnu.org/software/emacs/#Obtaining</span>
<span class="w"> </span>
<span class="c1">;; 很重要的警告:</span>
<span class="c1">;;</span>
<span class="c1">;; 按照这个教程来学习并不会对你的电脑有任何损坏</span>
<span class="c1">;; 除非你自己在学习的过程中愤怒地把它砸了</span>
<span class="c1">;; 如果出现了这种情况，我不会承担任何责任</span>
<span class="c1">;;</span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; </span>
<span class="c1">;; 打开emacs</span>
<span class="c1">;;</span>
<span class="c1">;; 按&#39;q&#39;消除欢迎界面</span>
<span class="c1">;;</span>
<span class="c1">;; 现在请注意窗口底部的那一个灰色长条</span>
<span class="c1">;;</span>
<span class="c1">;; &quot;*scratch*&quot; 是你现在编辑界面的名字。</span>
<span class="c1">;; 这个编辑界面叫做一个&quot;buffer&quot;。</span>
<span class="c1">;;</span>
<span class="c1">;; 每当你打开Emacs时，都会默认打开这个scratch buffer</span>
<span class="c1">;; 此时你并没有在编辑任何文件，而是在编辑一个buffer</span>
<span class="c1">;; 之后你可以将这个buffer保存到一个文件中。</span>
<span class="c1">;; </span>
<span class="c1">;; 之后的&quot;Lisp interaction&quot; 则是表明我们可以用的某组命令</span>
<span class="c1">;; </span>
<span class="c1">;; Emacs在每个buffer中都有一组内置的命令</span>
<span class="c1">;; 而当你激活某种特定的模式时，就可以使用相应的命令</span>
<span class="c1">;; 这里我们使用`lisp-interaction-mode&#39;，</span>
<span class="c1">;; 这样我们就可以使用内置的Emacs Lisp（以下简称Elisp）命令了。</span>
<span class="w"> </span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;;</span>
<span class="c1">;; 分号是注释开始的标志</span>
<span class="c1">;;</span>
<span class="c1">;; Elisp 是由符号表达式构成的 (即&quot;s-表达式&quot;或&quot;s式&quot;):</span>
<span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 这个s式的意思是 &quot;对2进行加2操作&quot;.</span>
<span class="w"> </span>
<span class="c1">;; s式周围有括号，而且也可以嵌套:</span>
<span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w"> </span>
<span class="c1">;; 一个s式可以包含原子符号或者其他s式</span>
<span class="c1">;; 在上面的例子中，1和2是原子符号</span>
<span class="c1">;; (+ 2 (+ 1 1)) 和 (+ 1 1) 是s式.</span>
<span class="w"> </span>
<span class="c1">;; 在 `lisp-interaction-mode&#39; 中你可以计算s式.</span>
<span class="c1">;; 把光标移到闭括号后，之后按下ctrl+j（以后简写为&#39;C-j&#39;）</span>
<span class="w"> </span>
<span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span>
<span class="c1">;;           ^ 光标放到这里</span>
<span class="c1">;; 按下`C-j&#39; 就会输出 6</span>
<span class="w"> </span>
<span class="c1">;; `C-j&#39; 会在buffer中插入当前运算的结果</span>
<span class="w"> </span>
<span class="c1">;; 而`C-xC-e&#39; 则会在emacs最底部显示结果，也就是被称作&quot;echo area&quot;的区域</span>
<span class="c1">;; 为了避免把我们的buffer填满无用的结果，我们以后会一直用`C-xC-e&#39;</span>
<span class="w"> </span>
<span class="c1">;; `setq&#39; 可以将一个值赋给一个变量</span>
<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">my-name</span><span class="w"> </span><span class="s">&quot;Bastien&quot;</span><span class="p">)</span>
<span class="c1">;; `C-xC-e&#39; 输出 &quot;Bastien&quot; (在 echo area 中显示)</span>
<span class="w"> </span>
<span class="c1">;; `insert&#39; 会在光标处插入字符串:</span>
<span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="s">&quot;Hello!&quot;</span><span class="p">)</span>
<span class="c1">;; `C-xC-e&#39; 输出 &quot;Hello!&quot;</span>
<span class="w"> </span>
<span class="c1">;; 在这里我们只传给了insert一个参数&quot;Hello!&quot;, 但是</span>
<span class="c1">;; 我们也可以传给它更多的参数，比如2个：</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="s">&quot;Hello&quot;</span><span class="w"> </span><span class="s">&quot; world!&quot;</span><span class="p">)</span>
<span class="c1">;; `C-xC-e&#39; 输出 &quot;Hello world!&quot;</span>
<span class="w"> </span>
<span class="c1">;; 你也可以用变量名来代替字符串</span>
<span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="s">&quot;Hello, I am &quot;</span><span class="w"> </span><span class="nv">my-name</span><span class="p">)</span>
<span class="c1">;; `C-xC-e&#39; 输出 &quot;Hello, I am Bastien&quot;</span>
<span class="w"> </span>
<span class="c1">;; 你可以把s式嵌入函数中</span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">hello</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="s">&quot;Hello, I am &quot;</span><span class="w"> </span><span class="nv">my-name</span><span class="p">))</span>
<span class="c1">;; `C-xC-e&#39; 输出 hello</span>
<span class="w"> </span>
<span class="c1">;; 现在执行这个函数</span>
<span class="p">(</span><span class="nf">hello</span><span class="p">)</span>
<span class="c1">;; `C-xC-e&#39; 输出 Hello, I am Bastien</span>
<span class="w"> </span>
<span class="c1">;; 函数中空括号的意思是我们不需要接受任何参数</span>
<span class="c1">;; 但是我们不能一直总是用my-name这个变量</span>
<span class="c1">;; 所以我们现在使我们的函数接受一个叫做&quot;name&quot;的参数 </span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">hello</span><span class="w"> </span><span class="p">(</span><span class="nf">name</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="s">&quot;Hello &quot;</span><span class="w"> </span><span class="nv">name</span><span class="p">))</span>
<span class="c1">;; `C-xC-e&#39; 输出 hello</span>
<span class="w"> </span>
<span class="c1">;; 现在我们调用这个函数，并且将&quot;you&quot;作为参数传递</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">hello</span><span class="w"> </span><span class="s">&quot;you&quot;</span><span class="p">)</span>
<span class="c1">;; `C-xC-e&#39; 输出 &quot;Hello you&quot;</span>
<span class="w"> </span>
<span class="c1">;; 成功！</span>
<span class="w"> </span>
<span class="c1">;; 现在我们可以休息一下</span>
<span class="w"> </span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;;</span>
<span class="c1">;; 下面我们在新的窗口中新建一个名为 &quot;*test*&quot; 的buffer:</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">switch-to-buffer-other-window</span><span class="w"> </span><span class="s">&quot;*test*&quot;</span><span class="p">)</span>
<span class="c1">;; `C-xC-e&#39; 这时屏幕上会显示两个窗口，而光标此时位于*test* buffer内</span>
<span class="w"> </span>
<span class="c1">;; 用鼠标单击上面的buffer就会使光标移回。</span>
<span class="c1">;; 或者你可以使用 `C-xo&#39; 使得光标跳到另一个窗口中</span>
<span class="w"> </span>
<span class="c1">;; 你可以用 `progn&#39;命令将s式结合起来:</span>
<span class="p">(</span><span class="nf">progn</span>
<span class="w">  </span><span class="p">(</span><span class="nf">switch-to-buffer-other-window</span><span class="w"> </span><span class="s">&quot;*test*&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">hello</span><span class="w"> </span><span class="s">&quot;you&quot;</span><span class="p">))</span>
<span class="c1">;; `C-xC-e&#39; 此时屏幕分为两个窗口，并且在*test* buffer中显示&quot;Hello you&quot;</span>
<span class="w"> </span>
<span class="c1">;; 现在为了简洁，我们需要在每个s式后面都使用`C-xC-e&#39;来执行，后面就不再说明了</span>
<span class="w"> </span>
<span class="c1">;; 记得可以用过鼠标或者`C-xo&#39;回到*scratch*这个buffer。</span>
<span class="w"> </span>
<span class="c1">;; 清除当前buffer也是常用操作之一：</span>
<span class="p">(</span><span class="nf">progn</span>
<span class="w">  </span><span class="p">(</span><span class="nf">switch-to-buffer-other-window</span><span class="w"> </span><span class="s">&quot;*test*&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">erase-buffer</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">hello</span><span class="w"> </span><span class="s">&quot;there&quot;</span><span class="p">))</span>
<span class="w"> </span>
<span class="c1">;; 也可以回到其他的窗口中</span>
<span class="p">(</span><span class="nf">progn</span>
<span class="w">  </span><span class="p">(</span><span class="nf">switch-to-buffer-other-window</span><span class="w"> </span><span class="s">&quot;*test*&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">erase-buffer</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">hello</span><span class="w"> </span><span class="s">&quot;you&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">other-window</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w"> </span>
<span class="c1">;; 你可以用 `let&#39; 将一个值和一个局部变量绑定:</span>
<span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">local-name</span><span class="w"> </span><span class="s">&quot;you&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">switch-to-buffer-other-window</span><span class="w"> </span><span class="s">&quot;*test*&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">erase-buffer</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">hello</span><span class="w"> </span><span class="nv">local-name</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">other-window</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w"> </span>
<span class="c1">;; 这里我们就不需要使用 `progn&#39; 了， 因为 `let&#39; 也可以将很多s式组合起来。</span>
<span class="w"> </span>
<span class="c1">;; 格式化字符串的方法：</span>
<span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s">&quot;Hello %s!</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&quot;visitor&quot;</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; %s 是字符串占位符，这里被&quot;visitor&quot;替代.</span>
<span class="c1">;; \n 是换行符。</span>
<span class="w"> </span>
<span class="c1">;; 现在我们用格式化的方法再重写一下我们的函数:</span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">hello</span><span class="w"> </span><span class="p">(</span><span class="nf">name</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s">&quot;Hello %s!</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="nv">name</span><span class="p">)))</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">hello</span><span class="w"> </span><span class="s">&quot;you&quot;</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 我们再用`let&#39;新建另一个函数:</span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">greeting</span><span class="w"> </span><span class="p">(</span><span class="nf">name</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">your-name</span><span class="w"> </span><span class="s">&quot;Bastien&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s">&quot;Hello %s!</span><span class="se">\n\n</span><span class="s">I am %s.&quot;</span>
<span class="w">                    </span><span class="nv">name</span><span class="w">       </span><span class="c1">; the argument of the function</span>
<span class="w">                    </span><span class="nv">your-name</span><span class="w">  </span><span class="c1">; the let-bound variable &quot;Bastien&quot;</span>
<span class="w">                    </span><span class="p">))))</span>
<span class="w"> </span>
<span class="c1">;; 之后执行:</span>
<span class="p">(</span><span class="nf">greeting</span><span class="w"> </span><span class="s">&quot;you&quot;</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 有些函数可以和用户交互:</span>
<span class="p">(</span><span class="nf">read-from-minibuffer</span><span class="w"> </span><span class="s">&quot;Enter your name: &quot;</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 这个函数会返回在执行时用户输入的信息</span>
<span class="w"> </span>
<span class="c1">;; 现在我们让`greeting&#39;函数显示你的名字:</span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">greeting</span><span class="w"> </span><span class="p">(</span><span class="nf">from-name</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">your-name</span><span class="w"> </span><span class="p">(</span><span class="nf">read-from-minibuffer</span><span class="w"> </span><span class="s">&quot;Enter your name: &quot;</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s">&quot;Hello!</span><span class="se">\n\n</span><span class="s">I am %s and you are %s.&quot;</span>
<span class="w">                    </span><span class="nv">from-name</span><span class="w"> </span><span class="c1">; the argument of the function</span>
<span class="w">                    </span><span class="nv">your-name</span><span class="w"> </span><span class="c1">; the let-bound var, entered at prompt</span>
<span class="w">                    </span><span class="p">))))</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">greeting</span><span class="w"> </span><span class="s">&quot;Bastien&quot;</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 我们让结果在另一个窗口中显示:</span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">greeting</span><span class="w"> </span><span class="p">(</span><span class="nf">from-name</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">your-name</span><span class="w"> </span><span class="p">(</span><span class="nf">read-from-minibuffer</span><span class="w"> </span><span class="s">&quot;Enter your name: &quot;</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">switch-to-buffer-other-window</span><span class="w"> </span><span class="s">&quot;*test*&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">erase-buffer</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s">&quot;Hello %s!</span><span class="se">\n\n</span><span class="s">I am %s.&quot;</span><span class="w"> </span><span class="nv">your-name</span><span class="w"> </span><span class="nv">from-name</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">other-window</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span>
<span class="w"> </span>
<span class="c1">;; 测试一下：</span>
<span class="p">(</span><span class="nf">greeting</span><span class="w"> </span><span class="s">&quot;Bastien&quot;</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 第二节结束，休息一下吧。</span>
<span class="w"> </span>
<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;;</span>
<span class="c1">;; 我们将一些名字存到列表中：</span>
<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">list-of-names</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;Sarah&quot;</span><span class="w"> </span><span class="s">&quot;Chloe&quot;</span><span class="w"> </span><span class="s">&quot;Mathilde&quot;</span><span class="p">))</span>
<span class="w"> </span>
<span class="c1">;; 用 `car&#39;来取得第一个名字：</span>
<span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">list-of-names</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 用 `cdr&#39;取得剩下的名字:</span>
<span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">list-of-names</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 用 `push&#39;把名字添加到列表的开头:</span>
<span class="p">(</span><span class="nf">push</span><span class="w"> </span><span class="s">&quot;Stephanie&quot;</span><span class="w"> </span><span class="nv">list-of-names</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 注意: `car&#39; 和 `cdr&#39; 并不修改列表本身, 但是 `push&#39; 却会对列表本身进行操作.</span>
<span class="c1">;; 这个区别是很重要的: 有些函数没有任何副作用（比如`car&#39;）</span>
<span class="c1">;; 但还有一些却是有的 (比如 `push&#39;).</span>
<span class="w"> </span>
<span class="c1">;; 我们来对`list-of-names&#39;列表中的每一个元素都使用hello函数:</span>
<span class="p">(</span><span class="nf">mapcar</span><span class="w"> </span><span class="ss">&#39;hello</span><span class="w"> </span><span class="nv">list-of-names</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 将 `greeting&#39; 改进，使的我们能够对`list-of-names&#39;中的所有名字执行:</span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">greeting</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="nf">switch-to-buffer-other-window</span><span class="w"> </span><span class="s">&quot;*test*&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">erase-buffer</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">mapcar</span><span class="w"> </span><span class="ss">&#39;hello</span><span class="w"> </span><span class="nv">list-of-names</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">other-window</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">greeting</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 记得我们之前定义的 `hello&#39; 函数吗？ 这个函数接受一个参数，名字。</span>
<span class="c1">;; `mapcar&#39; 调用 `hello&#39;, 并将`list-of-names&#39;作为参数先后传给`hello&#39;</span>
<span class="w"> </span>
<span class="c1">;; 现在我们对显示的buffer中的内容进行一些更改：</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">replace-hello-by-bonjour</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="nf">switch-to-buffer-other-window</span><span class="w"> </span><span class="s">&quot;*test*&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">goto-char</span><span class="w"> </span><span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nf">search-forward</span><span class="w"> </span><span class="s">&quot;Hello&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nf">replace-match</span><span class="w"> </span><span class="s">&quot;Bonjour&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">other-window</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w"> </span>
<span class="c1">;; (goto-char (point-min)) 将光标移到buffer的开始</span>
<span class="c1">;; (search-forward &quot;Hello&quot;) 查找字符串&quot;Hello&quot;</span>
<span class="c1">;; (while x y) 当x返回某个值时执行y这个s式</span>
<span class="c1">;; 当x返回`nil&#39; (空), 退出循环</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">replace-hello-by-bonjour</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 你会看到所有在*test* buffer中出现的&quot;Hello&quot;字样都被换成了&quot;Bonjour&quot;</span>
<span class="w"> </span>
<span class="c1">;; 你也会得到以下错误提示: &quot;Search failed: Hello&quot;.</span>
<span class="c1">;;</span>
<span class="c1">;; 如果要避免这个错误, 你需要告诉 `search-forward&#39; 这个命令是否在</span>
<span class="c1">;; buffer的某个地方停止查找, 并且在什么都没找到时是否应该不给出错误提示</span>
<span class="w"> </span>
<span class="c1">;; (search-forward &quot;Hello&quot; nil t) 可以达到这个要求:</span>
<span class="w"> </span>
<span class="c1">;; `nil&#39; 参数的意思是 : 查找并不限于某个范围内</span>
<span class="c1">;; `t&#39; 参数的意思是: 当什么都没找到时，不给出错误提示</span>
<span class="w"> </span>
<span class="c1">;; 在下面的函数中，我们用到了s式，并且不给出任何错误提示:</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">hello-to-bonjour</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="nf">switch-to-buffer-other-window</span><span class="w"> </span><span class="s">&quot;*test*&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">erase-buffer</span><span class="p">)</span>
<span class="w">    </span><span class="c1">;; 为`list-of-names&#39;中的每个名字调用hello</span>
<span class="w">    </span><span class="p">(</span><span class="nf">mapcar</span><span class="w"> </span><span class="ss">&#39;hello</span><span class="w"> </span><span class="nv">list-of-names</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">goto-char</span><span class="w"> </span><span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
<span class="w">    </span><span class="c1">;; 将&quot;Hello&quot; 替换为&quot;Bonjour&quot;</span>
<span class="w">    </span><span class="p">(</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nf">search-forward</span><span class="w"> </span><span class="s">&quot;Hello&quot;</span><span class="w"> </span><span class="nv">nil</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nf">replace-match</span><span class="w"> </span><span class="s">&quot;Bonjour&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">other-window</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">hello-to-bonjour</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; 给这些名字加粗:</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">boldify-names</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="nf">switch-to-buffer-other-window</span><span class="w"> </span><span class="s">&quot;*test*&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">goto-char</span><span class="w"> </span><span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nf">re-search-forward</span><span class="w"> </span><span class="s">&quot;Bonjour </span><span class="se">\\</span><span class="s">(.+</span><span class="se">\\</span><span class="s">)!&quot;</span><span class="w"> </span><span class="nv">nil</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nf">add-text-properties</span><span class="w"> </span><span class="p">(</span><span class="nf">match-beginning</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                           </span><span class="p">(</span><span class="nf">match-end</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                           </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="ss">&#39;face</span><span class="w"> </span><span class="ss">&#39;bold</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">other-window</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w"> </span>
<span class="c1">;; 这个函数使用了 `re-search-forward&#39;:</span>
<span class="c1">;; 和查找一个字符串不同，你用这个命令可以查找一个模式，即正则表达式</span>
<span class="w"> </span>
<span class="c1">;; 正则表达式 &quot;Bonjour \\(.+\\)!&quot; 的意思是:</span>
<span class="c1">;; 字符串 &quot;Bonjour &quot;, 之后跟着</span>
<span class="c1">;; 一组           |  \\( ... \\) 结构</span>
<span class="c1">;; 任意字符       |  . 的含义</span>
<span class="c1">;; 有可能重复的   |  + 的含义</span>
<span class="c1">;; 之后跟着 &quot;!&quot; 这个字符串</span>
<span class="w"> </span>
<span class="c1">;; 准备好了？试试看。</span>
<span class="w"> </span>
<span class="p">(</span><span class="nf">boldify-names</span><span class="p">)</span>
<span class="w"> </span>
<span class="c1">;; `add-text-properties&#39; 可以添加文字属性, 比如文字样式</span>
<span class="w"> </span>
<span class="c1">;; 好的，我们成功了！</span>
<span class="w"> </span>
<span class="c1">;; 如果你想对一个变量或者函数有更多的了解：</span>
<span class="c1">;;</span>
<span class="c1">;; C-h v 变量 回车</span>
<span class="c1">;; C-h f 函数 回车</span>
<span class="c1">;;</span>
<span class="c1">;; 阅读Emacs Lisp官方文档:</span>
<span class="c1">;;</span>
<span class="c1">;; C-h i m elisp 回车</span>
<span class="c1">;;</span>
<span class="c1">;; 在线阅读Emacs Lisp文档:</span>
<span class="c1">;; https://www.gnu.org/software/emacs/manual/html_node/eintr/index.html</span>
<span class="w"> </span>
<span class="c1">;; 感谢以下同学的建议和反馈:</span>
<span class="c1">;; - Wes Hardaker</span>
<span class="c1">;; - notbob</span>
<span class="c1">;; - Kevin Montuori</span>
<span class="c1">;; - Arne Babenhauserheide</span>
<span class="c1">;; - Alan Schmitt</span>
<span class="c1">;; - spacegoing</span>
</pre></div>

        <hr>
        <p>
          有建议？或者发现什么错误？在GitHub上<a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">开一个issue</a>，或者发起<a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/zh-cn/elisp.md">pull request</a>！
        </p>
        <p class="contributed">
          原著Bastien Guerry，并由<a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/zh-cn/elisp.md">1个好心人</a>修改。
        </p>

        <footer>
          <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0; width: 88px; height: 31px;" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-sa.svg" /></a>
          <p>
            &copy; 2025
            <a href="http://bzg.fr">Bastien Guerry</a>
          </p>
        </footer>
      </div>
    </div>
  </body>
</html>