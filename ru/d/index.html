<!DOCTYPE html>
<html lang="ru">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WXC8R75DEN');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Language" content="ru">
    <title>Learn D in Y Minutes</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto+Slab:wght@100..900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/screen.css">
    <link rel="stylesheet" href="/css/light.css">
    <link rel="stylesheet" href="/css/dark.css">

    <link rel="canonical" href="https://learnxinyminutes.com/ru/d/">
    <script>
      localStorage.removeItem("lxiym_theme");
    </script>
  </head>
  <body>
    <div class="container">
      <div class="share">
        <span class="sharemsg">
          <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fru%2Fd%2F&amp;text=%D0%98%D0%B7%D1%83%D1%87%D0%B8%D1%82%D0%B5+X+%D0%B7%D0%B0+Y+%D0%BC%D0%B8%D0%BD%D1%83%D1%82%2C+%D0%B3%D0%B4%D0%B5+X%3DD">
            Поделиться страницей
          </a>
        </span>
        <span class='st_facebook_large' displayText='Facebook'></span>
        <span class='st_twitter_large' displayText='Tweet'></span>
      </div>
      <h1><a href="/">Изучите X за Y минут</a></h1>
      <h2>Где X=D</h2>
      <p class="filelink">
        Получить исходный код:
        <a href="/ru/files/learnd.d">learnd.d</a>
      </p>
      <div id="doc">
<p>D - современный компилируемый язык общего назначения с Си-подобным синтаксисом,
который сочетает удобство, продуманный дизайн и высокую производительность.
D - это С++, сделанный правильно.</p>
<div class="highlight"><pre lang="d"><span class="c1">// Welcome to D! Это однострочный комментарий</span>

<span class="cm">/* многострочный</span>
<span class="cm">   комментарий  */</span>

<span class="cm">/+</span>
<span class="cm">    // вложенные комментарии</span>

<span class="cm">    /* еще вложенные</span>
<span class="cm">       комментарии */</span>

<span class="cm">    /+</span>
<span class="cm">        // мало уровней вложенности? Их может быть сколько угодно.</span>
<span class="cm">    +/</span>
<span class="cm">+/</span>

<span class="cm">/*</span>
<span class="cm">    Имя модуля. Каждый файл с исходным кодом на D — модуль.</span>
<span class="cm">    Если имя не указано явно, то предполагается, что оно совпадает с именем</span>
<span class="cm">    файла. Например, для файла &quot;test.d&quot; имя модуля будет &quot;test&quot;, если явно</span>
<span class="cm">    не указать другое</span>
<span class="cm"> */</span>
<span class="k">module</span><span class="w"> </span><span class="n">app</span><span class="p">;</span>

<span class="c1">// импорт модуля. Std — пространство имен стандартной библиотеки (Phobos)</span>
<span class="k">import</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="c1">// можно импортировать только нужные части, не обязательно модуль целиком</span>
<span class="k">import</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">exception</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">enforce</span><span class="p">;</span>

<span class="c1">// точка входа в программу — функция main, аналогично C/C++</span>
<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="s">&quot;Hello, world!&quot;</span><span class="p">);</span>
<span class="p">}</span>



<span class="cm">/*** типы и переменные ***/</span>

<span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="c1">// объявление переменной типа int (32 бита)</span>
<span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">12.34</span><span class="p">;</span><span class="w"> </span><span class="c1">// тип с плавающей точкой</span>
<span class="kt">double</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">56.78</span><span class="p">;</span><span class="w"> </span><span class="c1">// тип с плавающей точкой (64 бита)</span>

<span class="cm">/*</span>
<span class="cm">    Численные типы в D, за исключением типов с плавающей точкой и типов</span>
<span class="cm">    комплексных чисел, могут быть беззнаковыми.</span>
<span class="cm">    В этом случае название типа начинается с префикса &quot;u&quot;</span>
<span class="cm">*/</span>
<span class="kt">uint</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="kt">ulong</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">11</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"> </span><span class="c1">// логический тип</span>
<span class="kt">char</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="sc">&#39;d&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// UTF-символ, 8 бит. D поддерживает UTF &quot;из коробки&quot;</span>
<span class="kt">wchar</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="sc">&#39;é&#39;</span><span class="p">;</span><span class="w">   </span><span class="c1">// символ UTF-16</span>
<span class="kt">dchar</span><span class="w"> </span><span class="n">f</span><span class="p">;</span><span class="w">       </span><span class="c1">// и даже UTF-32, если он вам зачем-то понадобится</span>

<span class="nb">string</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;для строк есть отдельный тип, это не просто массив char-ов из Си&quot;</span><span class="p">;</span>
<span class="nb">wstring</span><span class="w"> </span><span class="n">ws</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;поскольку у нас есть wchar, должен быть и  wstring&quot;</span><span class="p">;</span>
<span class="nb">dstring</span><span class="w"> </span><span class="n">ds</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;...и dstring, конечно&quot;</span><span class="p">;</span>

<span class="nb">string</span><span class="w"> </span><span class="err">кириллица</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Имена переменных должны быть в Unicode, но не обязательно на латинице.&quot;</span><span class="p">;</span>

<span class="k">typeof</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="c1">// typeof возвращает тип своего выражения.</span>
<span class="w">                 </span><span class="c1">// В результате, b имеет такой же тип, как и a</span>

<span class="c1">// Тип переменной, помеченной ключевым словом auto,</span>
<span class="c1">// присваивается компилятором исходя из значения этой переменной</span>
<span class="k">auto</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">              </span><span class="c1">// Например, тип этой переменной будет int.</span>
<span class="k">auto</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1.1</span><span class="p">;</span><span class="w">            </span><span class="c1">// этой — double</span>
<span class="k">auto</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Zed is dead!&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// а этой — string</span>

<span class="kt">int</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">];</span><span class="w"> </span><span class="c1">// простой одномерный массив с фиксированным размером</span>
<span class="kt">int</span><span class="p">[]</span><span class="w"> </span><span class="n">arr2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">];</span><span class="w"> </span><span class="c1">// динамический массив</span>
<span class="kt">int</span><span class="p">[</span><span class="nb">string</span><span class="p">]</span><span class="w"> </span><span class="n">aa</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;key1&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;key2&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">];</span><span class="w"> </span><span class="c1">// ассоциативный массив</span>

<span class="cm">/*</span>
<span class="cm">   Строки и массивы в D — встроенные типы. Для их использования не нужно</span>
<span class="cm">   подключать ни внешние, ни даже стандартную библиотеку, хотя в последней</span>
<span class="cm">   есть множество дополнительных инструментов для работы с ними.</span>
<span class="cm"> */</span>
<span class="k">immutable</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ia</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">  </span><span class="c1">// неизменяемый тип,</span>
<span class="w">                        </span><span class="c1">// обозначается ключевым словом immutable</span>
<span class="n">ia</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">                </span><span class="c1">// — вызовет ошибку на этапе компиляции</span>

<span class="c1">// перечислимый (enumerable) тип,</span>
<span class="c1">// более правильный способ работы с константами в D</span>
<span class="k">enum</span><span class="w"> </span><span class="n">myConsts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Const1</span><span class="p">,</span><span class="w"> </span><span class="n">Const2</span><span class="p">,</span><span class="w"> </span><span class="n">Const3</span><span class="w"> </span><span class="p">};</span>

<span class="c1">// свойства типов</span>
<span class="n">writeln</span><span class="p">(</span><span class="s">&quot;Имя типа               : &quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">stringof</span><span class="p">);</span><span class="w"> </span><span class="c1">// int</span>
<span class="n">writeln</span><span class="p">(</span><span class="s">&quot;Размер в байтах        : &quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">sizeof</span><span class="p">);</span><span class="w">   </span><span class="c1">// 4</span>
<span class="n">writeln</span><span class="p">(</span><span class="s">&quot;Минимальное значение   : &quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">min</span><span class="p">);</span><span class="w">      </span><span class="c1">// -2147483648</span>
<span class="n">writeln</span><span class="p">(</span><span class="s">&quot;Максимальное значение : &quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">max</span><span class="p">);</span><span class="w">      </span><span class="c1">// 2147483647</span>
<span class="n">writeln</span><span class="p">(</span><span class="s">&quot;Начальное значение     : &quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">init</span><span class="p">);</span><span class="w">     </span><span class="c1">// 0. Это значение,</span>
<span class="w">                                                    </span><span class="c1">// присвоенное по умолчанию</span>

<span class="c1">// На самом деле типов в D больше, но все мы здесь описывать не будем,</span>
<span class="c1">// иначе не уложимся в Y минут.</span>



<span class="cm">/*** Приведение типов ***/</span>

<span class="c1">// to!(имя типа)(выражение) - для большинства конверсий</span>
<span class="k">import</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">conv</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">to</span><span class="p">;</span><span class="w"> </span><span class="c1">// функция &quot;to&quot; - часть стандартной библиотеки, а не языка</span>
<span class="kt">double</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">-</span><span class="mf">1.75</span><span class="p">;</span>
<span class="kt">short</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">to</span><span class="p">!</span><span class="kt">short</span><span class="p">(</span><span class="n">d</span><span class="p">);</span><span class="w"> </span><span class="c1">// s = -1</span>

<span class="cm">/*</span>
<span class="cm">   cast - если вы знаете, что делаете. Кроме того, это единственный способ</span>
<span class="cm">   преобразования типов-указателей в &quot;обычные&quot; и наоборот</span>
<span class="cm">*/</span>
<span class="kt">void</span><span class="p">*</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="kt">int</span><span class="p">*</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="kt">int</span><span class="p">*)</span><span class="n">v</span><span class="p">;</span>

<span class="c1">// Для собственного удобства можно создавать псевдонимы</span>
<span class="c1">// для различных встроенных объектов</span>
<span class="k">alias</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">newInt</span><span class="p">;</span><span class="w"> </span><span class="c1">// теперь можно обращаться к newInt так, как будто бы это int</span>
<span class="n">newInt</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>

<span class="k">alias</span><span class="w"> </span><span class="n">newInt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kt">int</span><span class="p">;</span><span class="w"> </span><span class="c1">// так тоже допустимо</span>
<span class="k">alias</span><span class="w"> </span><span class="kt">uint</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="n">pair</span><span class="p">;</span><span class="w"> </span><span class="c1">// дать псевдоним можно даже сложным структурам данных</span>



<span class="cm">/*** Операторы ***/</span>

<span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="c1">// присваивание</span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// 11</span>
<span class="n">x</span><span class="w"> </span><span class="p">-=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">     </span><span class="c1">// 9</span>
<span class="n">x</span><span class="p">++;</span><span class="w">        </span><span class="c1">// 10</span>
<span class="p">++</span><span class="n">x</span><span class="p">;</span><span class="w">        </span><span class="c1">// 11</span>
<span class="n">x</span><span class="w"> </span><span class="p">*=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">     </span><span class="c1">// 22</span>
<span class="n">x</span><span class="w"> </span><span class="p">/=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">     </span><span class="c1">// 11</span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">^^</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c1">// 121 (возведение в степень)</span>
<span class="n">x</span><span class="w"> </span><span class="p">^^=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">    </span><span class="c1">// 1331 (то же самое)</span>

<span class="nb">string</span><span class="w"> </span><span class="n">str1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Hello&quot;</span><span class="p">;</span>
<span class="nb">string</span><span class="w"> </span><span class="n">str2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;, world!&quot;</span><span class="p">;</span>
<span class="nb">string</span><span class="w"> </span><span class="n">hw</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">str1</span><span class="w"> </span><span class="p">~</span><span class="w"> </span><span class="n">str2</span><span class="p">;</span><span class="w"> </span><span class="c1">// Конкатенация строк</span>

<span class="kt">int</span><span class="p">[]</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">];</span>
<span class="n">arr</span><span class="w"> </span><span class="p">~=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="c1">// [1, 2, 3, 4] - добавление элемента в конец массива</span>



<span class="cm">/*** Логика и сравнения ***/</span>

<span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="n">x</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">         </span><span class="c1">// false</span>
<span class="n">x</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">          </span><span class="c1">// false</span>
<span class="n">x</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">          </span><span class="c1">// true</span>
<span class="n">x</span><span class="w"> </span><span class="p">&gt;=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">         </span><span class="c1">// false</span>
<span class="n">x</span><span class="w"> </span><span class="p">!=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">         </span><span class="c1">// true. ! — логическое &quot;не&quot;</span>
<span class="n">x</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// true. || — логическое &quot;или&quot;</span>
<span class="n">x</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">&amp;&amp;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// false &amp;&amp; — логическое &quot;и&quot;</span>
<span class="n">x</span><span class="w"> </span><span class="p">^</span><span class="w"> </span><span class="n">y</span><span class="w">           </span><span class="c1">// true; ^ - xor (исключающее &quot;или&quot;)</span>

<span class="c1">// Тернарный оператор</span>
<span class="k">auto</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// если x больше 10, то y равен 1,</span>
<span class="w">                           </span><span class="c1">// в противном случае y равен нулю</span>


<span class="cm">/***  Управляющие конструкции  ***/</span>

<span class="c1">// if - абсолютно привычен</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ..</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ..</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ..</span>
<span class="p">}</span>

<span class="c1">// switch</span>
<span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="w">        </span><span class="c1">// делаем что-нибудь</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">        </span><span class="c1">// делаем что-нибудь другое</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span>
<span class="w">        </span><span class="c1">// делаем что-нибудь еще</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">default</span><span class="p">:</span>
<span class="w">        </span><span class="c1">// default обязателен, без него будет ошибка компиляции</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// в D есть констукция &quot;final switch&quot;. Она не может содержать секцию &quot;defaul&quot;</span>
<span class="c1">// и применяется, когда все перечисляемые в switch варианты должны быть</span>
<span class="c1">// обработаны явным образом</span>

<span class="kt">int</span><span class="w"> </span><span class="n">dieValue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="k">final</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">dieValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="w">        </span><span class="n">writeln</span><span class="p">(</span><span class="s">&quot;You won&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">:</span>
<span class="w">        </span><span class="n">writeln</span><span class="p">(</span><span class="s">&quot;It&#39;s a draw&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">6</span><span class="p">:</span>
<span class="w">        </span><span class="n">writeln</span><span class="p">(</span><span class="s">&quot;I won&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// while</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ..</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">42</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// бесконечный цикл</span>
<span class="p">}</span>

<span class="c1">// do-while</span>
<span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ..</span>
<span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>

<span class="c1">// for</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">11</span><span class="p">;</span><span class="w"> </span><span class="p">++</span><span class="n">number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">number</span><span class="p">);</span><span class="w"> </span><span class="c1">// все абсолютно стандартно</span>
<span class="p">}</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// секции могут быть пустыми. Это бесконечный цикл в стиле Си</span>
<span class="p">}</span>

<span class="c1">// foreach - универсальный и самый &quot;правильный&quot; цикл в D</span>
<span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">element</span><span class="p">;</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">element</span><span class="p">);</span><span class="w"> </span><span class="c1">// для простых массивов</span>
<span class="p">}</span>

<span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">;</span><span class="w"> </span><span class="n">aa</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span><span class="w"> </span><span class="c1">// для ассоциативных массивов</span>
<span class="p">}</span>

<span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">;</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">c</span><span class="p">);</span><span class="w"> </span><span class="c1">// hello. Поскольку строки - это вариант массива,</span>
<span class="w">                </span><span class="c1">// foreach применим и к ним</span>
<span class="p">}</span>

<span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="p">;</span><span class="w"> </span><span class="mf">10..15</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">number</span><span class="p">);</span><span class="w"> </span><span class="c1">// численные интервалы можно указывать явным образом</span>
<span class="w">                     </span><span class="c1">// этот цикл выведет значения с 10 по 14, но не 15,</span>
<span class="w">                     </span><span class="c1">// поскольку диапазон не включает в себя верхнюю границу</span>
<span class="p">}</span>

<span class="c1">// foreach_reverse - в обратную сторону</span>
<span class="k">auto</span><span class="w"> </span><span class="n">container</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">];</span>
<span class="k">foreach_reverse</span><span class="w"> </span><span class="p">(</span><span class="n">element</span><span class="p">;</span><span class="w"> </span><span class="n">container</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">writefln</span><span class="p">(</span><span class="s">&quot;%s &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">element</span><span class="p">);</span><span class="w"> </span><span class="c1">// 3, 2, 1</span>
<span class="p">}</span>

<span class="c1">// foreach в массивах и им подобных структурах не меняет сами структуры</span>
<span class="kt">int</span><span class="p">[]</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="mi">3</span><span class="w"> </span><span class="p">,</span><span class="mi">4</span><span class="w"> </span><span class="p">,</span><span class="mi">5</span><span class="p">];</span>
<span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">elem</span><span class="p">;</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">elem</span><span class="w"> </span><span class="p">*=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c1">// сам массив останется неизменным</span>
<span class="p">}</span>

<span class="n">writeln</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1">// вывод: [1, 2, 3, 4, 5] Т.е изменений нет</span>

<span class="c1">// добавление ref приведет к тому, что массив будет изменяться</span>
<span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">elem</span><span class="p">;</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">elem</span><span class="w"> </span><span class="p">*=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">writeln</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1">// [2, 4, 6, 8, 10]</span>

<span class="c1">// foreach умеет рассчитывать индексы элементов</span>
<span class="kt">int</span><span class="p">[]</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">];</span>
<span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">;</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">);</span><span class="w"> </span><span class="c1">// через ind - доступен индекс элемента,</span>
<span class="w">                             </span><span class="c1">// а через elem - сам элемент</span>
<span class="p">}</span>



<span class="cm">/*** Функции ***/</span>

<span class="n">test</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span><span class="w"> </span><span class="c1">// Что, вот так сразу? Разве мы где-то уже объявили эту функцию?</span>

<span class="c1">// Нет, вот она. Это не Си, здесь объявление функции не обязательно должно быть</span>
<span class="c1">// до первого вызова</span>
<span class="kt">int</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argument</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>


<span class="c1">// В D используется единый синтаксис вызова функций</span>
<span class="c1">// (UFCS, Uniform Function Call Syntax), поэтому так тоже можно:</span>
<span class="kt">int</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">42.</span><span class="n">test</span><span class="p">();</span>

<span class="c1">// и даже так, если у функции нет аргументов:</span>
<span class="kt">int</span><span class="w"> </span><span class="n">var2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">42.</span><span class="n">test</span><span class="p">;</span>

<span class="c1">// можно выстраивать цепочки:</span>
<span class="kt">int</span><span class="w"> </span><span class="n">var3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">42.</span><span class="n">test</span><span class="p">.</span><span class="n">test</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm">    Аргументы в функцию передаются по значению (т.е. функция работает не с</span>
<span class="cm">    оригинальными значениями, переданными ей, а с их локальными копиями.</span>
<span class="cm">    Исключение составляют объекты классов, которые передаются по ссылке.</span>
<span class="cm">    Кроме того, любой параметр можно передать в функцию по ссылке с помощью</span>
<span class="cm">    ключевого слова &quot;ref&quot;</span>
<span class="cm">*/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">fn1</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">arg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">arg</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">fn2</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">arg</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">fn1</span><span class="p">(</span><span class="n">var</span><span class="p">);</span><span class="w"> </span><span class="c1">// var все еще = 10</span>
<span class="n">fn2</span><span class="p">(</span><span class="n">var</span><span class="p">);</span><span class="w"> </span><span class="c1">// теперь var = 11</span>

<span class="c1">// Возвращаемое значение тоже может быть auto,</span>
<span class="c1">// если его можно &quot;угадать&quot; из контекста</span>
<span class="k">auto</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">auto</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span><span class="w"> </span><span class="c1">// тип int - компилятор вывел его автоматически</span>

<span class="c1">// Значения аргументов по умолчанию</span>
<span class="kt">float</span><span class="w"> </span><span class="n">linearFunction</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">auto</span><span class="w"> </span><span class="n">linear1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">linearFunction</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"> </span><span class="c1">// все аргументы используются</span>
<span class="k">auto</span><span class="w"> </span><span class="n">linear2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">linearFunction</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w">    </span><span class="c1">// один аргумент пропущен, но в функции</span>
<span class="w">                                          </span><span class="c1">// он все равно использован и равен 1</span>

<span class="c1">// допускается описание вложенных функций</span>
<span class="kt">float</span><span class="w"> </span><span class="n">quarter</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">doubled</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">doubled</span><span class="p">(</span><span class="n">doubled</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">// функции с переменным числом аргументов</span>
<span class="kt">int</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span><span class="n">a</span><span class="p">...)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">elem</span><span class="p">;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">s</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">elem</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">auto</span><span class="w"> </span><span class="n">sum1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="k">auto</span><span class="w"> </span><span class="n">sum2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm">   модификатор &quot;in&quot; перед аргументами функций говорит о том, что функция имеет</span>
<span class="cm">    право их только просматривать. При попытке модификации такого аргумента</span>
<span class="cm">    внутри функции - получите ошибку</span>
<span class="cm">*/</span>
<span class="kt">float</span><span class="w"> </span><span class="n">printFloat</span><span class="p">(</span><span class="k">in</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">printFloat</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1">// использование таких функций - самое обычное</span>

<span class="c1">// модификатор &quot;out&quot; позволяет вернуть из функции несколько результатов</span>
<span class="c1">// без посредства глобальных переменных или массивов</span>
<span class="kt">uint</span><span class="w"> </span><span class="n">remMod</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="n">modulus</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="n">remainder</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="n">modulus</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">remainder</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">uint</span><span class="w"> </span><span class="n">modulus</span><span class="p">;</span><span class="w">                   </span><span class="c1">// пока в этой переменной ноль</span>
<span class="kt">uint</span><span class="w"> </span><span class="n">rem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">remMod</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">modulus</span><span class="p">);</span><span class="w"> </span><span class="c1">// наша &quot;хитрая&quot; функция, и теперь</span>
<span class="w">                                </span><span class="c1">// в modulus - остаток от деления</span>
<span class="n">writeln</span><span class="p">(</span><span class="n">rem</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">modulus</span><span class="p">);</span><span class="w">     </span><span class="c1">// вывод: 2 1</span>



<span class="cm">/*** Структуры, классы, базовое ООП ***/</span>

<span class="c1">// Объявление структуры. Структуры почти как в Си</span>
<span class="k">struct</span><span class="w"> </span><span class="n">MyStruct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">multiply</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">MyStruct</span><span class="w"> </span><span class="n">str1</span><span class="p">;</span><span class="w"> </span><span class="c1">// Объявление переменной с типом MyStruct</span>
<span class="n">str1</span><span class="p">.</span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">   </span><span class="c1">// Обращение к полю</span>
<span class="n">str1</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="k">auto</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">str1</span><span class="p">.</span><span class="n">multiply</span><span class="p">();</span>
<span class="n">MyStruct</span><span class="w"> </span><span class="n">str2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">}</span><span class="w">          </span><span class="c1">// Объявление + инициализация  в стиле Си</span>
<span class="k">auto</span><span class="w"> </span><span class="n">str3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MyStruct</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span><span class="w">    </span><span class="c1">// Объявление + инициализация  в стиле D</span>


<span class="c1">// области видимости полей и методов - 3 способа задания</span>
<span class="k">struct</span><span class="w"> </span><span class="n">MyStruct2</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>

<span class="w">    </span><span class="k">private</span><span class="p">:</span>
<span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>

<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">multiply</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">        в дополнение к знакомым public, private и protected, в D есть еще</span>
<span class="cm">        область видимости &quot;package&quot;. Поля и методы с этим атрибутом будут</span>
<span class="cm">        доступны изо всех модулей, включенных в &quot;пакет&quot; (package), но не</span>
<span class="cm">        за его пределами. package - это &quot;папка&quot;, в которой может храниться</span>
<span class="cm">        несколько модулей. Например, в &quot;import.std.stdio&quot;, &quot;std&quot; - это</span>
<span class="cm">        package, в котором есть модуль stdio (и еще множество других)</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">package</span><span class="p">:</span>
<span class="w">        </span><span class="nb">string</span><span class="w"> </span><span class="n">d</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* помимо этого, имеется еще один модификатор - export, который позволяет</span>
<span class="cm">    использовать объявленный с ним идентификатор даже вне самой программы !</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">export</span><span class="p">:</span>
<span class="w">         </span><span class="nb">string</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Конструкторы и деструкторы</span>
<span class="k">struct</span><span class="w"> </span><span class="n">MyStruct3</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// конструктор. Для структур его не обязательно указывать явно,</span>
<span class="w">             </span><span class="c1">// в этом случае пустой конструктор добавляется компилятором</span>
<span class="w">        </span><span class="n">writeln</span><span class="p">(</span><span class="s">&quot;Hello, world!&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>


<span class="w">    </span><span class="c1">// а вот это конструкция - одна из интересных идиом и представляет собой</span>
<span class="w">    </span><span class="c1">// конструктор копирования, т.е конструктор, возвращающий копию структуры.</span>
<span class="w">    </span><span class="c1">// Работает только в структурах.</span>
<span class="w">    </span><span class="k">this</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">~</span><span class="k">this</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// деструктор, также необязателен</span>
<span class="w">        </span><span class="n">writeln</span><span class="p">(</span><span class="s">&quot;Awww!&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Объявление простейшего класса</span>
<span class="k">class</span><span class="w"> </span><span class="n">MyClass</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w">  </span><span class="c1">// в D по умолчанию данные-члены являются public</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">auto</span><span class="w"> </span><span class="n">mc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MyClass</span><span class="p">();</span><span class="w"> </span><span class="c1">// ...и создание его экземпляра</span>
<span class="k">auto</span><span class="w"> </span><span class="n">mc2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MyClass</span><span class="p">;</span><span class="w"> </span><span class="c1">// ... тоже сработает</span>

<span class="c1">// Конструктор</span>
<span class="k">class</span><span class="w"> </span><span class="n">MyClass2</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>

<span class="w">    </span><span class="k">this</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="c1">// ключевое слово &quot;this&quot; - ссылка на объект класса</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">auto</span><span class="w"> </span><span class="n">mc2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MyClass2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2.3</span><span class="p">);</span>

<span class="c1">// Классы могут быть вложенными</span>
<span class="k">class</span><span class="w"> </span><span class="n">Outer</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>

<span class="w">    </span><span class="k">class</span><span class="w"> </span><span class="n">Inner</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">foo</span><span class="p">()</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="c1">// можно обращаться к полям &quot;внешнего&quot; класса</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// наследование</span>
<span class="k">class</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.34</span><span class="p">;</span>


<span class="w">    </span><span class="c1">// это статический метод, т.е метод который можно вызывать, обращаясь</span>
<span class="w">    </span><span class="c1">// к классу напрямую, а не через создание экземпляра объекта</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">multiply</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">writeln</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">Base</span><span class="p">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="c1">// используем статический метод. Результат: 10</span>

<span class="k">class</span><span class="w"> </span><span class="n">Derived</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">string</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Поле класса - наследника&quot;</span><span class="p">;</span>


<span class="w">    </span><span class="c1">// override означает то, что наследник предоставит свою реализацию метода,</span>
<span class="w">    </span><span class="c1">// переопределив метод базового класса</span>
<span class="w">    </span><span class="k">override</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">multiply</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span><span class="w">  </span><span class="c1">// super - это ссылка на класс-предок, или базовый класс</span>
<span class="w">        </span><span class="n">writeln</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">auto</span><span class="w"> </span><span class="n">mc3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Derived</span><span class="p">();</span>
<span class="n">writeln</span><span class="p">(</span><span class="n">mc3</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1">// 1</span>
<span class="n">writeln</span><span class="p">(</span><span class="n">mc3</span><span class="p">.</span><span class="n">b</span><span class="p">);</span><span class="w"> </span><span class="c1">// 2.34</span>
<span class="n">writeln</span><span class="p">(</span><span class="n">mc3</span><span class="p">.</span><span class="n">c</span><span class="p">);</span><span class="w"> </span><span class="c1">// Поле класса - наследника</span>

<span class="c1">// Финальный класс, наследовать от него нельзя</span>
<span class="c1">// кроме того, модификатор final работает не только для классов, но и для методов</span>
<span class="c1">// и даже для модулей !</span>
<span class="k">final</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">FC</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="n">Derived</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">FC</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// это вызовет ошибку</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Абстрактный класс не может быть истанциирован, но может иметь наследников</span>
<span class="k">abstract</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">AC</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">auto</span><span class="w"> </span><span class="n">ac</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AC</span><span class="p">();</span><span class="w"> </span><span class="c1">// это вызовет ошибку</span>

<span class="k">class</span><span class="w"> </span><span class="n">Implementation</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AC</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>

<span class="w">     </span><span class="c1">// final перед методом нефинального класса означает запрет возможности</span>
<span class="w">     </span><span class="c1">// переопределения метода</span>
<span class="w">    </span><span class="k">final</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">test</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="n">writeln</span><span class="p">(</span><span class="s">&quot;test passed !&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">auto</span><span class="w"> </span><span class="n">impl</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Implementation</span><span class="p">();</span><span class="w"> </span><span class="c1">// ОК</span>



<span class="cm">/*** Примеси (mixins) ***/</span>

<span class="c1">// В D можно вставлять код как строку, если эта строка известна на этапе</span>
<span class="c1">// компиляции. Например:</span>
<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">mixin</span><span class="p">(</span><span class="s">`writeln(&quot;Hello World!&quot;);`</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// еще пример</span>
<span class="nb">string</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="nb">string</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="s">`writeln(&quot;`</span><span class="w"> </span><span class="p">~</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">~</span><span class="w"> </span><span class="s">`&quot;);`</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">mixin</span><span class="w"> </span><span class="p">(</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;str1&quot;</span><span class="p">));</span>
<span class="w">   </span><span class="k">mixin</span><span class="w"> </span><span class="p">(</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;str2&quot;</span><span class="p">));</span>
<span class="p">}</span>



<span class="cm">/*** Шаблоны ***/</span>

<span class="cm">/*</span>
<span class="cm">    Шаблон функции. Эта функция принимает аргументы разных типов, которые</span>
<span class="cm">    подставляются вместо T на этапе компиляции. &quot;T&quot; - это не специальный</span>
<span class="cm">    символ, а просто буква. Вместо &quot;T&quot; может быть любое слово, кроме ключевого.</span>
<span class="cm"> */</span>
<span class="kt">void</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="n">T</span><span class="p">)(</span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">writefln</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">print</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span><span class="w">     </span><span class="c1">// В одну и ту же функцию передается: целое</span>
<span class="w">   </span><span class="n">print</span><span class="p">(</span><span class="mf">1.2</span><span class="p">);</span><span class="w">    </span><span class="c1">// ...число с плавающей точкой,</span>
<span class="w">   </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// ...строка</span>
<span class="p">}</span>

<span class="c1">// &quot;Шаблонных&quot; параметров может быть сколько угодно</span>
<span class="kt">void</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="w"> </span><span class="n">T2</span><span class="p">)(</span><span class="n">T1</span><span class="w"> </span><span class="n">value1</span><span class="p">,</span><span class="w"> </span><span class="n">T2</span><span class="w"> </span><span class="n">value2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">writefln</span><span class="p">(</span><span class="s">&quot; %s %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value1</span><span class="p">,</span><span class="w"> </span><span class="n">value2</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">print</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Test&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="n">print</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="w"> </span><span class="mi">33</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Шаблон класса</span>
<span class="k">class</span><span class="w"> </span><span class="n">Stack</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="p">:</span>
<span class="w">        </span><span class="n">T</span><span class="p">[]</span><span class="w"> </span><span class="n">elements</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="p">:</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="n">push</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">element</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">elements</span><span class="w"> </span><span class="p">~=</span><span class="w"> </span><span class="n">element</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="n">pop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="p">--</span><span class="n">elements</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">T</span><span class="w"> </span><span class="n">top</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="nd">@property</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">elements</span><span class="p">[$</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nb">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="nd">@property</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">elements</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">        восклицательный знак - признак шаблона. В данном случае мы создаем</span>
<span class="cm">        класс и указываем, что &quot;шаблонное&quot; поле будет иметь тип string</span>
<span class="cm">    */</span>
<span class="w">   </span><span class="k">auto</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Stack</span><span class="p">!</span><span class="nb">string</span><span class="p">;</span>

<span class="w">   </span><span class="n">stack</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="s">&quot;Test1&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="n">stack</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="s">&quot;Test2&quot;</span><span class="p">);</span>

<span class="w">   </span><span class="n">writeln</span><span class="p">(</span><span class="n">stack</span><span class="p">.</span><span class="n">top</span><span class="p">);</span>
<span class="w">   </span><span class="n">writeln</span><span class="p">(</span><span class="n">stack</span><span class="p">.</span><span class="n">length</span><span class="p">);</span>

<span class="w">   </span><span class="n">stack</span><span class="p">.</span><span class="n">pop</span><span class="p">;</span>
<span class="w">   </span><span class="n">writeln</span><span class="p">(</span><span class="n">stack</span><span class="p">.</span><span class="n">top</span><span class="p">);</span>
<span class="w">   </span><span class="n">writeln</span><span class="p">(</span><span class="n">stack</span><span class="p">.</span><span class="n">length</span><span class="p">);</span>
<span class="p">}</span>



<span class="cm">/*** Диапазоны (ranges) ***/</span>

<span class="cm">/*</span>
<span class="cm">   Диапазоны - это абстракция, которая позволяет легко использовать разные</span>
<span class="cm">   алгоритмы с разными структурами данных. Вместо того, чтобы определять свои</span>
<span class="cm">   уникальные алгоритмы для каждой структуры, мы можем просто указать для нее</span>
<span class="cm">   несколько единообразных функций, определяющих, _как_ мы получаем доступ</span>
<span class="cm">   к элементам контейнера, вместо того, чтобы описывать внутреннее устройство</span>
<span class="cm">   этого контейнера. Сложно? На самом деле не очень.</span>

<span class="cm">    Простейший вид диапазона - Input Range. Для того, чтобы превратить любой</span>
<span class="cm">    контейнер в Input Range, достаточно реализовать для него 3 метода:</span>
<span class="cm">    - empty - проверяет, пуст ли контейнер</span>
<span class="cm">    - front - дает доступ к первому элементу контейнера</span>
<span class="cm">    - popFront - удаляет из контейнера первый элемент</span>
<span class="cm">*/</span>
<span class="k">struct</span><span class="w"> </span><span class="n">Student</span>
<span class="p">{</span>
<span class="w">    </span><span class="nb">string</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">;</span>
<span class="w">    </span><span class="nb">string</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">format</span><span class="p">(</span><span class="s">&quot;%s(%s)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">number</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">struct</span><span class="w"> </span><span class="n">School</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Student</span><span class="p">[]</span><span class="w"> </span><span class="n">students</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span><span class="w"> </span><span class="n">StudentRange</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Student</span><span class="p">[]</span><span class="w"> </span><span class="n">students</span><span class="p">;</span>

<span class="w">    </span><span class="k">this</span><span class="p">(</span><span class="n">School</span><span class="w"> </span><span class="n">school</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">students</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">school</span><span class="p">.</span><span class="n">students</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">empty</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">students</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">Student</span><span class="w"> </span><span class="n">front</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">students</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">popFront</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">students</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">students</span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="p">..</span><span class="w"> </span><span class="p">$];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">(){</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">school</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">School</span><span class="p">([</span>
<span class="w">            </span><span class="n">Student</span><span class="p">(</span><span class="s">&quot;Mike&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">Student</span><span class="p">(</span><span class="s">&quot;John&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">,</span>
<span class="w">            </span><span class="n">Student</span><span class="p">(</span><span class="s">&quot;Dan&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="w">    </span><span class="p">]);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">StudentRange</span><span class="p">(</span><span class="n">school</span><span class="p">);</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">range</span><span class="p">);</span><span class="w">                     </span><span class="c1">// [Mike(1), John(2), Dan(3)]</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">school</span><span class="p">.</span><span class="n">students</span><span class="p">.</span><span class="n">length</span><span class="p">);</span><span class="w">    </span><span class="c1">// 3</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">range</span><span class="p">.</span><span class="n">front</span><span class="p">());</span><span class="w">             </span><span class="c1">// Mike(1)</span>
<span class="w">    </span><span class="n">range</span><span class="p">.</span><span class="n">popFront</span><span class="p">();</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">range</span><span class="p">.</span><span class="n">empty</span><span class="p">());</span><span class="w">             </span><span class="c1">// false</span>
<span class="w">    </span><span class="n">writeln</span><span class="p">(</span><span class="n">range</span><span class="p">);</span><span class="w">                     </span><span class="c1">// [John(2), Dan(3)]</span>
<span class="p">}</span>
<span class="cm">/*</span>
<span class="cm">   Смысл в том, что нам не так уж важно внутреннее устройство контейнера, если</span>
<span class="cm">   у нас есть унифицированные методы доступа к его элементам.</span>
<span class="cm">   Кроме Input Range в D есть и другие типы диапазонов, которые требуют</span>
<span class="cm">   реализации большего числа методов, зато дают больше контроля. Это большая</span>
<span class="cm">   тема и мы не будем в подробностях освещать ее здесь.</span>

<span class="cm">   Диапазоны - это важная часть D, они используются в нем повсеместно.</span>
<span class="cm">*/</span>
</pre></div>
<h2>Что дальше?</h2>
<ul>
<li><a href="http://dlang.org/">Официальный сайт</a></li>
<li><a href="http://ddili.org/ders/d.en/">Онлайн-книга</a></li>
<li><a href="http://wiki.dlang.org/">Официальная вики</a></li>
</ul>

        <hr>
        <p>
          Хотите предложить свой перевод? Может быть, улучшение перевода? <a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">Откройте Issue</a> в репозитории GitHub или сделайте <a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/ru/d.md">pull request</a> сами!
        </p>
        <p class="contributed">
          Первоначально предоставлено автором Anton Pastukhov, и обновлено <a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/ru/d.md">5 авторами</a>.
        </p>

        <footer>
          <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0; width: 80px; height: 28px; padding-bottom: 5px;" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-sa.svg" /></a>
          <p>
            &copy; 2025
            <a href="https://anton9.com/">Anton Pastukhov</a>,
            <a href="https://lhs.su/">Robert Brights-Gray</a>,
            <a href="https://oire.me/">Andre Polykanine</a>
          </p>
        </footer>
      </div>
    </div>
  </body>
</html>