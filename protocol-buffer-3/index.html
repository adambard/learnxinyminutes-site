<!DOCTYPE html>
<html lang="en">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WXC8R75DEN');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Language" content="en">
    <title>Learn Protocol Buffers in Y Minutes</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto+Slab:wght@100..900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/screen.css">
    <link rel="stylesheet" href="/css/light.css">
    <link rel="stylesheet" href="/css/dark.css">

    <link rel="canonical" href="https://learnxinyminutes.com/protocol-buffer-3/">
    <script>
      localStorage.removeItem("lxiym_theme");
    </script>
  </head>
  <body>
    <div class="container">
      <div class="share">
        <span class="sharemsg">
          <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fprotocol-buffer-3%2F&amp;text=Learn+X+in+Y+minutes%2C+where+X%3DProtocol+Buffers">
            Share this page
          </a>
        </span>
        <span class='st_facebook_large' displayText='Facebook'></span>
        <span class='st_twitter_large' displayText='Tweet'></span>
      </div>
      <h1><a href="/">Learn X in Y minutes</a></h1>
      <h2>Where X=Protocol Buffers</h2>
      <p class="filelink">
        Get the code:
        <a href="/files/protocol-buffers.proto">protocol-buffers.proto</a>
      </p>
      <div id="doc">
<p>Protocol buffers are Google's language-neutral, platform-neutral, extensible mechanism for serializing structured data â€“ think XML, but smaller, faster, and simpler.
You define how you want your data to be structured once, then you can use special generated source code to easily write and read your structured data to and from a variety of data streams and using a variety of languages.
Protocol Buffers are Schema Of Messages. They are language agnostic.
They can be converted to binary and converted back to message formats using the code generated by the protoc compiler for various languages.</p>
<div class="highlight"><pre lang="protobuf"><span class="cm">/*</span>
<span class="cm">* Language Syntax</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm">* Specifying Syntax Of Protocol Buffer Version</span>
<span class="cm">* Specifying Which Protocol Buffer Version To Use</span>
<span class="cm">* It can be usually proto3 or proto2</span>
<span class="cm">*/</span>
<span class="k">syntax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;proto3&quot;</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm">* Declaring Message In Protocol Buffer:</span>
<span class="cm">* As you can see, each field in the message definition has a unique number.</span>
<span class="cm">* These field numbers are used to identify your fields in the message binary format,</span>
<span class="cm">* and should not be changed once your message type is in use.</span>
<span class="cm">* Note that field numbers in the range 1 through 15 take one byte to encode, including the field number and the field&#39;s type (you can find out more about this in Protocol Buffer Encoding).</span>
<span class="cm">* Field numbers in the range 16 through 2047 take two bytes. So you should reserve the numbers 1 through 15 for very frequently occurring message elements.</span>
<span class="cm">* Remember to leave some room for frequently occurring elements that might be added in the future.</span>
<span class="cm">* The smallest field number you can specify is 1, and the largest is 2^29 - 1, or 536,870,911.</span>
<span class="cm">* You also cannot use the numbers 19000 through 19999 (FieldDescriptor::kFirstReservedNumber through FieldDescriptor::kLastReservedNumber),</span>
<span class="cm">* as they are reserved for the Protocol Buffers implementation - the protocol buffer compiler will complain if you use one of these reserved numbers in your .proto.</span>
<span class="cm">* Similarly, you cannot use any previously reserved field numbers.</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm">Syntax For Declaring Message:</span>
<span class="cm">    message ${MessageName} {</span>
<span class="cm">        ${Scalar Value Type} ${FieldName1} = ${Tag Number1};</span>
<span class="cm">                .</span>
<span class="cm">                .</span>
<span class="cm">                .</span>
<span class="cm">        ${Scalar Value Type} ${FieldNameN} = ${Tag NumberN};</span>
<span class="cm">    }</span>

<span class="cm">Default Values Will be applied any case if the message doesn&#39;t contain a existing field defined</span>
<span class="cm">in the message definition</span>
<span class="cm">*/</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">MessageTypes</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">    * Scalar Value Types</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">stringType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// A string must always contain UTF-8 encoded or 7-bit ASCII text. Default value = &quot;&quot;</span>

<span class="w">    </span><span class="c1">// Number Types, Default Value = 0</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">int32Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c1">// Uses Variable Length Encoding. Inefficient For Negative Numbers, Instead Use sint32.</span>
<span class="w">    </span><span class="kt">int64</span><span class="w"> </span><span class="na">int64Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="c1">// Uses Variable Length Encoding. Inefficient For Negative Numbers, Instead Use sint64.</span>
<span class="w">    </span><span class="kt">uint32</span><span class="w"> </span><span class="na">uInt32Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="c1">// Uses Variable Length Encoding</span>
<span class="w">    </span><span class="kt">uint64</span><span class="w"> </span><span class="na">uInt64Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="c1">// Uses Variable Length Encoding</span>
<span class="w">    </span><span class="kt">sint32</span><span class="w"> </span><span class="na">sInt32Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="c1">// Uses Variable Length Encoding. They are efficient in encoding for negative numbers.</span>
<span class="w">                           </span><span class="c1">// Use this instead of int32 for negative numbers</span>
<span class="w">    </span><span class="kt">sint64</span><span class="w"> </span><span class="na">sInt64Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"> </span><span class="c1">// Uses Variable Length Encoding. They are efficient in encoding for negative numbers.</span>
<span class="w">    </span><span class="c1">// Use this instead of int64 for negative numbers.</span>

<span class="w">    </span><span class="kt">fixed32</span><span class="w"> </span><span class="na">fixed32Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"> </span><span class="c1">// Always four bytes. More efficient than uint32 if values are often greater than 2^28.</span>
<span class="w">    </span><span class="kt">fixed64</span><span class="w"> </span><span class="na">fixed64Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w"> </span><span class="c1">// Always eight bytes. More efficient than uint64 if values are often greater than 2^56</span>

<span class="w">    </span><span class="kt">sfixed32</span><span class="w"> </span><span class="na">sfixed32Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="c1">// Always four bytes.</span>
<span class="w">    </span><span class="kt">sfixed64</span><span class="w"> </span><span class="na">sfixed64Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="p">;</span><span class="w"> </span><span class="c1">// Always Eight bytes.</span>

<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">boolType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">;</span><span class="w"> </span><span class="c1">// Boolean Type. Default Value = false</span>

<span class="w">    </span><span class="kt">bytes</span><span class="w"> </span><span class="na">bytesType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">13</span><span class="p">;</span><span class="w"> </span><span class="c1">// May contain any arbitrary sequence of bytes. Default Value = Empty Bytes</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="na">doubleType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">14</span><span class="p">;</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="na">floatType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span><span class="p">;</span>

<span class="w">    </span><span class="kd">enum</span><span class="w"> </span><span class="n">Week</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="na">UNDEFINED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// Tag 0 is always used as default in case of enum</span>
<span class="w">        </span><span class="na">SUNDAY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="na">MONDAY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="na">TUESDAY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">        </span><span class="na">WEDNESDAY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">        </span><span class="na">THURSDAY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">        </span><span class="na">FRIDAY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">        </span><span class="na">SATURDAY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">Week</span><span class="w"> </span><span class="na">wkDayType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">    * Defining Collection Of Scalar Value Type</span>
<span class="cm">    * Syntax: repeated ${ScalarType} ${name} = TagValue</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="na">listOfString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">17</span><span class="p">;</span><span class="w"> </span><span class="c1">// List[String]</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* Defining Defined Message Types In Other Message Definition</span>
<span class="cm">*/</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">Person</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">sname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">City</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Person</span><span class="w"> </span><span class="na">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* Nested Message Definitions</span>
<span class="cm">*/</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">NestedMessages</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">message</span><span class="w"> </span><span class="nc">FirstLevelNestedMessage</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="na">firstString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="kd">message</span><span class="w"> </span><span class="nc">SecondLevelNestedMessage</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">string</span><span class="w"> </span><span class="na">secondString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">FirstLevelNestedMessage</span><span class="w"> </span><span class="na">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">FirstLevelNestedMessage.SecondLevelNestedMessage</span><span class="w"> </span><span class="na">msg2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* Importing Message From A File</span>
<span class="cm">*/</span>

<span class="c1">// one.proto</span>
<span class="c1">// message One {</span>
<span class="c1">//     string oneMsg = 1;</span>
<span class="c1">// }</span>

<span class="c1">// two.proto</span>
<span class="c1">//  import &quot;myproject/one.proto&quot;</span>
<span class="c1">//  message Two {</span>
<span class="c1">//       string twoMsg = 2;</span>
<span class="c1">//  }</span>


<span class="cm">/*</span>
<span class="cm">* Advanced Topics</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm">* Handling Message Type Changes:</span>
<span class="cm">* Never Change/Use The TagNumber Of A Message Field Which Was Removed</span>
<span class="cm">* We should use reserved in case of message definition update.</span>
<span class="cm">* (https://developers.google.com/protocol-buffers/docs/proto3#updating)</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm">* Reserved Fields</span>
<span class="cm">* It&#39;s used in case if we need to add/remove new fields into message.</span>
<span class="cm">* Using Reserved Backward and Forward Compatibility Of Messages can be achieved</span>
<span class="cm">*/</span>


<span class="kd">message</span><span class="w"> </span><span class="nc">ReservedMessage</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">reserved</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="c1">// Set Of Tag Numbers Which Can&#39;t be reused.</span>
<span class="w">    </span><span class="k">reserved</span><span class="w"> </span><span class="s">&quot;firstMsg&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;secondMsg&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;thirdMsg&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Set Of Labels Which Can&#39;t Be reused.</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* Any</span>
<span class="cm">* The Any message type lets you use messages as embedded types without having their .proto definition.</span>
<span class="cm">* An Any contains an arbitrary serialized message as bytes,</span>
<span class="cm">* along with a URL that acts as a globally unique identifier for and resolves to that message&#39;s type.</span>
<span class="cm">* For Any to work we need to import it as shown below.</span>
<span class="cm">*/</span>
<span class="cm">/*</span>
<span class="cm">    import &quot;google/protobuf/any.proto&quot;;</span>
<span class="cm">    message AnySampleMessage {</span>
<span class="cm">        repeated google.protobuf.Any.details = 1;</span>
<span class="cm">    }</span>

<span class="cm">*/</span>


<span class="cm">/*</span>
<span class="cm">*  OneOf</span>
<span class="cm">* There are cases, wherein only one field at-most might be present as part of the message.</span>
<span class="cm">* Note: OneOf messages can&#39;t be repeated.</span>
<span class="cm">*/</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">OneOfMessage</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">oneof</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="na">fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="na">sname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* Maps</span>
<span class="cm">* Map fields cannot be repeated.</span>
<span class="cm">* Ordering Of A Map Is Not Guaranteed.</span>
<span class="cm">*/</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">MessageWithMaps</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">map</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="p">&gt;</span><span class="w"> </span><span class="na">mapOfMessages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm">* Packages</span>
<span class="cm">* Used for preventing name clashes between protocol message types</span>
<span class="cm">* Syntax:</span>
<span class="cm">    package ${packageName};</span>

<span class="cm">    To Access the package;</span>
<span class="cm">    ${packageName}.${messageName} = ${tagNumber};</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm">* Services</span>
<span class="cm">* Message Types Defined For Using In RPC system.</span>
<span class="cm">*  When protoc compiler generates for various languages it generates stub methods for the services.</span>
<span class="cm">*/</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">SearchRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">queryString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">SearchResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">queryResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">service</span><span class="w"> </span><span class="n">SearchService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">Search</span><span class="w"> </span><span class="p">(</span><span class="n">SearchRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">SearchResponse</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h2>Generating Classes In Various Languages For Protocol Buffers</h2>
<div class="highlight"><pre lang="shell">protoc<span class="w"> </span>--proto_path<span class="o">=</span>IMPORT_PATH<span class="w"> </span>--cpp_out<span class="o">=</span>DST_DIR<span class="w"> </span>--java_out<span class="o">=</span>DST_DIR<span class="w"> </span>--python_out<span class="o">=</span>DST_DIR<span class="w"> </span>--go_out<span class="o">=</span>DST_DIR<span class="w"> </span>--ruby_out<span class="o">=</span>DST_DIR<span class="w"> </span>--objc_out<span class="o">=</span>DST_DIR<span class="w"> </span>--csharp_out<span class="o">=</span>DST_DIR<span class="w"> </span>path/to/file.proto
</pre></div>
<h2>References</h2>
<p><a href="https://developers.google.com/protocol-buffers/">Google Protocol Buffers</a></p>

        <hr>
        <p>
          Got a suggestion? A correction, perhaps? <a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">Open an Issue</a> on the GitHub Repo, or make a <a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/protocol-buffer-3.md">pull request</a> yourself!
        </p>
        <p class="contributed">
          Originally contributed by Shankar Shastri, and updated by <a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/protocol-buffer-3.md">2 contributors</a>.
        </p>

        <footer>
          <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0; width: 80px; height: 28px; padding-bottom: 5px;" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-sa.svg" /></a>
          <p>
            &copy; 2025
            <a href="https://github.com/shankarshastri">Shankar Shastri</a>
          </p>
        </footer>
      </div>
    </div>
  </body>
</html>