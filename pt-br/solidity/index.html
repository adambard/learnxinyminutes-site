<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WXC8R75DEN');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Language" content="pt-BR">
    <title>Learn Solidity in Y Minutes</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto+Slab:wght@100..900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/screen.css">
    <link rel="stylesheet" href="/css/light.css">
    <link rel="stylesheet" href="/css/dark.css">

    <link rel="canonical" href="https://learnxinyminutes.com/pt-br/solidity/">
    <script>
      localStorage.removeItem("lxiym_theme");
    </script>
  </head>
  <body>
    <div class="container">
      <h1><a href="/">Aprenda X em Y Minutos</a></h1>
      <h2>Onde X=Solidity</h2>

      <div class="lang-choice">
        <label for="lang-select">Idioma:</label>
        <select id="lang-select" name="lang-select">
          <option value="pt-br">português (Brasil)</option>
          <option value="en" data-url="/solidity/">English</option>
          <option value="it" data-url="/it/solidity/">italiano</option>
          <option value="zh-cn" data-url="/zh-cn/solidity/">中文 (简体)</option>
        </select>
      </div>
      <p class="filelink">
        Baixar o código:
        <a href="/pt-br/files/learnSolidity.sol">learnSolidity.sol</a>
      </p>
      <div id="doc">
<p>Solidity permite você programar para a <a href="https://www.ethereum.org/">Ethereum</a>,
uma máquina virtual baseada na tecnologia blockhain
para criação e execução de contratos inteligentes, sem necessidade de partes
centralizadas ou de confiança.</p>
<p>Solidity é uma linguagem de contratos estaticamente tipaada com similaridade com
JavaScript e C. Como objetos em programação orientada a objetos, cada contrato
possue variáveis de estado, funções e tipos de dados comuns. Funcionalidades
particulares de contratados incluem cláusuras modificadoras (guarda), notifica
dores de eventos para listerners e variáveis globais customizadas.</p>
<p>Exemplos de contratos Ethereum incluem crowdfunding, votações e audições cegas.</p>
<p>Erros em código Solidity causam grandes riscos e custos; portanto, você
deve ser muito cuidado com teste e divulgação. DEVIDO ÀS CONSTANTES MUDANÇAS
NO ETHEREUM, ESTE DOCUMENTOS PROVAVELMENTE NÃO ESTARÁ ATUALIZADO, VOCÊ DEVE
ACOMPANHAR A CHATROOM DO SOLIDITY E O BLOG DO ETHEREUM PARA NOTÍCIAS ATUALIZADAS.
TODO CÓDIGO AQUI É ENTREGUE COMO ESTÁ, COM SUBSTANCIAL RISCO DE ERRROS E PADRÕES
DE CÓDIGO DEPRECADOS.</p>
<p>Diferentemente de outros tipo de código, você também deve adicionar padrões
como pausa, deprecação e retração para reduzir riscos. Este documento discute
sintaxe, então, muito padrões populares são excluídos.</p>
<p>Como Solidity e Ethereum ainda estão sob desenvolvimento, funcionalidades beta
e experimentais são tipicamente marcadas e sujeitas à mudanças. Pull requests
são bem-vindos.</p>
<div class="highlight"><pre lang="solidity"><span class="c1">// Primeiramente, um contrato de um Banco simples</span>
<span class="c1">// Permite depósitos, retiradas e checagens de saldo</span>

<span class="c1">// banco_simples.sol (note a extensão .sol)</span>

<span class="cm">/* **** INCICIO DO EXEMPLO **** */</span>

<span class="c1">// Declare a versão do compilador.</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.4.2</span><span class="p">;</span>

<span class="c1">// Inicie com comentários Natspec (as três barras)</span>
<span class="c1">// usados para documentação - e como dados descritivos para elementos/ação de UI</span>

<span class="c1">/// @title BancoSimples</span>
<span class="c1">/// @author nemild</span>

<span class="cm">/* &#39;contrato&#39; tem similadirades com &#39;classes&#39; em outras linguagens (variáveis de</span>
<span class="cm">class, herança, etc.) */</span>

<span class="k">contract</span><span class="w"> </span><span class="ni">BancoSimples</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// CamelCase</span>
<span class="w">    </span><span class="c1">// Declare variáveis de estado fora da função, para persistí-la durante a</span>
<span class="w">    </span><span class="c1">// duração do contrato</span>

<span class="w">    </span><span class="c1">// dicionário que mapeia endereços para saldos</span>
<span class="w">    </span><span class="c1">// tenha cuidado  sobre ataques de overflow com números</span>

<span class="w">    </span><span class="kt">mapping</span><span class="w"> </span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span>saldos<span class="p">;</span>

<span class="w">    </span><span class="c1">// &quot;private&quot; significa que outros contratos não podem acessar saldos</span>
<span class="w">    </span><span class="c1">// diretamente, mas o dado ainda é visível para outras partes da blockchain</span>

<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="k">public </span><span class="nv">dono</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// ´public´ é legível (mas sem acesso de escrita) por usuários e contratos</span>

<span class="w">    </span><span class="c1">// Eventos - ações públicas para ouvintes externo</span>
<span class="w">    </span><span class="kt">event</span><span class="w"> </span><span class="nv">LogRealizacaoDeDeposito</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">numeroDaConta</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">quantidade</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Construtor, pode receber uma ou várias variáveis; apenas uma opção é</span>
<span class="w">    </span><span class="c1">// permitidas</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">BancoSimples</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// msg dá detalhes sobre a mensagem mandada pelo contrato</span>
<span class="w">        </span><span class="c1">// msg.sender é um chamador do contrato (endereço do criador do</span>
<span class="w">        </span><span class="c1">// contrato)</span>

<span class="w">        </span>dono<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.sender</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">/// @notice Deposita ether no banco</span>
<span class="w">    </span><span class="c1">/// @return O saldo do usuário após o depósito</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">deposito</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>saldos<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Sem necessidade de &quot;this.&quot; ou &quot;self.&quot; para variáveis de estado</span>
<span class="w">        </span><span class="c1">// todos as variáveis são inciadas com seu valor default</span>

<span class="w">        </span>LogRealizacaoDeDeposito<span class="p">(</span><span class="k">msg.sender</span><span class="p">,</span><span class="w"> </span><span class="k">msg.value</span><span class="p">);</span><span class="w"> </span><span class="c1">// dispara evento</span>

<span class="w">        </span><span class="kt">return</span><span class="w"> </span>saldos<span class="p">[</span><span class="k">msg.sender</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">/// @notice Retira ether do banco</span>
<span class="w">    </span><span class="c1">/// @dev Isto não retorna nenhum ether excendente</span>
<span class="w">    </span><span class="c1">/// @param quantidadeDeRetirada quantidade que você quer retirar</span>
<span class="w">    </span><span class="c1">/// @return O saldo restante do usuário</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">retirada</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">quantidadeDeRetirada</span><span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">saldoRestate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">if</span><span class="p">(</span>saldos<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span>quantidadeDeRetirada<span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="c1">// Observe como deduzimos o saldo imediatamente, antes de enviar -</span>
<span class="w">            </span><span class="c1">// devido ao risco de uma chamada recursiva que permite o chamador</span>
<span class="w">            </span><span class="c1">// pedir um valor maior que seu saldo</span>

<span class="w">            </span>saldos<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span>quantidadeDeRetirada<span class="p">;</span>

<span class="w">            </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">msg.sender</span><span class="p">.</span>send<span class="p">(</span>quantidadeDeRetirada<span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// incremente de volta só se falhar, como pode estar enviando</span>
<span class="w">                </span><span class="c1">// para o contrato que substituiu &#39;enviar&#39; no final</span>
<span class="w">                </span><span class="c1">// do recebimento</span>
<span class="w">                </span>saldos<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span>quantidadeDeRetirada<span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kt">return</span><span class="w"> </span>saldos<span class="p">[</span><span class="k">msg.sender</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">/// @notice Retorna o saldo</span>
<span class="w">    </span><span class="c1">/// @return O saldo do usuário</span>
<span class="w">    </span><span class="c1">// &#39;constant&#39; evita que a função edite variáveis de estado</span>
<span class="w">    </span><span class="c1">// permite a função executar localmente/fora da blockchain</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">saldo</span><span class="p">()</span><span class="w"> </span><span class="kt">constant</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>saldos<span class="p">[</span><span class="k">msg.sender</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Função de fallback - Chamada se outras funções não forem chamadas ou</span>
<span class="w">    </span><span class="c1">// se ether sem dados forem enviados</span>
<span class="w">    </span><span class="c1">// Tipicamente chamada quando dados inválidos são enviados</span>
<span class="w">    </span><span class="c1">// Adicionada para que ether enviado neste contrato seja revertido se o</span>
<span class="w">    </span><span class="c1">// contrato falhar. Se não existisse, o dinheiro do enviante é transferido</span>
<span class="w">    </span><span class="c1">// para o contrato</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">throw</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;throw&#39; reverte o estao para antes da chamada</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="c1">// ** FIM DO EXEMPLO **</span>

<span class="c1">// Agora, o básico de Solidity</span>


<span class="c1">//1 TIPO DE DADOS E MÉTODOS ASSOCIADOS</span>
<span class="c1">// uint é usado para quantidade de moeda (não existem doubles ou floats)</span>
<span class="c1">// e para datas (no sistema de tempo Unix)</span>

<span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">;</span>

<span class="c1">// int de 256 bits, não pode ser mudado após sua instanciação</span>
<span class="kt">int</span><span class="w"> </span><span class="nv">constant</span><span class="w"> </span>a<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">8</span><span class="p">;</span>
<span class="kt">int256</span><span class="w"> </span><span class="nv">constant</span><span class="w"> </span>a<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">8</span><span class="p">;</span><span class="w"> </span><span class="c1">// mesmo efeito, mas aqui os 256 bits são explícitos</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">constant</span><span class="w"> </span>VERSÃO_ID<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x123A1</span><span class="p">;</span><span class="w"> </span><span class="c1">// uma constante hexadecimal</span>

<span class="c1">// com &#39;constant&#39;, o compilador substitui cada ocorrência com o valor</span>

<span class="c1">// Para int e uint, é possível determinar o espaço explicitamente, em intervalos</span>
<span class="c1">// de 8 a 256, e.g., int8, int16, int24</span>
<span class="kt">uint8</span><span class="w"> </span><span class="nv">b</span><span class="p">;</span>
<span class="kt">int64</span><span class="w"> </span><span class="nv">c</span><span class="p">;</span>
<span class="kt">uint248</span><span class="w"> </span><span class="nv">e</span><span class="p">;</span>

<span class="c1">// Cuidado contra overflows, e proteja-se contra esse tipo de ataque</span>

<span class="c1">// Não há funções randômicas padrão, use outros contratos para este objetivo</span>

<span class="c1">// Casting de tipo</span>
<span class="kt">int</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span>b<span class="p">);</span>

<span class="kt">bool</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">true</span><span class="p">;</span><span class="w"> </span><span class="c1">// ou então &#39;var b = true;&#39; para inferição de tipo</span>

<span class="c1">// Endereços - comportam 20 bytes/160 bits endereços Ethereum</span>
<span class="c1">// Não permite operações aritiméticas</span>
<span class="kt">address</span><span class="w"> </span><span class="k">public </span><span class="nv">dono</span><span class="p">;</span>

<span class="c1">// Tipos de contas:</span>
<span class="c1">// Conta de contrato: endereço criado ao criar (função do endereço do criador,</span>
<span class="c1">// número da transação)</span>
<span class="c1">// Conta externa: (pessoa/entidade externa): endereç criado a partir de chave</span>
<span class="c1">// pública</span>

<span class="c1">// Adicione o campo &#39;public&#39; para indicar visibilidade pública/externa</span>
<span class="c1">// um getter é automaticamente criado, mas NÃO um setter</span>

<span class="c1">// Todos os endereços podem enviar ether</span>
dono<span class="p">.</span>send<span class="p">(</span>ALGUM_SALDO<span class="p">);</span><span class="w"> </span><span class="c1">// returna falso caso falhe</span>
<span class="kt">if</span><span class="w"> </span><span class="p">(</span>dono<span class="p">.</span>send<span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// LEMBRE-SE: encapsule num &#39;if&#39;, dado que endereços de</span>
<span class="c1">// contrato tem funções executadas no envio e estas podem falhar</span>
<span class="c1">//Também certifique-se que os saldos deduzidos ANTES de tentar enviar, dado que</span>
<span class="c1">// há um risco de chamada recursiva que pode drenar um contrato</span>

<span class="c1">// pode sobrescrever seu próprio</span>

<span class="c1">// Pode verificar o saldo</span>
dona<span class="p">.</span>balance<span class="p">;</span><span class="w"> </span><span class="c1">// o saldo do dono (usuário ou contrato)</span>

<span class="c1">// Bytes permitidos de 1 a 32</span>
byte<span class="w"> </span>a<span class="p">;</span><span class="w"> </span><span class="c1">// byte é o mesmo que bytes1</span>
bytes2<span class="w"> </span>b<span class="p">;</span>
<span class="kt">bytes32</span><span class="w"> </span><span class="nv">c</span><span class="p">;</span>

<span class="c1">// Bytes dinamicamente criados</span>

<span class="kt">bytes</span><span class="w"> </span><span class="nv">m</span><span class="p">;</span><span class="w"> </span><span class="c1">// Um array especial, mesmo que byte[] (mas mais comprimido)</span>

<span class="c1">// Mais custoso que byte1-byte32, então, prefira estes quando possível</span>

<span class="c1">// mesmo que bytes, mas não permite verificar tamanho ou acesso por indíce (por</span>
<span class="c1">// enquanto)</span>

<span class="kt">string</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;oi&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// guardado em UTF8, note as aspas duplas, não simples</span>

<span class="c1">// funções de string serão adicionadas no futuro</span>
<span class="c1">// prefira bytes32/bytes, dado que UTF8 usa mais espaço</span>

<span class="c1">// Inferência de tipo</span>
<span class="c1">// var não infere tipos baseados na primeira atribuição,</span>
<span class="c1">// não pode ser usado em paramêtros de funções</span>

<span class="kt">var</span><span class="w"> </span>a<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">true</span><span class="p">;</span>

<span class="c1">// use com cuidado, inferência pode resultar em tipos errados</span>
<span class="c1">// e.g., um int8, quando um contador precisa de int16</span>

<span class="c1">// var pode ser usado para assinalar uma função a uma variável</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">a</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">return</span><span class="w"> </span>x<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m m-Decimal">2</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">var</span><span class="w"> </span>f<span class="w"> </span><span class="o">=</span><span class="w"> </span>a<span class="p">;</span>
f<span class="p">(</span><span class="m m-Decimal">22</span><span class="p">);</span><span class="w"> </span><span class="c1">// chamada</span>

<span class="c1">// por padrão, todos os valores são inicializados com 0</span>

<span class="c1">// Delete pode ser chamada na maioria dos tipos</span>
<span class="c1">// (NÃO destroi o valor, mas retorna para o valor 0, o incial)</span>

<span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">5</span><span class="p">;</span>

<span class="c1">// Desestruturação/Tuplas</span>
<span class="p">(</span>x<span class="p">,</span><span class="w"> </span>y<span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="m m-Decimal">2</span><span class="p">,</span><span class="w"> </span><span class="m m-Decimal">7</span><span class="p">);</span><span class="w"> </span><span class="c1">// assinada/troca múltiplos valores</span>

<span class="c1">// 2. ESTRUTURAS DE DADOS</span>
<span class="c1">// Arrays</span>

<span class="kt">bytes32</span><span class="p">[</span><span class="m m-Decimal">5</span><span class="p">]</span><span class="w"> </span>apelidos<span class="p">;</span><span class="w"> </span><span class="c1">// array estático</span>
<span class="kt">bytes32</span><span class="p">[]</span><span class="w"> </span>nomes<span class="p">;</span><span class="w"> </span><span class="c1">// array dinâmico</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">novoTamanho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>nomes<span class="p">.</span>push<span class="p">(</span><span class="s2">&quot;João&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// adicionando retorna o novo tamanho do</span>

<span class="c1">// Tamanho</span>
nomes<span class="p">.</span>length<span class="p">;</span><span class="w"> </span><span class="c1">// pega o tamanho</span>
nomes<span class="p">.</span>length<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// tamanhos pode ser alterados (para arrays dinâmicos)</span>

<span class="c1">// arrays multidimensionais</span>
<span class="kt">uint</span><span class="p">[][</span><span class="m m-Decimal">5</span><span class="p">]</span><span class="w"> </span>x<span class="p">;</span><span class="w"> </span><span class="c1">// array com 5 arrays dinâmicos como elementos (ordem da maioria</span>
<span class="c1">// das linguagens)</span>

<span class="c1">// Dicionários (qualquer tipo para qualquer tipo)</span>
<span class="kt">mapping</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>saldos<span class="p">;</span>
saldos<span class="p">[</span><span class="s2">&quot;charles&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>
console<span class="p">.</span>log<span class="p">(</span>saldos<span class="p">[</span><span class="s2">&quot;ada&quot;</span><span class="p">]);</span><span class="w"> </span><span class="c1">// é 0, toda chave não assinalada retorna zero</span>
<span class="c1">// &#39;public&#39; permite o seguinte contrato</span>
nomeDoContrato<span class="p">.</span>saldos<span class="p">(</span><span class="s2">&quot;charles&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// retorna 1</span>
<span class="c1">// &#39;public&#39; cria um getter (mas não um setter) como o seguinte</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">saldos</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="nv">_conta</span><span class="p">)</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">saldo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">return</span><span class="w"> </span>saldos<span class="p">[</span>_conta<span class="p">];</span>
<span class="p">}</span>

<span class="c1">// Mapeamentos aninhados</span>
<span class="kt">mapping</span><span class="w"> </span><span class="p">(</span>endereco<span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">mapping</span><span class="w"> </span><span class="p">(</span>endereco<span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">uint</span><span class="p">))</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>guardioes<span class="p">;</span>

<span class="c1">// Para deletar</span>
delete<span class="w"> </span>saldos<span class="p">[</span><span class="s2">&quot;John&quot;</span><span class="p">];</span>
delete<span class="w"> </span>saldos<span class="p">;</span><span class="w"> </span><span class="c1">// assinala zero para todas as chaves</span>

<span class="c1">// Diferentemente de outras linguages, NÃO É POSSÍVEL iterar sobre todos os</span>
<span class="c1">// elementos de um mapeamento, sem saber previamente as chaves - é possível</span>
<span class="c1">// construir estruturas de dados personalizadas para fazer isso</span>

<span class="c1">// Structs e enums</span>
<span class="kt">struct</span><span class="w"> </span><span class="nv">Banco</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="nv">dono</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="nv">saldo</span><span class="p">;</span>
<span class="p">}</span>
Banco<span class="w"> </span>b<span class="w"> </span><span class="o">=</span><span class="w"> </span>Banco<span class="p">({</span>
<span class="w">    </span>dono<span class="o">:</span><span class="w"> </span><span class="k">msg.sender</span><span class="p">,</span>
<span class="w">    </span>saldo<span class="o">:</span><span class="w"> </span><span class="m m-Decimal">5</span>
<span class="p">});</span>
<span class="c1">// ou</span>
Banco<span class="w"> </span>c<span class="w"> </span><span class="o">=</span><span class="w"> </span>Banco<span class="p">(</span><span class="k">msg.sender</span><span class="p">,</span><span class="w"> </span><span class="m m-Decimal">5</span><span class="p">);</span>

c<span class="p">.</span>quantidade<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">5</span><span class="p">;</span><span class="w"> </span><span class="c1">// cria novo valor</span>
delete<span class="w"> </span>b<span class="p">;</span>
<span class="c1">// assinala todos os valores do enum para zero, exceto mapeamentos</span>

<span class="c1">// Enums</span>
<span class="kt">enum</span><span class="w"> </span><span class="nv">Estado</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>Criado<span class="p">,</span><span class="w"> </span>Travado<span class="p">,</span><span class="w"> </span>Inativo<span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="c1">// geralmente usado para máquina de</span>
<span class="c1">// estados</span>
Estado<span class="w"> </span><span class="kt">public</span><span class="w"> </span>estado<span class="p">;</span><span class="w"> </span><span class="c1">// Declara variável para enum</span>
estado<span class="w"> </span><span class="o">=</span><span class="w"> </span>Estado<span class="p">.</span>Criado<span class="p">;</span>
<span class="c1">// enums podem ser explicitamente convertidas em ints</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">estadoCriado</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">uint</span><span class="p">(</span>Estado<span class="p">.</span>Criado<span class="p">);</span><span class="w"> </span><span class="c1">//  0</span>

<span class="c1">// Localização de dados: Memória vs. disco vs. pilha - todos os tipos complexos</span>
<span class="c1">// (arrays, structs) tem uma localização de dados</span>
<span class="c1">// &#39;memória&#39; não é persistida, &#39;disco&#39; é</span>
<span class="c1">// Padrão é &#39;disco&#39; para variáveis locais e de estado; &#39;memória&#39; para paramêtros</span>
<span class="c1">// de função. Pilha guarda pequena variáveis locais</span>

<span class="c1">// a maioria dos tipos podem ter sua localização de dados explicitamente assinalos</span>

<span class="c1">// 3. Operações simples</span>
<span class="c1">// Comparações, operadores binários e aritimétricos são providos</span>
<span class="c1">// exponenciação: **</span>
<span class="c1">// ou exclusivo: ^</span>
<span class="c1">// negação binária: ~</span>

<span class="c1">// 4. Variáveis Globais de nota</span>
<span class="c1">// ** this **</span>
<span class="kt">this</span><span class="p">;</span><span class="w"> </span><span class="c1">// endereço do contrato</span>
<span class="c1">// geralmente usado no final do contrato para enviar o saldo restante às partes</span>
<span class="kt">this</span><span class="p">.</span>balance<span class="p">;</span>
<span class="kt">this</span><span class="p">.</span>algumFuncao<span class="p">();</span><span class="w"> </span><span class="c1">// chamada de função externa via call, não via jump interno</span>

<span class="c1">// ** msg - Mensagem corrente recebida pelo contrato ** **</span>
<span class="k">msg.sender</span><span class="p">;</span><span class="w"> </span><span class="c1">// endereço do enviador</span>
<span class="k">msg.value</span><span class="p">;</span><span class="w"> </span><span class="c1">// quantidade de ether provida para este contrato em wei</span>
<span class="k">msg.data</span><span class="p">;</span><span class="w"> </span><span class="c1">// bytes, todos os dados da chamada</span>
<span class="k">msg.gas</span><span class="p">;</span><span class="w"> </span><span class="c1">// gas restante</span>

<span class="c1">// ** tx - Esta transação **</span>
<span class="k">tx.origin</span><span class="p">;</span><span class="w"> </span><span class="c1">// endereço do enviador da transação</span>
<span class="k">tx.gasprice</span><span class="p">;</span><span class="w"> </span><span class="c1">// valor do gas da transação</span>

<span class="c1">// ** block - Informação do bloco corrente **</span>
now<span class="p">;</span><span class="w"> </span><span class="c1">// tempo corrente (aproxiamdo), substituto para block.timestamp</span>
<span class="c1">//(usa tempo do Unix)</span>
<span class="k">block.number</span><span class="p">;</span><span class="w"> </span><span class="c1">// número do bloco corrente</span>
<span class="k">block.difficulty</span><span class="p">;</span><span class="w"> </span><span class="c1">// dificuldade do bloco corrente</span>
<span class="k">block.blockhash</span><span class="p">(</span><span class="m m-Decimal">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// retorna bytes32, só funciona para os 256 blocos mais</span>
<span class="c1">//recentes</span>
<span class="k">block.gasLimit</span><span class="p">();</span>

<span class="c1">// ** storage - Hash de disco persistente **</span>
storage<span class="p">[</span><span class="s1">&#39;abc&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;def&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// mapea palavras de 256 bits em palavras de 256 bits</span>


<span class="c1">// 4. FUNÇÕES E MAIS</span>
<span class="c1">// A. Funções</span>
<span class="c1">// Funções simples</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">incremento</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>x<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">return</span><span class="w"> </span>x<span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Funções podem retornar muito argumentos, e podem especificar argumentos</span>
<span class="c1">// retornados sem necessidade de explicitamente usar return</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">incremento</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>x<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>
<span class="w">    </span>y<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Chamando a função anterior</span>
<span class="kt">uint</span><span class="w"> </span><span class="p">(</span>a<span class="p">,</span>b<span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>incremento<span class="p">(</span><span class="m m-Decimal">1</span><span class="p">,</span><span class="m m-Decimal">1</span><span class="p">);</span>

<span class="c1">// &#39;constant&#39; indica que uam função não altera variáveis persistidas</span>
<span class="c1">// Funções constantes são executadas localmente, não na blockchain</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">y</span><span class="p">;</span>

<span class="kt">function</span><span class="w"> </span><span class="nv">incremento</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span><span class="w"> </span><span class="kt">constant</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>x<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>
<span class="w">    </span>y<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// Esta linha deve falhar</span>
<span class="w">    </span><span class="c1">// y é uma variável de estado e não pode ser alterada por uma função local</span>
<span class="p">}</span>

<span class="c1">// &#39;Especificadores de visibilidade de funções&#39;</span>
<span class="c1">// Estes podem substituitir &#39;constante&#39;, incluíndo:</span>
<span class="c1">// public - visbilidade externa e interna (padrão)</span>
<span class="c1">// private - apenas visível no contrato corrente</span>
<span class="c1">// internal - apenas visível no contrato corrente e seus derivados</span>

<span class="c1">// Functions hosteada - e pode ser assinalada para variável</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">a</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span>z<span class="w"> </span><span class="o">=</span><span class="w"> </span>b<span class="p">;</span>
<span class="w">    </span>b<span class="p">();</span>
<span class="p">}</span>

<span class="kt">function</span><span class="w"> </span><span class="nv">b</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="p">}</span>

<span class="c1">// Prefira loops sobre recursões (pilha de chamada é no máximo 1024)</span>

<span class="c1">// B. Eventos</span>
<span class="c1">// Eventos podem notificar partes externas; facilmente buscáveis e acessáveis</span>
<span class="c1">// de fora da blockchain (com clientes leves)</span>
<span class="c1">// tipicamente declarados após os parâmetros do contrato</span>

<span class="c1">// Tipicamente, com letra maiúscula - e adicione Log na frente para</span>
<span class="c1">// ser explicito e previnir confusão na chamada da função</span>

<span class="c1">// Declaração</span>
<span class="kt">event</span><span class="w"> </span><span class="nv">LogEnvio</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">indexed</span><span class="w"> </span>de<span class="p">,</span><span class="w"> </span><span class="kt">address</span><span class="w"> </span><span class="nv">indexed</span><span class="w"> </span>para<span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">quantidade</span><span class="p">);</span>
<span class="c1">// Observe a letra maíscula no início do nome</span>

<span class="c1">// Chamada</span>
Envio<span class="p">(</span>de<span class="p">,</span><span class="w"> </span>para<span class="p">,</span><span class="w"> </span>quantidade<span class="p">);</span>

<span class="c1">// Para partes externas (um contrato ou entidade externo), observe:</span>
Coin<span class="p">.</span>Envio<span class="p">().</span>watch<span class="p">({},</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="kt">function</span><span class="p">(</span>erro<span class="p">,</span><span class="w"> </span>resultado<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>erro<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>console<span class="p">.</span>log<span class="p">(</span><span class="s2">&quot;Moeda transferida: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>resultado<span class="p">.</span>args<span class="p">.</span>quantidade<span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="s2">&quot; moedas enviadas de &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>resultado<span class="p">.</span>args<span class="p">.</span>de<span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="s2">&quot; para &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>resultado<span class="p">.</span>args<span class="p">.</span>para<span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="w">        </span>console<span class="p">.</span>log<span class="p">(</span><span class="s2">&quot;Saldo atual:\n&quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="s2">&quot;Enviador: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>Coin<span class="p">.</span>balances<span class="p">.</span>call<span class="p">(</span>resultado<span class="p">.</span>args<span class="p">.</span>de<span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="s2">&quot;Recebedor: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>Coin<span class="p">.</span>balances<span class="p">.</span>call<span class="p">(</span>resultado<span class="p">.</span>args<span class="p">.</span>para<span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="c1">// Paradigma comum para um contrato depender de outro (e.g., um contrato que</span>
<span class="c1">// depende da taxa de troca provida por outro)</span>

<span class="c1">// C. ModifiCadores</span>
<span class="c1">// MOdificadores validam entradas de funções, como saldo mínimo e autorização</span>
<span class="c1">// do usuário; semelhantes a guardas em outras linguagens</span>

<span class="c1">// &#39;_&#39; (subtraço) geralmente incluído como última linha do corpo, indica que a</span>
<span class="c1">// função sendo chamada deve ser colocada ali</span>
<span class="kt">modifier</span><span class="w"> </span>apenasDepois<span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">_tempo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>agora<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span>_tempo<span class="p">)</span><span class="w"> </span><span class="kt">throw</span><span class="p">;</span><span class="w"> </span>_<span class="w"> </span><span class="p">}</span>
<span class="kt">modifier</span><span class="w"> </span>apenasDono<span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.sender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>dono<span class="p">)</span><span class="w"> </span>_<span class="w"> </span><span class="p">}</span>
<span class="c1">// geralmente usado para máquina de estado</span>
<span class="kt">modifier</span><span class="w"> </span>apenasSeEmEstado<span class="w"> </span><span class="p">(</span>Estado<span class="w"> </span>estadoCorrente<span class="p">)</span>
<span class="p">{</span><span class="w"> </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>estadoCorrente<span class="w"> </span><span class="o">!=</span><span class="w"> </span>Estado<span class="p">.</span>A<span class="p">)</span><span class="w"> </span>_<span class="w"> </span><span class="p">}</span>

<span class="c1">// Concatenado logo após a chamada da função</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">mudeDona</span><span class="p">(</span>novoDono<span class="p">)</span>
apenasDepois<span class="p">(</span>algumTempo<span class="p">)</span>
apenasDono<span class="p">()</span>
apenasSeEmEstado<span class="p">(</span>Estado<span class="p">.</span>A<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>dono<span class="w"> </span><span class="o">=</span><span class="w"> </span>novoDono<span class="p">;</span>
<span class="p">}</span>

<span class="c1">// subtração pode ser incluído antes do final do corpo, mas retorno explícitos</span>
<span class="c1">// pode ser ignorado, então, tome cuidado</span>
<span class="kt">modifier</span><span class="w"> </span>chequeValor<span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">quantidade</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>_
<span class="w">    </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.value</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>quantidade<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">quantidadeASerDevolvida</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>quantidade<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">msg.sender</span><span class="p">.</span>send<span class="p">(</span>quantidadeASerDevolvida<span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">throw</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 6. BRANCHES E LOOPS</span>

<span class="c1">// Todas as lógicas básicas de bloco funcionam - incluindo if/else,</span>
<span class="c1">// while, break, continue, return - mas não há switch</span>

<span class="c1">// A sintaxe é semelhante a JavaScript, mas sem conversão de tipos</span>
<span class="c1">// de não-booleanos para booleanos (operadores de comparação precisam</span>
<span class="c1">// utilizar valores booleanos)</span>

<span class="c1">// Loops que dependem o comportamento do usuário exigem cuidado - dado</span>
<span class="c1">// que contratos tem uma quantidade máxima de gas para cada bloco de</span>
<span class="c1">// de código - falhas acontecerão caso ele seja excedido</span>
<span class="c1">// Por exemplo:</span>
<span class="kt">for</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"> </span>x<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>listaDeEnderecoDeRefundo<span class="p">.</span>length<span class="p">;</span><span class="w"> </span>x<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>listaDeEnderecoDeRefundo<span class="p">[</span>x<span class="p">].</span>send<span class="p">(</span>ALGUMA_QUANTIDADE<span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kt">throw</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Dois erros acima:</span>
<span class="c1">// 1. Uma falha no enviar para o loop completamente, travando dinheiro</span>
<span class="c1">// 2. Este loop pode ser abitrariamente longo (basado na quando que</span>
<span class="c1">// o usuário precisa de refundo), portanto, pode falhar quando exceder</span>
<span class="c1">// a quantidade máxima de gas do bloco</span>
<span class="c1">// Ao invés disso, você deve deixar as pessoas retirarem</span>
<span class="c1">// individualmente de suas subcontas e marcarem a retirada</span>


<span class="c1">// 7. OBJETOS/CONTRATOS</span>

<span class="c1">// A. Chamando um contrato externo</span>
<span class="k">contract</span><span class="w"> </span><span class="ni">FonteDeInformacoes</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">info</span><span class="p">()</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">ret</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">return</span><span class="w"> </span><span class="m m-Decimal">42</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">contract</span><span class="w"> </span><span class="ni">Consumidor</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>FonteDeInformacoes<span class="w"> </span>fonte<span class="p">;</span><span class="w"> </span><span class="c1">// aponta para um contrato na blockchain</span>

<span class="w">    </span><span class="c1">// Assinala variável para uma instância do contrato</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">setFonte</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">endereco</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Cast automático, cuidado; construtor não é chamado</span>
<span class="w">        </span>fonte<span class="w"> </span><span class="o">=</span><span class="w"> </span>FonteDeInformacoes<span class="p">(</span>endereco<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Assinala variável para uma nova instância do contrato</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">createNewFeed</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>fonte<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span>FonteDeInformacoes<span class="p">();</span><span class="w"> </span><span class="c1">// nova instância criada</span>
<span class="w">        </span><span class="c1">// construtor é chamado</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">chameFonte</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// último parenteses chama o contrato, podendo adicionar</span>
<span class="w">        </span><span class="c1">// opcionalmente valores ou gas</span>
<span class="w">        </span>fonte<span class="p">.</span>info<span class="p">.</span>value<span class="p">(</span><span class="m m-Decimal">10</span><span class="p">).</span>gas<span class="p">(</span><span class="m m-Decimal">800</span><span class="p">)();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// B. Herança</span>

<span class="c1">// Ordem importa, último contrato herdado (i.e., &#39;def&#39;) pode</span>
<span class="c1">// sobrescrever partes de contratos previamente herdados</span>
<span class="k">contract</span><span class="w"> </span><span class="ni">MeuContratdo</span><span class="w"> </span><span class="kt">is</span><span class="w"> </span>abc<span class="p">,</span><span class="w"> </span>def<span class="p">(</span><span class="s2">&quot;um argumento personalizado def&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="c1">// sobrescrevendo função</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">z</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.sender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>dono<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span>def<span class="p">.</span>z<span class="p">();</span><span class="w"> </span><span class="c1">// chama função sobrescrita de def</span>
<span class="w">            </span>super<span class="p">.</span>z<span class="p">();</span><span class="w"> </span><span class="c1">// chama função do pai imeadiato</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// função abstrata</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">umaFuncaoAbstrata</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="p">);</span>
<span class="c1">// não pode ser compilada, usada em contratos base/abstratos que</span>
<span class="c1">// então, a implementam</span>

<span class="c1">// C. Import</span>

<span class="kt">import</span><span class="w"> </span><span class="s2">&quot;filename&quot;</span><span class="p">;</span>
<span class="kt">import</span><span class="w"> </span><span class="s2">&quot;github.com/ethereum/dapp-bin/library/iterable_mapping.sol&quot;</span><span class="p">;</span>

<span class="c1">// &#39;Import&#39; está sobre desenvolvimento</span>
<span class="c1">// Atualmente não pode ser usada na linha de comando</span>


<span class="c1">// 8.OUTRAS PALAVRAS-CHAVE</span>

<span class="c1">// A. Throwing</span>
<span class="c1">// Throwing</span>
<span class="kt">throw</span><span class="p">;</span><span class="w"> </span><span class="c1">// reverte estado e dinheiro NÃO-USADO é devolvido ao usuários</span>
<span class="c1">// Atualmente não pode ser capturado</span>

<span class="c1">// Um padrão de design comum é:</span>
<span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>endereco<span class="p">.</span>send<span class="p">(</span><span class="m m-Decimal">123</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">throw</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// B. Selfdestruct</span>
<span class="c1">// auto-destroe o contrato corrente, enviando fundos para o endereço</span>
<span class="c1">// (geralmente o criador)</span>
selfdestruct<span class="p">(</span>ALGUM_ENDERECO<span class="p">);</span>

<span class="c1">// remove disco/código dos blocos corrente e futuros</span>
<span class="c1">// ajuda clientes leves, mas dados persistidos continuam no blockchain</span>

<span class="c1">// Padrão comum, permite ao dono finalizar o contrato e receber fundos</span>
<span class="c1">// restantes</span>
<span class="kt">function</span><span class="w"> </span><span class="nv">remover</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">if</span><span class="p">(</span><span class="k">msg.sender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>criador<span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Apenas o criador do contrato pode</span>
<span class="w">                                </span><span class="c1">// fazer isso</span>
<span class="w">        </span>selfdestruct<span class="p">(</span>criador<span class="p">);</span><span class="w"> </span><span class="c1">// Inativa o contrato e retorna os fundos</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Talvez queria desativar o contrato manualmente, ao invés de usar</span>
<span class="c1">// selfdestruct (ether enviado para contratos selfdestructed é perdido)</span>


<span class="c1">// 9. NOTAS SOBRE DESIGN DE CONTRATOS</span>

<span class="c1">// A. Obfuscação</span>
<span class="c1">// Todas as variáveis são publicamente visíveis na blockchain, então</span>
<span class="c1">// qualquer coisa privada precisa ser obfuscada (e.g., hash com segredo)</span>

<span class="c1">// Passo-a-pass: 1. Comprometa-se com algo, 2. Revele compromisso</span>
sha3<span class="p">(</span><span class="s2">&quot;quantidade_de_lance&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;algum segredo&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// compromisso</span>

<span class="c1">// chame a função reveal (revelar) do contrato no futuros</span>
<span class="c1">// mostrando o lance mais o segredo para foi hasheado com SHA3</span>
reveal<span class="p">(</span><span class="m m-Decimal">100</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;meuSegredo&quot;</span><span class="p">);</span>

<span class="c1">// B. Otimização de disco</span>
<span class="c1">// Escrever na blockchain pode ser caro, dado que os dados são guardados</span>
<span class="c1">// para sempre. É encorajado que contratos inteligentes usem memória (</span>
<span class="c1">// enventualmente, compilação será melhor, mas por enquanto é benéfico</span>
<span class="c1">// usar estruturas de dados simples - armazenando minimamente na</span>
<span class="c1">// blockchain)</span>

<span class="c1">// Custo pode ser alto para item como arrays multidimensionais</span>
<span class="c1">// (custo para guardar os dados - não declarar variáveis)</span>

<span class="c1">// C. Acesso de dados da blockchain</span>

<span class="c1">// Não pode restringir humanos ou computadores de ler os conteúdos</span>
<span class="c1">// de transações ou estado de transações</span>

<span class="c1">// Enquanto &#39;private&#39; previne outros *contratos* de ler dados ]</span>
<span class="c1">// diretamente - qualquer outra parte ainda pode ler dados da blockchain</span>

<span class="c1">// Todos os dados são armazedos na blockchain, para que qualquer um</span>
<span class="c1">// possa observar dados antigos e mudanças</span>

<span class="c1">// D. Jobs Cron</span>
<span class="c1">// Contratos deve ser manualmente chamados para lidar com agendamentos</span>
<span class="c1">// baseados em tempo; podendo criar código externo para pingar</span>
<span class="c1">// regularmente ou prover incentivos (ether) para outros fazê-lo</span>

<span class="c1">// E. Padrão Observador</span>
<span class="c1">// O Padrão Observador permite que você registre um inscritor e</span>
<span class="c1">// registre uma função a ser chamada pelo Oráculo (nota, Oráculos pagam</span>
<span class="c1">// pela ação executada). Similarmente à subscrição em Pub/sub</span>

<span class="c1">// Este é um contrato abstrato, tanto as classes cliente como a</span>
<span class="c1">// servidor importam o cliente que deve ser implementado</span>
<span class="k">contract</span><span class="w"> </span><span class="ni">AlgumOraculoCallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">OraculoCallback</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="nv">_valor</span><span class="p">,</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="nv">_tempo</span><span class="p">,</span><span class="w"> </span><span class="kt">bytes32</span><span class="w"> </span><span class="nv">info</span><span class="p">)</span><span class="w"> </span><span class="kt">external</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">contract</span><span class="w"> </span><span class="ni">AlgumOráculo</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>AlgumOraculoCallback<span class="p">[]</span><span class="w"> </span>callbacks<span class="p">;</span><span class="w"> </span><span class="c1">// array com todos os inscritos</span>

<span class="w">    </span><span class="c1">// Registra inscrito</span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">addInscrito</span><span class="p">(</span>AlgumOraculoCallback<span class="w"> </span>a<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>callbacks<span class="p">.</span>push<span class="p">(</span>a<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">notificar</span><span class="p">(</span>valor<span class="p">,</span><span class="w"> </span>tempo<span class="p">,</span><span class="w"> </span>info<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">for</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span>i<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>callbacks<span class="p">.</span>length<span class="p">;</span><span class="w"> </span>i<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// todos os inscritos precisam implementar AlgumOraculoCallback</span>
<span class="w">            </span>callbacks<span class="p">[</span>i<span class="p">].</span>OraculoCallback<span class="p">(</span>valor<span class="p">,</span><span class="w"> </span>tempo<span class="p">,</span><span class="w"> </span>info<span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">facaAlgo</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Código para fazer algo</span>

<span class="w">        </span><span class="c1">// Notifica todos os inscrito</span>
<span class="w">        </span>notificar<span class="p">(</span>_valor<span class="p">,</span><span class="w"> </span>_tempo<span class="p">,</span><span class="w"> </span>_info<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Agora, seu contrato cliente pode addInscrito importando</span>
<span class="c1">// AlgumOraculoCallback e registrando algum Oráculo</span>

<span class="c1">// F. Máquinas de estado</span>
<span class="c1">// veja o exemplo abaixo para o enum Estado e o modificador noEstado</span>

<span class="c1">// *** EXEMPLO: Um exemplo de crowdfunding example (similar ao</span>
<span class="c1">// Kickstarter) ***</span>
<span class="c1">// ** INCIO DO EXEMPLO **</span>

<span class="c1">// FundadorDoCrowdFunding.sol</span>

<span class="c1">/// @title FundadorDoCrowdFunding</span>
<span class="c1">/// @author nemild</span>
<span class="k">contract</span><span class="w"> </span><span class="ni">FundadorDoCrowdFunding</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Variáveis assinaladas na crição pelo criador</span>
<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="k">public </span><span class="nv">criador</span><span class="p">;</span>
<span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="k">public </span><span class="nv">recipiente</span><span class="p">;</span><span class="w"> </span><span class="c1">// criador pode ser diferente do Recipiente</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">minALevantar</span><span class="p">;</span><span class="w"> </span><span class="c1">// requisito para pagar, pelo contrário</span>
<span class="w">                              </span><span class="c1">// os doadores recebem o dinheiro de volta</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="nv">urlDaCampanha</span><span class="p">;</span>
<span class="w">    </span>byte<span class="w"> </span><span class="kt">constant</span><span class="w"> </span>versao<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Estruturas de dados</span>
<span class="w">    </span><span class="kt">enum</span><span class="w"> </span><span class="nv">Estado</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>LevantandoFundos<span class="p">,</span>
<span class="w">        </span>RefundoExpirado<span class="p">,</span>
<span class="w">        </span>Sucesso
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">struct</span><span class="w"> </span><span class="nv">Contribuicao</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">quantidade</span><span class="p">;</span>
<span class="w">        </span><span class="kt">address</span><span class="w"> </span><span class="nv">contribuidor</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Variáveis de Estado</span>
<span class="w">    </span>State<span class="w"> </span><span class="kt">public</span><span class="w"> </span>estado<span class="w"> </span><span class="o">=</span><span class="w"> </span>Estado<span class="p">.</span>LevantandoFundos<span class="p">;</span><span class="w"> </span><span class="c1">// incializado na criação</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">totalLevantado</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">levantadoPor</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="k">public </span><span class="nv">completadoEm</span><span class="p">;</span>
<span class="w">    </span>Contribution<span class="p">[]</span><span class="w"> </span>contribuidores<span class="p">;</span>

<span class="w">    </span><span class="kt">event</span><span class="w"> </span><span class="nv">LogRecebimentoDeFundos</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">endereco</span><span class="p">,</span>
<span class="w">                                 </span><span class="kt">uint</span><span class="w"> </span><span class="nv">quantidade</span><span class="p">,</span>
<span class="w">                                 </span><span class="kt">uint</span><span class="w"> </span><span class="nv">totalAtual</span><span class="p">);</span>
<span class="w">    </span><span class="kt">event</span><span class="w"> </span><span class="nv">LogFundosPagos</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">enderecoDoRecebedor</span><span class="p">);</span>

<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>noEstado<span class="p">(</span>Estado<span class="w"> </span>_estado<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>estado<span class="w"> </span><span class="o">!=</span><span class="w"> </span>_estado<span class="p">)</span><span class="w"> </span><span class="kt">throw</span><span class="p">;</span>
<span class="w">        </span>_
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>eOCriador<span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="k">msg.sender</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span>criador<span class="p">)</span><span class="w"> </span><span class="kt">throw</span><span class="p">;</span>
<span class="w">        </span>_
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Aguarda 6 meses após o final do contrato para destruí-lo</span>
<span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>noFimDoContrato<span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">if</span><span class="p">(</span><span class="o">!</span><span class="p">((</span>estado<span class="w"> </span><span class="o">==</span><span class="w"> </span>Estado<span class="p">.</span>RefundoExpirado<span class="w"> </span><span class="o">||</span><span class="w"> </span>estado<span class="w"> </span><span class="o">==</span><span class="w"> </span>Estado<span class="p">.</span>Sucesso<span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">        </span>completadoEm<span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m m-Decimal">6</span><span class="w"> </span>months<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>now<span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">throw</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span>_
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">FundadorDoCrowdFunding</span><span class="p">(</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">tempoEmHorasParaFundraising</span><span class="p">,</span>
<span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="nv">_urlDaCampanha</span><span class="p">,</span>
<span class="w">        </span><span class="kt">address</span><span class="w"> </span><span class="nv">_recipiente</span><span class="p">,</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">_minALevantar</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>criador<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.sender</span><span class="p">;</span>
<span class="w">        </span>recipiente<span class="w"> </span><span class="o">=</span><span class="w"> </span>_recipiente<span class="p">;</span>
<span class="w">        </span>urlDaCampanha<span class="w"> </span><span class="o">=</span><span class="w"> </span>_urlDaCampanha<span class="p">;</span>
<span class="w">        </span>minALevantar<span class="w"> </span><span class="o">=</span><span class="w"> </span>_minALevantar<span class="p">;</span>
<span class="w">        </span>levantadoPor<span class="w"> </span><span class="o">=</span><span class="w"> </span>now<span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span>tempoEmHorasParaFundraising<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="w"> </span>hours<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">contribuir</span><span class="p">()</span>
<span class="w">    </span><span class="kt">public</span>
<span class="w">    </span>noEstado<span class="p">(</span>Estado<span class="p">.</span>LevantandoFundos<span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>contribuidores<span class="p">.</span>push<span class="p">(</span>
<span class="w">            </span>Contribuicao<span class="p">({</span>
<span class="w">                </span>quantidade<span class="o">:</span><span class="w"> </span><span class="k">msg.value</span><span class="p">,</span>
<span class="w">                </span>contribuidor<span class="o">:</span><span class="w"> </span><span class="k">msg.sender</span>
<span class="w">            </span><span class="p">})</span><span class="w"> </span><span class="c1">// use array, para podermos iterar</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span>totalLevantado<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span>

<span class="w">        </span>LogRecebimentoDeFundos<span class="p">(</span><span class="k">msg.sender</span><span class="p">,</span><span class="w"> </span><span class="k">msg.value</span><span class="p">,</span><span class="w"> </span>totalRaised<span class="p">);</span>

<span class="w">        </span>verifiqueSeLevantamentoFoiCompletadoOuExpirado<span class="p">();</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>contribuicoes<span class="p">.</span>length<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// retorna id</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">verifiqueSeLevantamentoFoiCompletadoOuExpirado</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>totalLevantado<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>minALevantar<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span>estado<span class="w"> </span><span class="o">=</span><span class="w"> </span>Estado<span class="p">.</span>Sucesso<span class="p">;</span>
<span class="w">            </span>pagar<span class="p">();</span>

<span class="w">            </span><span class="c1">// pode incentivar enviador que iniciou a mudanção de estado</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="kt">else</span><span class="w"> </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>now<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>levantadoPor<span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="p">{</span>
<span class="w">            </span>estado<span class="w"> </span><span class="o">=</span><span class="w"> </span>Estado<span class="p">.</span>RefundoExpirado<span class="p">;</span><span class="w"> </span><span class="c1">// backers podem coletar</span>
<span class="w">                                             </span><span class="c1">// o fundo chamando receberRefundo(id)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span>completadoEm<span class="w"> </span><span class="o">=</span><span class="w"> </span>now<span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">pagar</span><span class="p">()</span>
<span class="w">    </span><span class="kt">public</span>
<span class="w">    </span>emEstado<span class="p">(</span>Estado<span class="p">.</span>Sucesso<span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">if</span><span class="p">(</span><span class="o">!</span>recipiente<span class="p">.</span>send<span class="p">(</span><span class="kt">this</span><span class="p">.</span>balance<span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">throw</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>


<span class="w">        </span>LogFundosPagos<span class="p">(</span>fundRecipient<span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">receberRefundo</span><span class="p">(</span>id<span class="p">)</span>
<span class="w">    </span><span class="kt">public</span>
<span class="w">    </span>emEstado<span class="p">(</span>Estado<span class="p">.</span>RefundoExpirado<span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>contribuicoes<span class="p">.</span>length<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span>id<span class="w"> </span><span class="o">||</span><span class="w"> </span>id<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>contribuicoes<span class="p">[</span>id<span class="p">].</span>amount<span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">throw</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">quantidadeDeRefundo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>contribuicoes<span class="p">[</span>id<span class="p">].</span>amount<span class="p">;</span>
<span class="w">        </span>contribuicoes<span class="p">[</span>id<span class="p">].</span>amount<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span>

<span class="w">        </span><span class="kt">if</span><span class="p">(</span><span class="o">!</span>contribuicoes<span class="p">[</span>id<span class="p">].</span>contribuidor<span class="p">.</span>send<span class="p">(</span>quantidadeParaEnviar<span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span>contribuicoes<span class="p">[</span>id<span class="p">].</span>amount<span class="w"> </span><span class="o">=</span><span class="w"> </span>quantidadeParaEnviar<span class="p">;</span>
<span class="w">            </span><span class="kt">return</span><span class="w"> </span><span class="kt">false</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">      </span><span class="kt">return</span><span class="w"> </span><span class="kt">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">removerContrato</span><span class="p">()</span>
<span class="w">    </span><span class="kt">public</span>
<span class="w">    </span>eOCriador<span class="p">()</span>
<span class="w">    </span>noFimDoContrato<span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>selfdestruct<span class="p">(</span><span class="k">msg.sender</span><span class="p">);</span>
<span class="w">        </span><span class="c1">// criador recebe todo o dinheiro restante{</span>

<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">throw</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
<span class="c1">// ** FIM DO EXEMPLO **</span>

<span class="c1">// 10. OUTRAS FUNÇÕES NATIVAS</span>

<span class="c1">// Unidades monetárias</span>
<span class="c1">// Moeda é definida usando wei, menor quantidade de ether</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">quantidadeMin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="w"> </span>wei<span class="p">;</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="w"> </span>finney<span class="p">;</span><span class="w"> </span><span class="c1">// 1 ether == 1000 finney</span>
<span class="c1">// Para outras unidades, veja: http://ether.fund/tool/converter</span>

<span class="c1">// Unidades temporais</span>
<span class="m m-Decimal">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="w"> </span>second<span class="w"> </span><span class="c1">// segundos</span>
<span class="m m-Decimal">1</span><span class="w"> </span>minutes<span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m m-Decimal">60</span><span class="w"> </span>seconds<span class="w"> </span><span class="c1">// Minutos</span>

<span class="c1">// Pode multiplicar uma variável de tempo, dado que unidades não são guardadas</span>
<span class="c1">// na variável</span>
<span class="kt">uint</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">5</span><span class="p">;</span>
<span class="p">(</span>x<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="w"> </span>days<span class="p">);</span><span class="w"> </span><span class="c1">// 5 dias</span>

<span class="c1">// Cuidado com o salto de segundos / anos com declarações de igualdade para o tempo</span>
<span class="c1">// (em vez disso, prefira maior que / menor que)</span>

<span class="c1">// Criptografia</span>
<span class="c1">// Todas as string passadas são concatenadas antes de realizar hashing</span>
sha3<span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;cd&quot;</span><span class="p">);</span>
ripemd160<span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">);</span>
sha256<span class="p">(</span><span class="s2">&quot;def&quot;</span><span class="p">);</span>

<span class="c1">// 11. Segurança</span>

<span class="c1">// Bugs são desastrosos para contratos Ethereum - até padrões Solidity populares</span>
<span class="c1">// podem ser considerados anti-padrões</span>

<span class="c1">// Veja links para segurança no final deste documento</span>

<span class="c1">// 12. FUNÇÕES DE BAIXO NÍVELS</span>
<span class="c1">// call - baixo nível, geralmente não usada, não tem segurança de tipos</span>
booleanSucesso<span class="w"> </span><span class="o">=</span><span class="w"> </span>algumEnderecoDeContrato<span class="p">.</span>call<span class="p">(</span><span class="s1">&#39;nome_da_funcao&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;arg1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;arg2&#39;</span><span class="p">);</span>

<span class="c1">// callcode - Código no endereço alvo executado no *contexto* do contrato</span>
<span class="c1">// de chamada. Fornece funcionalidade de biblioteca</span>
algumEnderecoDeContrato<span class="p">.</span>callcode<span class="p">(</span><span class="s1">&#39;nome_da_funcao&#39;</span><span class="p">);</span>


<span class="c1">// 13. NOTAS DE ESTILO</span>
<span class="c1">// Baseado no guia de estilo PEP8 do Python</span>

<span class="c1">// Resumo rápido:</span>
<span class="c1">// 4 espaços para identação</span>
<span class="c1">// Duas linhas separam declaração de contratos (e outras declarações de alto nível)</span>
<span class="c1">// Evite espaços estranhos entre parênteses</span>
<span class="c1">// Pode omitir chaves curly para uma declaração de linha(if, for, etc)</span>
<span class="c1">// else deve ser colocado na própria linha</span>


<span class="c1">// 14. COMENTÁRIOS NATSPEC</span>
<span class="c1">// usado para documentação, comentários e UIs externos</span>

<span class="c1">// Contrato natspec - sempre acima da definição do contrato</span>
<span class="c1">/// @title Título do Contrato</span>
<span class="c1">/// @author Nome do autor</span>

<span class="c1">// Função natspec</span>
<span class="c1">/// @notice informações sobre o que funciona; mostrado quando a função é executada</span>
<span class="c1">/// @dev Documentação de função para desenvolvedor</span>

<span class="c1">// Parâmetro de função / valor de retorno  natspec</span>
<span class="c1">/// @param algumParametro Alguma descrição do que o parametro faz</span>
<span class="c1">/// @return Descrição do valor de retorno</span>
</pre></div>
<h2>Recursos adicionais</h2>
<ul>
<li><a href="https://solidity.readthedocs.org/en/latest/">Documetanção Solidity</a></li>
<li><a href="https://ethereum.github.io/solidity//docs/style-guide/">Guia de Estilo do Solidity</a>:
O guia de estilo Ethereum é derivado do guia de estilo do Python <a href="https://www.python.org/dev/peps/pep-0008/">pep8</a>.</li>
<li><a href="http://chriseth.github.io/browser-solidity/">Editor de Browser Solidity</a></li>
<li><a href="https://gitter.im/ethereum/solidity">Gitter Solidity Chat room</a></li>
<li><a href="https://docs.erisindustries.com/tutorials/solidity/">Estratégias de projeto modular para contratos Ethereum</a></li>
</ul>
<h2>Contratos de Exemplo</h2>
<ul>
<li><a href="https://github.com/ethereum/dapp-bin">Dapp Bin</a></li>
<li><a href="https://github.com/fivedogit/solidity-baby-steps/tree/master/contracts">Solidity Baby Step Contracts</a></li>
<li><a href="https://github.com/ConsenSys/dapp-store-contracts">ConsenSys Contracts</a></li>
<li><a href="http://dapps.ethercasts.com/">State of Dapps</a></li>
</ul>
<h2>Segurança</h2>
<ul>
<li><a href="https://blog.ethereum.org/2016/06/19/thinking-smart-contract-security/">Thinking About Smart Contract Security</a></li>
<li><a href="https://blog.ethereum.org/2016/06/10/smart-contract-security/">Smart Contract Security</a></li>
<li><a href="http://hackingdistributed.com/">Hacking Distributed Blog</a></li>
</ul>
<h2>Estilo</h2>
<ul>
<li><a href="https://www.python.org/dev/peps/pep-0008/">PEP8</a> é usado como guia de estilo,
incluindo sua filosofia geral</li>
</ul>
<h2>Editores</h2>
<ul>
<li><a href="https://github.com/tomlion/vim-solidity">Vim Solidity</a></li>
<li>Snippets de Editores (<a href="https://gist.github.com/nemild/98343ce6b16b747788bc">Ultisnips format</a>)</li>
</ul>

        <hr>
        <p>
          Sugestões ou correções? <a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">Abra uma issue</a> no repositório do GitHub, ou faça um <a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/pt-br/solidity.md">pull request</a> você mesmo!
        </p>
        <p class="contributed">
          Originalmente contribuído por Nemil Dalal e atualizado por <a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/pt-br/solidity.md">4 colaboradores</a>.
        </p>

        <footer>
          <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0; width: 80px; height: 28px; padding-bottom: 5px;" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-sa.svg" /></a>
          <p>
            &copy; 2025
            <a href="https://www.nemil.com">Nemil Dalal</a>,
            Joseph Chow
          </p>
        </footer>
      </div>

      <script>
        document.addEventListener('DOMContentLoaded', () => {
          const langSelect = document.getElementById('lang-select');
          langSelect?.addEventListener('change', () => {
            const selectedOption = langSelect.options[langSelect.selectedIndex];
            const url = selectedOption?.getAttribute('data-url');
            if (url) {
              window.location.href = url;
            }
          });
        });
      </script>
    </div>
  </body>
</html>