<!DOCTYPE html>
<html lang="fr">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WXC8R75DEN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WXC8R75DEN');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Language" content="fr">
    <title>Learn AWK in Y Minutes</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto+Slab:wght@100..900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/screen.css">
    <link rel="stylesheet" href="/css/light.css">
    <link rel="stylesheet" href="/css/dark.css">

    <link rel="canonical" href="https://learnxinyminutes.com/fr/awk/">
    <script>
      localStorage.removeItem("lxiym_theme");
    </script>
  </head>
  <body>
    <div class="container">
      <div class="share">
        <span class="sharemsg">
          <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Ffr%2Fawk%2F&amp;text=Apprendre+X+en+Y+minutes%2C+o%C3%B9+X%3DAWK">
            Partager cette page
          </a>
        </span>
        <span class='st_facebook_large' displayText='Facebook'></span>
        <span class='st_twitter_large' displayText='Tweet'></span>
      </div>
      <h1><a href="/">Apprendre X en Y minutes</a></h1>
      <h2>Où X=AWK</h2>
      <p class="filelink">
        Récupérer le code:
        <a href="/fr/files/learnawk.awk">learnawk.awk</a>
      </p>
      <div id="doc">
<p>AWK est un outil standard présent dans chaque système UNIX conforme aux normes
POSIX. C’est un outil en ligne de commande qui ressemble au Perl et qui est
excellent dans les tâches de traitement de fichiers texte.
Vous pouvez l’appeler à partir d’un script shell, ou l’utiliser comme un langage
de script autonome.</p>
<p>Pourquoi utiliser AWK au lieu du langage Perl ?
Principalement, car AWK fait partie d'UNIX et est donc présent par défaut sur
une très grande partie des systèmes d'exploitation UNIX et Linux.
AWK est aussi plus facile à lire que le langage Perl ; et est l'outil idéal pour
ce qui concerne le traitement de texte simple. Notamment le traitement de ceux
qui nécessitent de lire des fichiers ligne par ligne ; chaque ligne comportant
des champs séparés par des délimiteur.</p>
<div class="highlight"><pre lang="awk"><span class="c1">#!/usr/bin/awk -f</span>

<span class="c1"># Les commentaires commencent par un #</span>

<span class="c1"># Les programmes AWK consistent en une collection de règles et d&#39;actions.</span>
<span class="nx">règle1</span> <span class="p">{</span> <span class="nx">action</span><span class="p">;</span> <span class="p">}</span>
<span class="nx">règle2</span> <span class="p">{</span> <span class="nx">action</span><span class="p">;</span> <span class="p">}</span>

<span class="c1"># AWK lit et analyse automatiquement chaque ligne de chaque fichier fourni.</span>
<span class="c1"># Chaque ligne est divisée par un délimiteur FS qui est par défaut l&#39;espace</span>
<span class="c1"># (plusieurs espaces ou une tabulation comptent pour un espace). Ce délimiteur</span>
<span class="c1"># peut être changé grâce à l&#39;option -F ou être renseigné au début d&#39;un bloc</span>
<span class="c1"># (exemple: FS = &quot; &quot;).</span>

<span class="c1"># BEGIN est une règle spécifique exécutée au début du programme. C&#39;est à cet</span>
<span class="c1"># endroit que vous mettrez tout le code à exécuter avant de traiter les fichiers</span>
<span class="c1"># texte. Si vous ne disposez pas de fichiers texte, considérez BEGIN comme le</span>
<span class="c1"># point d’entrée principal du script.</span>
<span class="c1"># À l&#39;opposé de BEGIN, il existe la règle END. Cette règle est présente après</span>
<span class="c1"># chaque fin de fichier (EOF : End Of File).</span>

<span class="nb">BEGIN</span> <span class="p">{</span>

    <span class="c1"># Les variables sont globales. Pas besoin de les déclarer.</span>
    <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1"># Les opérateurs sont identiques au langage C et aux langages similaires</span>
    <span class="c1"># (tels que C#, C++, etc.)</span>
    <span class="nx">a</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="c1"># addition</span>
    <span class="nx">b</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="c1"># soustraction</span>
    <span class="nx">c</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">*</span> <span class="mi">1</span><span class="p">;</span> <span class="c1"># multiplication</span>
    <span class="nx">d</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">/</span> <span class="mi">1</span><span class="p">;</span> <span class="c1"># division entière</span>
    <span class="nx">e</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">%</span> <span class="mi">1</span><span class="p">;</span> <span class="c1"># modulo, reste de la division entière</span>
    <span class="nx">f</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">^</span> <span class="mi">1</span><span class="p">;</span> <span class="c1"># exponentiel</span>

    <span class="nx">a</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">b</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">c</span> <span class="o">*=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">d</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">e</span> <span class="o">%=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">f</span> <span class="o">^=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1"># Incrémenter et décrémenter par un</span>
    <span class="nx">a</span><span class="o">++</span><span class="p">;</span>
    <span class="nx">b</span><span class="o">--</span><span class="p">;</span>

    <span class="c1"># En tant qu&#39;opérateur préfixé, c&#39;est la valeur incrémentée qui</span>
    <span class="c1"># est retournée</span>
    <span class="o">++</span><span class="nx">a</span><span class="p">;</span>
    <span class="o">--</span><span class="nx">b</span><span class="p">;</span>

    <span class="c1"># Instruction de contrôle</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">conteur</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="kr">print</span> <span class="s2">&quot;Nombre de départ 0&quot;</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="kr">print</span> <span class="s2">&quot;Hein?&quot;</span><span class="p">;</span>

    <span class="c1"># Vous pouvez aussi utiliser l&#39;opérateur ternaire</span>
    <span class="kr">print</span> <span class="p">(</span><span class="nx">compteur</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;Nombre de départ 0&quot;</span> <span class="o">:</span> <span class="s2">&quot;Hein?&quot;</span><span class="p">;</span>

    <span class="c1"># Les blocs sont composés d&#39;une multitude de lignes entre accolades</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">print</span> <span class="s2">&quot;La concaténation de chaînes de caractères&quot;</span> <span class="s2">&quot; se fait avec&quot;</span>
            <span class="s2">&quot;des séries de chaînes &quot;</span> <span class="s2">&quot;séparées par des espaces&quot;</span><span class="p">;</span>
        <span class="kr">print</span> <span class="nx">a</span><span class="p">;</span>

        <span class="nx">a</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
        <span class="kr">print</span> <span class="s2">&quot;le bon vieux for pour les boucles&quot;</span><span class="p">;</span>

    <span class="c1"># Les opérateurs de comparaison sont standard</span>
    <span class="c1"># a &lt; b   # plus petit que</span>
    <span class="c1"># a &lt;= b  # plus petit ou égale à</span>
    <span class="c1"># a != b  # non égale</span>
    <span class="c1"># a == b  # égale</span>
    <span class="c1"># a &gt; b   # Plus grand que</span>
    <span class="c1"># a &gt;= b  # Plus grand ou égale à</span>

    <span class="c1"># Les opérateurs logiques sont</span>
    <span class="c1"># a &amp;&amp; b  # ET</span>
    <span class="c1"># a || b  # OU</span>

    <span class="c1"># En plus, il y a les expressions régulières</span>
    <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;foo&quot;</span> <span class="o">~</span> <span class="s2">&quot;^fo+$&quot;</span><span class="p">)</span>
        <span class="kr">print</span> <span class="s2">&quot;Fooey!&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;boo&quot;</span> <span class="o">!~</span> <span class="s2">&quot;^fo+$&quot;</span><span class="p">)</span>
        <span class="kr">print</span> <span class="s2">&quot;Boo!&quot;</span><span class="p">;</span>

    <span class="c1"># Les Tableaux</span>
    <span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span><span class="p">;</span>
    <span class="nx">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">;</span>

    <span class="c1"># Vous pouvez aussi initialiser un tableau avec la fonction split()</span>
    <span class="nx">n</span> <span class="o">=</span> <span class="kr">split</span><span class="p">(</span><span class="s2">&quot;foo:bar:baz&quot;</span><span class="p">,</span> <span class="nx">arr</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">);</span>

    <span class="c1"># Il y a aussi les tableaux associatifs</span>
    <span class="nx">assoc</span><span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">;</span>
    <span class="nx">assoc</span><span class="p">[</span><span class="s2">&quot;bar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;baz&quot;</span><span class="p">;</span>

    <span class="c1"># et les tableaux multi-dimensions, avec certaines limitations que l&#39;on ne</span>
    <span class="c1"># mentionnera pas ici</span>
    <span class="nx">multidim</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span><span class="p">;</span>
    <span class="nx">multidim</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">;</span>
    <span class="nx">multidim</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;baz&quot;</span><span class="p">;</span>
    <span class="nx">multidim</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;boo&quot;</span><span class="p">;</span>

    <span class="c1"># Vous pouvez tester l&#39;appartenance à un tableau</span>
    <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;foo&quot;</span> <span class="o">in</span> <span class="nx">assoc</span><span class="p">)</span>
        <span class="kr">print</span> <span class="s2">&quot;Fooey!&quot;</span><span class="p">;</span>

    <span class="c1"># Vous pouvez aussi utilisez l&#39;opérateur &#39;in&#39; pour parcourir les clés</span>
    <span class="c1"># d&#39;un tableau</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="o">in</span> <span class="nx">assoc</span><span class="p">)</span>
        <span class="kr">print</span> <span class="nx">assoc</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>

    <span class="c1"># La ligne de commande est dans un tableau spécifique appelé ARGV</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">argnum</span> <span class="o">in</span> <span class="nb">ARGV</span><span class="p">)</span>
        <span class="kr">print</span> <span class="nb">ARGV</span><span class="p">[</span><span class="nx">argnum</span><span class="p">];</span>

    <span class="c1"># Vous pouvez supprimer des éléments d&#39;un tableau.</span>
    <span class="c1"># C&#39;est utile pour empêcher AWK de supposer que certains arguments soient</span>
    <span class="c1"># des fichiers à traiter.</span>
    <span class="kr">delete</span> <span class="nb">ARGV</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

    <span class="c1"># Le nombre d&#39;arguments de la ligne de commande est assigné à</span>
    <span class="c1"># la variable ARGC</span>
    <span class="kr">print</span> <span class="nb">ARGC</span><span class="p">;</span>

    <span class="c1"># AWK inclue trois catégories de fonction. On les examinera plus tard.</span>
    <span class="nx">return_value</span> <span class="o">=</span> <span class="nx">arithmetic_functions</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span>
    <span class="nx">string_functions</span><span class="p">();</span>
    <span class="nx">io_functions</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1"># Voici comment définir une fonction</span>
<span class="kd">function</span> <span class="nx">arithmetic_functions</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span>     <span class="nx">d</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1"># La partie la plus ennuyeuse de AWK est probablement l’absence de variables</span>
    <span class="c1"># locales. Tout est global. Pour les scripts courts, c&#39;est très utile, mais</span>
    <span class="c1"># pour les scripts plus longs, cela peut poser un problème.</span>

    <span class="c1"># Il y a cependant une solution de contournement (enfin ... une bidouille).</span>
    <span class="c1"># Les arguments d&#39;une fonction sont locaux à cette fonction.</span>
    <span class="c1"># Et AWK vous permet de définir plus d&#39;arguments à la fonction que</span>
    <span class="c1"># nécessaire. Il suffit donc de mettre une variable locale dans la</span>
    <span class="c1"># déclaration de fonction, comme ci-dessus. La convention veut que vous</span>
    <span class="c1"># mettiez quelques espaces supplémentaires pour faire la distinction entre</span>
    <span class="c1"># les paramètres réels et les variables locales.</span>
    <span class="c1"># Dans cet exemple, a, b et c sont des paramètres réels, alors que d est</span>
    <span class="c1"># simplement une variable locale.</span>

    <span class="c1"># Maintenant, les fonctions arithmétiques</span>

    <span class="c1"># La plupart des implémentations de AWK ont des fonctions trigonométriques</span>
    <span class="c1"># standards</span>
    <span class="nx">localvar</span> <span class="o">=</span> <span class="kr">sin</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
    <span class="nx">localvar</span> <span class="o">=</span> <span class="kr">cos</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
    <span class="nx">localvar</span> <span class="o">=</span> <span class="kr">atan2</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">a</span><span class="p">);</span> <span class="c1"># arc tangente de b / a</span>

    <span class="c1"># Les exponentiels et logarithmes décimaux sont aussi là</span>
    <span class="nx">localvar</span> <span class="o">=</span> <span class="kr">exp</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
    <span class="nx">localvar</span> <span class="o">=</span> <span class="kr">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>

    <span class="c1"># Les racines carrées</span>
    <span class="nx">localvar</span> <span class="o">=</span> <span class="kr">sqrt</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>

    <span class="c1"># Tronquer un nombre décimal en nombre entier</span>
    <span class="nx">localvar</span> <span class="o">=</span> <span class="kr">int</span><span class="p">(</span><span class="mf">5.34</span><span class="p">);</span> <span class="c1"># localvar =&gt; 5</span>

    <span class="c1"># Les nombres aléatoires</span>
    <span class="kr">srand</span><span class="p">();</span>
    <span class="c1"># L&#39;argument de la fonction srand() est la valeur de départ pour générer</span>
    <span class="c1"># les nombres aléatoires . Par défaut, il utilise l&#39;heure du système</span>

    <span class="nx">localvar</span> <span class="o">=</span> <span class="kr">rand</span><span class="p">();</span> <span class="c1"># Nombre aléatoire entre 0 et 1.</span>

    <span class="c1"># Maintenant on retourne la valeur</span>
    <span class="k">return</span> <span class="nx">localvar</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">string_functions</span><span class="p">(</span>    <span class="nx">localvar</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1"># AWK a plusieurs fonctions pour le traitement des chaînes de caractères,</span>
    <span class="c1"># dont beaucoup reposent sur des expressions régulières.</span>

    <span class="c1"># Chercher et remplacer, la première occurrence (sub), ou toutes les</span>
    <span class="c1"># occurrences (gsub).</span>
    <span class="c1"># Les deux renvoient le nombre de correspondances remplacées</span>
    <span class="nx">localvar</span> <span class="o">=</span> <span class="s2">&quot;fooooobar&quot;</span><span class="p">;</span>
    <span class="kr">sub</span><span class="p">(</span><span class="s2">&quot;fo+&quot;</span><span class="p">,</span> <span class="s2">&quot;Meet me at the &quot;</span><span class="p">,</span> <span class="nx">localvar</span><span class="p">);</span> <span class="c1"># localvar =&gt; &quot;Meet me at the bar&quot;</span>
    <span class="kr">gsub</span><span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="nx">localvar</span><span class="p">);</span> <span class="c1"># localvar =&gt; &quot;M..t m. at th. bar&quot;</span>

    <span class="c1"># Rechercher une chaîne de caractères qui correspond à une expression</span>
    <span class="c1"># régulière index() fait la même chose, mais n&#39;autorise pas les expressions</span>
    <span class="c1"># régulières.</span>
    <span class="kr">match</span><span class="p">(</span><span class="nx">localvar</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">);</span> <span class="c1"># =&gt; 4, puisque &#39;t&#39; est le quatrième caractère</span>

    <span class="c1"># Séparer par un délimiteur</span>
    <span class="nx">n</span> <span class="o">=</span> <span class="kr">split</span><span class="p">(</span><span class="s2">&quot;foo-bar-baz&quot;</span><span class="p">,</span> <span class="nx">arr</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">);</span>
    <span class="c1"># résultat : a[1] = &quot;foo&quot;; a[2] = &quot;bar&quot;; a[3] = &quot;baz&quot;; n = 3</span>

    <span class="c1"># Autre astuces utiles</span>
    <span class="kr">sprintf</span><span class="p">(</span><span class="s2">&quot;%s %d %d %d&quot;</span><span class="p">,</span> <span class="s2">&quot;Testing&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1"># =&gt; &quot;Testing 1 2 3&quot;</span>
    <span class="kr">substr</span><span class="p">(</span><span class="s2">&quot;foobar&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1"># =&gt; &quot;oob&quot;</span>
    <span class="kr">substr</span><span class="p">(</span><span class="s2">&quot;foobar&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="c1"># =&gt; &quot;bar&quot;</span>
    <span class="kr">length</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">);</span> <span class="c1"># =&gt; 3</span>
    <span class="kr">tolower</span><span class="p">(</span><span class="s2">&quot;FOO&quot;</span><span class="p">);</span> <span class="c1"># =&gt; &quot;foo&quot;</span>
    <span class="kr">toupper</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">);</span> <span class="c1"># =&gt; &quot;FOO&quot;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">io_functions</span><span class="p">(</span>    <span class="nx">localvar</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1"># Vous avez déjà vu print</span>
    <span class="kr">print</span> <span class="s2">&quot;Hello world&quot;</span><span class="p">;</span>

    <span class="c1"># Mais il y a aussi printf</span>
    <span class="kr">printf</span><span class="p">(</span><span class="s2">&quot;%s %d %d %d\n&quot;</span><span class="p">,</span> <span class="s2">&quot;Testing&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

    <span class="c1"># AWK n&#39;a pas de descripteur de fichier en soi. Il ouvrira automatiquement</span>
    <span class="c1"># un descripteur de fichier lorsque vous utilisez quelque chose qui en a</span>
    <span class="c1"># besoin. La chaîne de caractères que vous avez utilisée pour cela peut être</span>
    <span class="c1"># traitée comme un descripteur de fichier à des fins d&#39;entrée / sortie.</span>
    <span class="nx">outfile</span> <span class="o">=</span> <span class="s2">&quot;/tmp/foobar.txt&quot;</span><span class="p">;</span>
    <span class="kr">print</span> <span class="s2">&quot;foobar&quot;</span> <span class="o">&gt;</span> <span class="nx">outfile</span><span class="p">;</span>

    <span class="c1"># Maintenant, la chaîne de caractères &quot;outfile&quot; est un descripteur de</span>
    <span class="c1"># fichier. Vous pouvez le fermer.</span>
    <span class="kr">close</span><span class="p">(</span><span class="nx">outfile</span><span class="p">);</span>

    <span class="c1"># Voici comment exécuter quelque chose dans le shell</span>
    <span class="kr">system</span><span class="p">(</span><span class="s2">&quot;echo foobar&quot;</span><span class="p">);</span> <span class="c1"># =&gt; affiche foobar</span>

    <span class="c1"># Lire quelque chose depuis l&#39;entrée standard et la stocker dans une</span>
    <span class="c1"># variable locale</span>
    <span class="kr">getline</span> <span class="nx">localvar</span><span class="p">;</span>

    <span class="c1"># Lire quelque chose à partir d&#39;un pipe (encore une fois, utilisez une</span>
    <span class="c1"># chaîne de caractère que vous fermerez proprement)</span>
    <span class="s2">&quot;echo foobar&quot;</span> <span class="o">|</span> <span class="kr">getline</span> <span class="nx">localvar</span> <span class="c1"># localvar =&gt; &quot;foobar&quot;</span>
    <span class="kr">close</span><span class="p">(</span><span class="s2">&quot;echo foobar&quot;</span><span class="p">)</span>

    <span class="c1"># Lire une ligne d&#39;un fichier et la stocker dans une variable locale</span>
    <span class="nx">infile</span> <span class="o">=</span> <span class="s2">&quot;/tmp/foobar.txt&quot;</span><span class="p">;</span>
    <span class="kr">getline</span> <span class="nx">localvar</span> <span class="o">&lt;</span> <span class="nx">infile</span><span class="p">;</span>
    <span class="kr">close</span><span class="p">(</span><span class="nx">infile</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1"># Comme dit au début, AWK consiste en une collection de règles et d&#39;actions.</span>
<span class="c1"># Vous connaissez déjà les règles BEGIN et END. Les autres règles ne sont</span>
<span class="c1"># utilisées que si vous traitez des lignes à partir de fichiers ou l&#39;entrée</span>
<span class="c1"># standard (stdin).</span>
<span class="c1"># Quand vous passez des arguments à AWK, ils sont considérés comme des noms de</span>
<span class="c1"># fichiers à traiter. AWK les traitera tous dans l&#39;ordre. Voyez les comme dans</span>
<span class="c1"># une boucle implicite, parcourant les lignes de ces fichiers. Ces règles et ces</span>
<span class="c1"># actions ressemblent à des instructions switch dans la boucle.</span>

<span class="sr">/^fo+bar$/</span> <span class="p">{</span>

    <span class="c1"># Cette action sera exécutée pour chaque ligne qui correspond à l&#39;expression</span>
    <span class="c1"># régulière, /^fo+bar$/, et sera ignorée pour toute ligne qui n&#39;y correspond</span>
    <span class="c1"># pas. Imprimons simplement la ligne :</span>

    <span class="kr">print</span><span class="p">;</span>

    <span class="c1"># Pas d&#39;argument ! C&#39;est parce que print a un défaut : $0.</span>
    <span class="c1"># $0 est le nom de la ligne en cours de traitement. Il est créé</span>
    <span class="c1"># automatiquement.</span>

    <span class="c1"># Vous devinez probablement qu&#39;il existe d&#39;autres variables $.</span>
    <span class="c1"># Chaque ligne est divisée implicitement avant que chaque action soit</span>
    <span class="c1"># exécutée, comme le fait le shell. Et, comme le shell, chaque champ est</span>
    <span class="c1"># accessible avec un signe dollar.</span>

    <span class="c1"># Ceci affichera les deuxième et quatrième champs de la ligne.</span>
    <span class="kr">print</span> <span class="o">$</span><span class="mi">2</span><span class="p">,</span> <span class="o">$</span><span class="mi">4</span><span class="p">;</span>

    <span class="c1"># AWK défini automatiquement beaucoup d&#39;autres variables qui peuvent vous</span>
    <span class="c1"># aider à inspecter et traiter chaque ligne. La plus importante est NF.</span>

    <span class="c1"># Affiche le nombre de champs de la ligne</span>
    <span class="kr">print</span> <span class="nb">NF</span><span class="p">;</span>

    <span class="c1"># Afficher le dernier champ de la ligne</span>
    <span class="kr">print</span> <span class="o">$</span><span class="nb">NF</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># Chaque règle est en réalité un test conditionnel.</span>
<span class="nx">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
    <span class="c1"># Ceci s’exécutera une fois pour chaque ligne, tant que le test est positif</span>
<span class="p">}</span>

<span class="c1"># Les expressions régulières sont également des tests conditionnels.</span>
<span class="c1"># Si le test de l&#39;expression régulières n&#39;est pas vrais alors le bloc</span>
<span class="c1"># n&#39;est pas exécuté.</span>
<span class="o">$</span><span class="mi">0</span> <span class="o">/^</span><span class="nx">fobar</span><span class="o">/</span> <span class="p">{</span>
   <span class="kr">print</span> <span class="s2">&quot;la ligne commence par foobar&quot;</span>
<span class="p">}</span>

<span class="c1"># Dans le cas où vous voulez tester votre chaîne de caractères sur la ligne</span>
<span class="c1"># en cours de traitement $0 est optionnelle.</span>
<span class="sr">/^[a-zA-Z0-9]$/</span> <span class="p">{</span>
    <span class="kr">print</span> <span class="s2">&quot;La ligne courante ne contient que des caractères alphanumériques.&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># AWK peut parcourir un fichier texte ligne par ligne et exécuter des actions en</span>
<span class="c1"># fonction de règles établies. Cela est si courant sous UNIX qu&#39;AWK est un</span>
<span class="c1"># langage de script.</span>

<span class="c1"># Ce qui suit est un exemple rapide d&#39;un petit script, pour lequel AWK est</span>
<span class="c1"># parfait. Le script lit un nom à partir de l&#39;entrée standard, puis affiche</span>
<span class="c1"># l&#39;âge moyen de toutes les personnes portant ce prénom.</span>
<span class="c1"># Supposons que vous fournissiez comme argument le nom d&#39;un fichier comportant</span>
<span class="c1"># ces données :</span>
<span class="c1">#</span>
<span class="c1"># Bob Jones 32</span>
<span class="c1"># Jane Doe 22</span>
<span class="c1"># Steve Stevens 83</span>
<span class="c1"># Bob Smith 29</span>
<span class="c1"># Bob Barker 72</span>
<span class="c1">#</span>
<span class="c1"># Le script est le suivant :</span>

<span class="nb">BEGIN</span> <span class="p">{</span>

    <span class="c1"># Premièrement, on demande à l&#39;utilisateur le prénom voulu</span>
    <span class="kr">print</span> <span class="s2">&quot;Pour quel prénom voudriez vous savoir l&#39;age moyen ?&quot;</span><span class="p">;</span>

    <span class="c1"># On récupère la ligne à partir de l&#39;entrée standard, pas de la ligne</span>
    <span class="c1"># de commande :</span>
    <span class="kr">getline</span> <span class="nx">name</span> <span class="o">&lt;</span> <span class="s2">&quot;/dev/stdin&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># Maintenant, pour chaque ligne dont le premier champ est le prénom donné</span>
<span class="o">$</span><span class="mi">1</span> <span class="o">==</span> <span class="nx">name</span> <span class="p">{</span>

    <span class="c1"># Ici, nous avons accès à un certain nombre de variables utiles déjà</span>
    <span class="c1"># préchargées :</span>
    <span class="c1"># $0 est la ligne entière</span>
    <span class="c1"># $3 est le troisième champ. Ici il correspond à l&#39;age qui nous intéresse</span>
    <span class="c1"># NF est le nombre de champs et vaut 3</span>
    <span class="c1"># NR est le nombre d&#39;enregistrements (lignes) vus jusqu&#39;à présent</span>
    <span class="c1"># FILENAME est le nom du fichier en cours de traitement</span>
    <span class="c1"># FS est séparateur de champs, ici c&#39;est &quot; &quot; (un espace)</span>
    <span class="c1"># ...etc. Et beaucoup d&#39;autre que vous pouvez connaître dans le manuel de</span>
    <span class="c1"># man. Pour cela exécutez &quot;man awk&quot; dans votre terminal.</span>

    <span class="c1"># Garder une trace du total accumulé et du nombre de lignes correspondant.</span>
    <span class="nx">sum</span> <span class="o">+=</span> <span class="o">$</span><span class="mi">3</span><span class="p">;</span>
    <span class="nx">nlines</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># Un autre motif spécial est END. Il fonctionnera après le traitement de tous</span>
<span class="c1"># les fichiers texte. Contrairement à BEGIN, il ne fonctionne que si vous lui</span>
<span class="c1"># donnez une entrée à traiter. Il sera exécuté une fois que tous les fichiers</span>
<span class="c1"># auront été lus et traités conformément aux règles et aux actions que vous</span>
<span class="c1"># avez fournies. Le but est généralement de produire un rapport final, ou de</span>
<span class="c1"># faire quelque chose avec l&#39;ensemble des données que vous avez accumulées</span>
<span class="c1"># au cours du script.</span>


<span class="nb">END</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">nlines</span><span class="p">)</span>
        <span class="kr">print</span> <span class="s2">&quot;L&#39;age moyen pour le prénom &quot;</span> <span class="nx">name</span> <span class="s2">&quot; est &quot;</span> <span class="nx">sum</span> <span class="o">/</span> <span class="nx">nlines</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>Pour plus d'informations :</p>
<ul>
<li><a href="http://www.grymoire.com/Unix/Awk.html">Awk tutorial</a></li>
<li><a href="https://linux.die.net/man/1/awk">Awk man page</a></li>
<li><a href="https://www.gnu.org/software/gawk/manual/gawk.html">The GNU Awk User's Guide</a>
GNU Awk est dans la majorité des systèmes Linux.</li>
<li><a href="http://tuxgraphics.org/~guido/scripts/awk-one-liner.html">AWK one-liner collection</a></li>
</ul>

        <hr>
        <p>
          Vous avez une suggestion ? Peut-être une correction ? <a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">Ouvrez un ticket</a> sur GitHub, ou faites vous-même une <a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/fr/awk.md">pull request</a> !
        </p>
        <p class="contributed">
          Version originale par Marshall Mason, mis à jour par <a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/fr/awk.md">4 contributeur(s)</a>.
        </p>

        <footer>
          <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0; width: 80px; height: 28px; padding-bottom: 5px;" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-sa.svg" /></a>
          <p>
            &copy; 2025
            <a href="http://github.com/marshallmason">Marshall Mason</a>
          </p>
        </footer>
      </div>
    </div>
  </body>
</html>